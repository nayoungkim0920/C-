#cmake -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Debug ..

cmake_minimum_required(VERSION 3.14)
project(Project1 LANGUAGES CXX CUDA)

# BUILD TYPE 설정
if(NOT CMAKE_BUILD_TYPE)
    set(CMAKE_BUILD_TYPE Debug)
endif()
message(STATUS "CMAKE_BUILD_TYPE: ${CMAKE_BUILD_TYPE}")

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_TOOLCHAIN_FILE "C:/vcpkg/scripts/buildsystems/vcpkg.cmake" CACHE FILEPATH "Path to vcpkg toolchain file")
set(CMAKE_PREFIX_PATH 
    "C:/vcpkg/packages" 
    "C:/onnxruntime")

# QT 설정
set(Qt6_DIR "C:/Qt/6.7.1/")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${Qt6_DIR}/msvc2019_64/lib/cmake/Qt6") #Find<Module>.cmake
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH};${Qt6_DIR}") #CMakeLists.txt
find_package(Qt6 REQUIRED COMPONENTS Widgets Core Gui)
set(CMAKE_PREFIX_PATH "${Qt6_DIR};${CMAKE_PREFIX_PATH}")
set(Qt6_INCLUDE_DIRS ${Qt6_DIR}/msvc2019_64/include)
set(Qt6_LIB_DIR ${Qt6_DIR}/msvc2019_64/lib)
set(Qt6_LIBRARIES Qt6::Widgets;Qt6::Core;Qt6::Gui)
include_directories(${Qt6_INCLUDE_DIRS})
link_directories(${Qt6_LIB_DIR})
link_libraries(${Qt6_LIBRARIES})
message(STATUS "Qt6_INCLUDE_DIRS: ${Qt6_INCLUDE_DIRS}")
message(STATUS "Qt6_LIB_DIR: ${Qt6_LIB_DIR}")
message(STATUS "Qt6_LIBRARIES: ${Qt6_LIBRARIES}")

# OpenCV 설정
set(OpenCV_DIR "C:/opencv")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${OpenCV_DIR}/sources/cmake") #Find<Module>.cmake
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH};${OpenCV_DIR}") #CMakeLists.txt
#find_package(OpenCV REQUIRED COMPONENTS core imgproc highgui dnn features2d calib3d imgcodecs ml video videoio objdetect opencv_photo)
find_package(OpenCV REQUIRED) 
set(OpenCV_LIBRARIES 
    cudaarithm cudaimgproc cudafilters imgcodecs core imgproc dnn 
    cudawarping cudacodec cudabgsegm cudafeatures2d cudalegacy features2d calib3d ml 
    video videoio objdetect photo ${OpenCV_LIBRARIES}
)
set(CMAKE_PREFIX_PATH "${OpenCV_DIR};${CMAKE_PREFIX_PATH}")
set(OpenCV_INCLUDE_DIRS "${OpenCV_DIR}/install/include" "${OpenCV_DIR}/include" "${OpenCV_INCLUDE_DIRS}")
set(OpenCV_LIB_DIR "${OpenCV_DIR}/lib/${CMAKE_BUILD_TYPE}")
set(OpenCV_BIN_DIR "${OpenCV_DIR}/x64/vc16/bin")
set(OpenCV_BIN_DIR_TYPE "${OpenCV_DIR}/bin/${CMAKE_BUILD_TYPE}")
set(OpenCV_LIB_ALL ${OpenCV_LIBRARIES};${OpenCV_LIBS})

set(OpenCV_LINK_LIBS "")
set(OpenCV_DLLS "")
foreach(lib ${OpenCV_LIB_ALL})    
    if(CMAKE_BUILD_TYPE MATCHES Debug)
        if("${OpenCV_DLLS}" STREQUAL "")
            list(APPEND OpenCV_LINK_LIBS ${OpenCV_BIN_DIR}/opencv_world4100d.lib)
            list(APPEND OpenCV_DLLS ${OpenCV_BIN_DIR}/opencv_world4100d.dll)
        endif()
        if(${lib} MATCHES "^opencv_")
            list(APPEND OpenCV_LINK_LIBS "${lib}4100d.lib")
            list(APPEND OpenCV_DLLS "${OpenCV_BIN_DIR_TYPE}/${lib}4100d.dll")
        else()
            list(APPEND OpenCV_LINK_LIBS "opencv_${lib}4100d.lib")
            list(APPEND OpenCV_DLLS "${OpenCV_BIN_DIR_TYPE}/opencv_${lib}4100d.dll")
        endif()
    else()
        if("${OpenCV_DLLS}" STREQUAL "")
            list(APPEND OpenCV_LINK_LIBS ${OpenCV_BIN_DIR}/opencv_world4100.lib)
            list(APPEND OpenCV_DLLS ${OpenCV_BIN_DIR}/opencv_world4100.dll)
        endif()
        if(${lib} MATCHES "^opencv_")
            list(APPEND OpenCV_LINK_LIBS "${lib}4100.lib")
            list(APPEND OpenCV_DLLS "${OpenCV_BIN_DIR_TYPE}/${lib}4100.dll")
        else()
            list(APPEND OpenCV_LINK_LIBS "opencv_${lib}4100.lib")
            list(APPEND OpenCV_DLLS "${OpenCV_BIN_DIR_TYPE}/opencv_${lib}4100.dll")
        endif()
    endif()      
endforeach()
#foreach(lib1 ${OpenCV_LINK_LIBS})
#    message(STATUS "${lib1}")
#endforeach()
#foreach(lib2 ${OpenCV_DLLS})
#    message(STATUS "${lib2}")
#endforeach()
include_directories(${OpenCV_INCLUDE_DIRS})
link_directories(${OpenCV_LIB_DIR} ${OpenCV_LIB_DIR_DEBUG} ${OpenCV_LIB_DIR_RELEASE})
link_libraries(${OpenCV_LINK_LIBS} ${OpenCV_DLLS})
message(STATUS "OpenCV_INCLUDE_DIRS: ${OpenCV_INCLUDE_DIRS}")
message(STATUS "OpenCV_LIB_DIR: ${OpenCV_LIB_DIR}")
message(STATUS "OpenCV_LINK_LIBS: ${OpenCV_LINK_LIBS}")

# CUDA 설정"C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1\lib\cmake\thrust\FindTBB.cmake"
set(CUDAToolkit_DIR "C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v12.1")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${CUDAToolkit_DIR}/lib/cmake") #Find<Module>.cmake
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH};${CUDAToolkit_DIR}") #CMakeLists.txt
find_package(CUDAToolkit REQUIRED)
set(CUDAToolkit_LIBRARIES 
    cudaarithm cudafilters cudawarping cudacodec cudafeatures2d cudaimgproc cudart_static cuda
    CUDA::cudart CUDA::cuda_driver CUDA::nvrtc CUDA::cublas CUDA::curand CUDA::cufft
)
# ${CUDAToolkit_INCLUDE_DIRS} C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v12.1/include
set(CUDAToolkit_LIB_DIR "${CUDAToolkit_DIR}/lib/x64")
set(CUDA_NVCC_EXECUTABLE "${CUDAToolkit_DIR}/bin/nvcc.exe")
set(CUDA_ARCHITECTURES "89")
set(CUDA_NVCC_FLAGS ${CUDA_NVCC_FLAGS} -std=c++20 --expt-relaxed-constexpr -gencode arch=compute_89,code=sm_89)
#set(CUDA_NVCC_FLAGS ${CUDA_NVCC_FLAGS} -std=c++20 --expt-relaxed-constexpr) # -gencode : torch의 TORCH_CUDA_ARCH_LIST과 함깨 사용하지 말것
include_directories("${CUDAToolkit_INCLUDE_DIRS}")
link_directories("${CUDAToolkit_LIB_DIR}")
link_libraries("${CUDAToolkit_LIBRARIES}")
message(STATUS "CUDAToolkit_INCLUDE_DIRS: ${CUDAToolkit_INCLUDE_DIRS}")
message(STATUS "CUDAToolkit_LIB_DIR: ${CUDAToolkit_LIB_DIR}")
message(STATUS "CUDAToolkit_LIBRARIES: ${CUDAToolkit_LIBRARIES}")




# CUDNN 설정
set(CUDNN_DIR "C:/Program Files/NVIDIA/CUDNN/v9.1")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${CUDNN_DIR}/cmake") #Find<Module>.cmake
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH};${CUDNN_DIR}") #CMakeLists.txt
#find_package(CUDNN REQUIRED) -- error occured
set(USE_CUDNN ON CACHE BOOL "Use CUDNN for deep learning") 
set(cuDNN_INCLUDE_DIR "${CUDNN_DIR}/include/12.4")
set(CUDNN_BIN "${CUDNN_DIR}/bin/12.4" ${CUDNN_BIN})
set(cuDNN_LIB_DIR "${CUDNN_DIR}/lib/12.4/x64" ${cuDNN_LIB_DIR})
set(cuDNN_LIBRARY "${CUDNN_DIR}/lib/12.4/x64/cudnn.lib" ${cuDNN_LIBRARY})
set(CUDNN_LIBRARIES "${CUDNN_DIR}/lib/12.4/x64/cudnn.lib" ${CUDNN_LIBRARIES})
include_directories("${cuDNN_INCLUDE_DIR}")
link_directories("${cuDNN_LIB_DIR}")
link_libraries("${CUDNN_LIBRARIES}")
message(STATUS "USE_CUDNN : ${USE_CUDNN}")
message(STATUS "CUDNN_INCLUDE_DIR : ${cuDNN_INCLUDE_DIR}") #C:/Program Files/NVIDIA/CUDNN/v9.1/include/12.4;C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v12.1/include
message(STATUS "CUDNN_BIN : ${CUDNN_BIN}") # C:/Program Files/NVIDIA/CUDNN/v9.1/bin/12.4
message(STATUS "cuDNN_LIBRARY : ${cuDNN_LIBRARY}") #C:/Program Files/NVIDIA/CUDNN/v9.1/lib/12.4/x64
message(STATUS "CUDNN_LIBRARIES : ${CUDNN_LIBRARIES}") #C:/Program Files/NVIDIA/CUDNN/v9.1/lib/12.4/x64/cudnn.lib


# GStreamer 설정
set(GSTREAMER_DIR "C:/gstreamer/1.0/msvc_x86_64")
#set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${GSTREAMER_DIR}/cmake") #Find<Module>.cmake --cmake 폴더 없음
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH};${GSTREAMER_DIR}") #CMakeLists.txt
find_package(GStreamer REQUIRED) # 호출패이키명의 대소문자를 확실히 입력
# C:/gstreamer/1.0/msvc_x86_64/include/gstreamer-1.0;C:/gstreamer/1.0/msvc_x86_64/include/glib-2.0;C:/gstreamer/1.0/msvc_x86_64/lib/glib-2.0/include
set(GLIB2_INCLUDE_DIRS "${GSTREAMER_DIR}/include/glib-2.0") #C:/gstreamer/1.0/msvc_x86_64/include/glib-2.0
set(GLIB2_LIBRARIES "${GSTREAMER_DIR}/lib/glib-2.0.lib") #C:/gstreamer/1.0/msvc_x86_64/lib/glib-2.0.lib
set(GTHREAD2_LIBRARIES "${GSTREAMER_DIR}/lib/gthread-2.0.lib") #C:/gstreamer/1.0/msvc_x86_64/lib/gthread-2.0.lib
set(GSTREAMER_INCLUDE_DIRS "${GSTREAMER_DIR}/include/gstreamer-1.0" "${GSTREAMER_DIR}/include/glib-2.0" "${GSTREAMER_DIR}/lib/glib-2.0/include" ${GSTREAMER_INCLUDE_DIRS} ${GLIB2_INCLUDE_DIRS})
set(GSTREAMER_LIB_DIRS "${GSTREAMER_DIR}/lib") #C:/gstreamer/1.0/msvc_x86_64/lib
set(GSTREAMER_LIBRARIES gstreamer-1.0 gobject-2.0.lib glib-2.0.lib gstapp-1.0.lib gstbase-1.0.lib gstvideo-1.0.lib ${GLIB2_LIBRARIES} ${GTHREAD2_LIBRARIES})
include_directories(${GSTREAMER_INCLUDE_DIRS})
link_directories(${GSTREAMER_LIB_DIRS})
link_libraries(${GSTREAMER_LIBRARIES})
# GLib 및 GThread 라이브러리를 찾고 연결
#find_library(TMP_VALUE NAMES glib-2.0 PATHS ${GSTREAMER_LIB_DIRS}) # C:/gstreamer/1.0/msvc_x86_64/lib/glib-2.0.lib
message(STATUS "GLIB2_INCLUDE_DIRS : ${GLIB2_INCLUDE_DIRS}")
message(STATUS "GLIB2_LIBRARIES : ${GLIB2_LIBRARIES}")
message(STATUS "GTHREAD2_LIBRARIES : ${GTHREAD2_LIBRARIES}")
message(STATUS "GSTREAMER_INCLUDE_DIRS : ${GSTREAMER_INCLUDE_DIRS}")
message(STATUS "GSTREAMER_LIB_DIRS : ${GSTREAMER_LIB_DIRS}")
message(STATUS "GSTREAMER_LIBRARIES : ${GSTREAMER_LIBRARIES}")
if(NOT GLIB2_LIBRARIES)
    message(FATAL_ERROR "Could not find GLIB2_LIBRARIES")
endif()
if(NOT GTHREAD2_LIBRARIES)
    message(FATAL_ERROR "Could not find GTHREAD2_LIBRARIES")
endif()



# LibTorch 설정
set(Torch_DIR "C:/libtorch")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${Torch_DIR}/cmake" "${Torch_DIR}/libtorch/share/cmake") #Find<Module>.cmake --cmake 폴더 없음
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH}" "${Torch_DIR}") #CMakeLists.txt
find_package(Torch REQUIRED)
#CUDA 아키텍처 플래그를 설정
set(TORCH_CUDA_ARCH_LIST "8.9") # NVIDIA GeForce RTX 4060 8.9 Ada Lovelace 아키텍처를 기반 compute capability 8.9를 지원
#cuda_select_nvcc_arch_flags(ARCH_FLAGS ${TORCH_CUDA_ARCH_LIST}) 지원하지않아
#C:\libtorch\share\cmake\Caffe2\public\utils.cmake 수정
#cuda_select_nvcc_arch_flags(${store_var} ${TORCH_CUDA_ARCH_LIST})
# => set(TORCH_CUDA_ARCH_LIST ${TORCH_CUDA_ARCH_LIST})
set(Torch_INCLUDE_DIRS "${Torch_DIR}/include" "${Torch_DIR}/libtorch/include" "${Torch_INCLUDE_DIRS}")
set(Torch_BIN "${Torch_DIR}/bin" "${Torch_DIR}/lib")
set(Torch_LIB_DIR "${Torch_DIR}/lib" "${Torch_LIB_DIR}")
set(Torch_LIBRARY "${Torch_DIR}/lib/torch.lib" ${Torch_LIBRARY})
set(Torch_LIBRARIES "${Torch_DIR}/lib/torch.lib" ${Torch_LIBRARIES})
include_directories("${Torch_INCLUDE_DIRS}")
link_directories("${Torch_LIB_DIR}")
link_libraries("${Torch_LIBRARIES}")
message(STATUS "Torch_DIR : ${Torch_DIR}")
message(STATUS "Torch_INCLUDE_DIRS : ${Torch_INCLUDE_DIRS}")
message(STATUS "Torch_BIN : ${Torch_BIN}")
message(STATUS "Torch_LIB_DIR : ${Torch_LIB_DIR}")
message(STATUS "Torch_LIBRARY : ${Torch_LIBRARY}")
message(STATUS "Torch_LIBRARIES : ${Torch_LIBRARIES}")


# flatbuffers 설정
set(FLATBUFFERS_DIR "C:/flatbuffers")
set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${FLATBUFFERS_DIR}/Cmake") #Find<Module>.cmake --cmake 폴더 없음
set(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH}" "${FLATBUFFERS_DIR}") #CMakeLists.txt
set(FLATBUFFERS_BIN "${FLATBUFFERS_DIR}/build/${CMAKE_BUILD_TYPE}")
set(FLATBUFFERS_FLATC_EXECUTABLE "${FLATBUFFERS_BIN}/flatc.exe") #find_package 이전에 설정할것
find_package(FlatBuffers REQUIRED)
set(FLATBUFFERS_INCLUDE_DIRS "${FLATBUFFERS_DIR}/include" "${FLATBUFFERS_INCLUDE_DIRS}")
set(FLATBUFFERS_LIB_DIR "${FLATBUFFERS_DIR}/build/${CMAKE_BUILD_TYPE}" "${FLATBUFFERS_LIB_DIR}")
set(FLATBUFFERS_LIBRARY "${FLATBUFFERS_DIR}/build/${CMAKE_BUILD_TYPE}/flatbuffers.lib" ${FLATBUFFERS_LIBRARY})
set(FLATBUFFERS_LIBRARIES "${FLATBUFFERS_DIR}/build/${CMAKE_BUILD_TYPE}/flatbuffers.lib" ${FLATBUFFERS_LIBRARIES})
include_directories("${FLATBUFFERS_INCLUDE_DIR}")
link_directories("${FLATBUFFERS_LIB_DIR}")
link_libraries("${FLATBUFFERS_LIBRARIES}")
message(STATUS "FLATBUFFERS_DIR : ${FLATBUFFERS_DIR}")
message(STATUS "FLATBUFFERS_INCLUDE_DIRS : ${FLATBUFFERS_INCLUDE_DIRS}")
message(STATUS "FLATBUFFERS_BIN : ${FLATBUFFERS_BIN}")
message(STATUS "FLATBUFFERS_LIB_DIR : ${FLATBUFFERS_LIB_DIR}")
message(STATUS "FLATBUFFERS_LIBRARY : ${FLATBUFFERS_LIBRARY}")
message(STATUS "FLATBUFFERS_LIBRARIES : ${FLATBUFFERS_LIBRARIES}")



# tensorflow 설정
# 헤더 파일 경로 포함
#set(tensorflow_ROOT_DIR "C:/tensorflow")
#include_directories(
#    ${tensorflow_ROOT_DIR}
#    "${tensorflow_ROOT_DIR}/third_party/xla"
#    "${tensorflow_ROOT_DIR}/third_party/eigen3")
# 라이브러리 생성
#set(tensorflow_SOURCES
#    ${tensorflow_ROOT_DIR}/tensorflow/core/util/proto/proto_utils.cc
#    ${tensorflow_ROOT_DIR}/tensorflow/core/framework/shape_inference.cc
#)
#add_library(tensorflow_util_proto ${tensorflow_SOURCES})

# ONNX 설정

set(ONNX_ROOT "C:/onnx")
set(CMAKE_PREFIX_PATH "${ONNX_DIR};${CMAKE_PREFIX_PATH}")
set(onnx_DIR "${ONNX_ROOT}/build") # ONNXConfig.cmake
set(onnx_proto "${ONNX_ROOT}/onnx")
include_directories("${ONNX_ROOT}")
link_directories("${ONNX_ROOT}/build/lib/pkgconfig")

# Protobuf 설정 버전 4.25.1
set(Protobuf_INCLUDE_DIR "C:/protobuf/src")
find_package(Protobuf REQUIRED)
include_directories(${PROTOBUF_INCLUDE_DIRS})
link_directories(${PROTOBUF_LIBRARY_DIRS})

# GSL 설정 추가
set(GSL_ROOT "${CMAKE_PREFIX_PATH}/gsl_x64-windows")
set(GSL_INCLUDE_DIR "${GSL_ROOT}/include")
set(GSL_LIBRARY "${GSL_ROOT}/lib")
set(GSL_CBLAS_LIBRARY "${GSL_LIBRARY}/gslcblas.lib")
find_package(GSL REQUIRED)
include_directories(${GSL_INCLUDE_DIRS})
link_directories(${GSL_LIBRARY_DIRS})


# ONNX Runtime 설정
set(ONNX_RUNTIME_ROOT "C:/onnxruntime")
set(onnxruntime_dir "${ONNX_RUNTIME_ROOT}/build/Debug")
set(onnxruntime_include_dir 
    "${ONNX_RUNTIME_ROOT}"
    "${ONNX_RUNTIME_ROOT}/cmake/build/_deps/safeint-src"
    "${ONNX_RUNTIME_ROOT}/cmake/build/_deps/mp11-src/include"
    "${ONNX_RUNTIME_ROOT}/cmake/build/_deps/onnx-src/onnx"
    "${ONNX_RUNTIME_ROOT}/cmake/build"
    "${ONNX_RUNTIME_ROOT}/build"
    "${ONNX_RUNTIME_ROOT}/onnxruntime"
    "${ONNX_RUNTIME_ROOT}/build/_deps/mp11-src/include"
    "${ONNX_RUNTIME_ROOT}/build/_deps/safeint-src"
    "${ONNX_RUNTIME_ROOT}/include/onnxruntime"
    "${ONNX_RUNTIME_ROOT}/include/onnxruntime/core/session")
include_directories("${onnxruntime_include_dir}")
link_directories("${onnxruntime_dir}")

# Vulkan 설정
set(Vulkan_SDK "C:/VulkanSDK/1.3.290.0")
set(Vulkan_BIN "${Vulkan_SDK}/Bin")
set(Vulkan_INCLUDE_DIR "${Vulkan_SDK}/Include")
set(Vulkan_LIBRARY "${Vulkan_SDK}/Lib")
find_package(Vulkan REQUIRED)
message(STATUS "Vulkan INCLUDE found: ${Vulkan_INCLUDE_DIRS}")
message(STATUS "Vulkan LIBRARY found: ${Vulkan_LIBRARIES}")
find_program(GLSLC_EXECUTABLE glslc PATHS ${Vulkan_BIN} NO_DEFAULT_PATH)
find_program(GLSLANGVALIDATOR_EXECUTABLE glslangValidator PATHS ${Vulkan_BIN} NO_DEFAULT_PATH)
if(NOT GLSLC_EXECUTABLE)
    message(FATAL_ERROR "glslc executable not found. Please ensure Vulkan SDK is installed correctly.")
endif()
if(NOT GLSLANGVALIDATOR_EXECUTABLE)
    message(FATAL_ERROR "glslangValidator executable not found. Please ensure Vulkan SDK is installed correctly.")
endif()
message(STATUS "glslc found: ${GLSLC_EXECUTABLE}")
message(STATUS "glslangValidator found: ${GLSLANGVALIDATOR_EXECUTABLE}")

# IPP 설정
set(IPP_ROOT "C:/Program Files (x86)/Intel/oneAPI/ipp/2021.11")
include_directories("${IPP_ROOT}/include")
link_directories("${IPP_ROOT}/lib")



# IPLIB 설정
set(IPLIB_ROOT "C:/myLab/Project1/Project1/imageProcessingLib")
set(IPLIB_LIBRARY "${IPLIB_ROOT}/build/${CMAKE_BUILD_TYPE}/imageProcessingLib.lib")
set(IPLIB_DLL "${IPLIB_ROOT}/build/${CMAKE_BUILD_TYPE}/imageProcessingLib.dll")
include_directories("${IPLIB_ROOT}")
link_directories(
    "${IPLIB_ROOT}/build/bin/${CMAKE_BUILD_TYPE}" #imageProcessingLib.lib
    "${IPLIB_ROOT}/build/lib/${CMAKE_BUILD_TYPE}" #imageProcessingLib.lib
)
link_libraries("${IPLIB_LIBRARY}")

# Abseil 라이브러리 설정
# Google이 개발하고 관리하는 오픈 소스 C++ 라이브러리
set(ABSEIL_ROOT "C:/abseil-cpp")
include_directories("${ABSEIL_ROOT}")
link_directories("${ABSEIL_ROOT}/build/lib")


# date 설정
set(DATE_ROOT "C:/date")
set(DATE_INCLUDE_DIR "${DATE_ROOT}/build/${CMAKE_BUILD_TYPE}")
include_directories("${DATE_ROOT}/include")
link_directories("${DATE_INCLUDE_DIR}")



# cuSPARSELt 설정
set(USE_CUSPARSELT ON CACHE BOOL "Use USE_CUSPARSELT")
message(STATUS "USE_CUSPARSELT: ${USE_CUSPARSELT}")
set(CUSPARSELT_INCLUDE_DIR "${CUDA_TOOLKIT_INCLUDE_DIR}")
set(CUSPARSELT_LIB_DIR "${CUDA_TOOLKIT_LIB_DIR}")
set(CUSPARSELT_LIBRARY "${CUDA_TOOLKIT_LIB_DIR}/cusparse.lib")



# Thread 설정
find_package(Threads REQUIRED)

# CAFFE2 설정
set(CAFFE2_USE_CUDNN ON CACHE BOOL "Use cuDNN in Caffe2")
message(STATUS "CAFFE2_USE_CUDNN: ${CAFFE2_USE_CUDNN}")
if(CAFFE2_USE_CUDNN)
  message(STATUS "cuDNN is enabled for Caffe2.")
else()
  message(STATUS "cuDNN is not enabled for Caffe2.")
endif()

# Qt 래핑 파일 생성
qt6_wrap_cpp(MOC_FILES
    MainWindow.h
    ImageProcessor.h
)

# 실행 파일 추가
add_executable(Project1
    main.cpp
    MainWindow.cpp
    MainWindow.h
    MainWindow.ui
    ImageProcessor.cpp
    ImageProcessor.h
    ImageProcessing.cu
    ImageProcessing.cuh
    ${MOC_FILES}
)



target_link_libraries(Project1

    ${Qt6_LIBRARIES}

    ${OpenCV_LINK_LIBS}

    ${GSTREAMER_LIBRARIES}

    ${TORCH_LIBRARIES}

    flatbuffers

    ${ONNX_RUNTIME_LIB}  # ONNX Runtime 라이브러리

    ${ONNX_LIB}  # ONNX 라이브러리

    ${Protobuf_LIB}  # Protobuf 라이브러리

    ${CUDAToolkit_LIBRARIES}  # CUDA Toolkit 라이브러리

    ${CUDNN_LIBRARIES}  # cuDNN 라이브러리

    ippcc.lib
    ippcore.lib
    ippvm.lib
    ipps.lib
    ippi.lib
    ippcv.lib  # Intel IPP 라이브러리

    nppc
    nppial
    nppicc
    nppidei
    nppif
    nppig
    nppim
    nppist
    nppisu
    nppitc
    npps  # NVIDIA Performance Primitives (NPP) 라이브러리

    Threads::Threads  # POSIX 스레드 라이브러리

    ${IPLIB_LIBRARY}  # 사용자 정의 라이브러리 (경로가 명시된 라이브러리)
)

# CUDA 아키텍처 플래그 적용
target_compile_options(Project1 PRIVATE ${ARCH_FLAGS})

# 파일 인코딩 설정 추가
add_compile_options("$<$<CXX_COMPILER_ID:MSVC>:/utf-8>")

# OpenMP 설정
find_package(OpenMP REQUIRED)
if(OpenMP_CXX_FOUND)
    target_link_libraries(Project1 OpenMP::OpenMP_CXX)
endif()

file(COPY ${IPLIB_DLL}
     DESTINATION "${CMAKE_BINARY_DIR}/${CMAKE_BUILD_TYPE}"
)
# C:/myLab/Project1/Project1/build/Debug
message(STATUS "IPLIB_DLL : ${CMAKE_BINARY_DIR}/${CMAKE_BUILD_TYPE}")

file(COPY ${IPLIB_LIBRARY}
     DESTINATION "${CMAKE_BINARY_DIR}/${CMAKE_BUILD_TYPE}"
)
# C:/myLab/Project1/Project1/build/Debug
message(STATUS "IPLIB_LIBRARY : ${CMAKE_BINARY_DIR}/${CMAKE_BUILD_TYPE}")

#OpenCV DLL COPY
foreach(dll ${OpenCV_DLLS})
    add_custom_command(TARGET Project1 POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${dll}" "$<TARGET_FILE_DIR:Project1>"
    )
endforeach()

PS C:\onnxruntime\build> cmake -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Debug ../cmake
CMake Deprecation Warning at CMakeLists.txt:14 (cmake_policy):
  The OLD behavior for policy CMP0104 will be removed from a future version
  of CMake.

  The cmake-policies(7) manual explains that the OLD behaviors of all
  policies are deprecated and that a policy should be set to OLD only under
  specific short-term circumstances.  Projects should be ported to the NEW
  behavior and not rely on setting a policy to OLD.


-- Selecting Windows SDK version 10.0.22621.0 to target Windows 10.0.22631.
-- The C compiler identification is MSVC 19.29.30154.0
-- The CXX compiler identification is MSVC 19.29.30154.0
-- The ASM compiler identification is MSVC
-- Found assembler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Found Protobuf: C:/protobuf/build/Release/libprotobuf.lib (found version "4.22.0")
CMake Warning (dev) at CMakeLists.txt:75 (include):
  Policy CMP0145 is not set: The Dart and FindDart modules are removed.  Run
  "cmake --help-policy CMP0145" for policy details.  Use the cmake_policy
  command to set the policy and suppress this warning.

This warning is for project developers.  Use -Wno-dev to suppress it.

CMake Warning (dev) at C:/Program Files/CMake/share/cmake-3.29/Modules/Dart.cmake:47 (message):
  Policy CMP0145 is not set: The Dart and FindDart modules are removed.  Run
  "cmake --help-policy CMP0145" for policy details.  Use the cmake_policy
  command to set the policy and suppress this warning.
Call Stack (most recent call first):
  CMakeLists.txt:75 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

-- The ASM_MASM compiler identification is MSVC
-- Found assembler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/ml64.exe
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Failed
-- Looking for pthread_create in pthreads
-- Looking for pthread_create in pthreads - not found
-- Looking for pthread_create in pthread
-- Looking for pthread_create in pthread - not found
-- Found Threads: TRUE
-- Found Patch: C:/Program Files/Git/usr/bin/patch.exe
Patch found: C:/Program Files/Git/usr/bin/patch.exe
Loading Dependencies URLs ...
Loading Dependencies ...
-- Performing Test ABSL_INTERNAL_AT_LEAST_CXX17
-- Performing Test ABSL_INTERNAL_AT_LEAST_CXX17 - Success
-- Performing Test ABSL_INTERNAL_AT_LEAST_CXX20
-- Performing Test ABSL_INTERNAL_AT_LEAST_CXX20 - Failed
-- Abseil source dir:C:/onnxruntime/build/_deps/abseil_cpp-src
# date: USE_SYSTEM_TZ_DB ON
# date: MANUAL_TZ_DB OFF
# date: USE_TZ_DB_IN_DOT OFF
# date: BUILD_SHARED_LIBS OFF
# date: ENABLE_DATE_TESTING OFF
# date: DISABLE_STRING_VIEW OFF
--
-- 3.21.12.0
-- Performing Test protobuf_HAVE_LD_VERSION_SCRIPT
-- Performing Test protobuf_HAVE_LD_VERSION_SCRIPT - Success
-- Found ZLIB: C:/zlib/build/Release/zlib.lib (found version "1.2.12")
CMake Deprecation Warning at C:/onnxruntime/build/_deps/nlohmann_json-src/CMakeLists.txt:1 (cmake_minimum_required):
  Compatibility with CMake < 3.5 will be removed from a future version of
  CMake.

  Update the VERSION argument <min> value or use a ...<max> suffix to tell
  CMake that the project does not need compatibility with older versions.


-- Using the single-header code from C:/onnxruntime/build/_deps/nlohmann_json-src/single_include/
-- Proceeding with version: 23.5.26.0
-- Looking for _strtof_l
-- Looking for _strtof_l - found
-- Looking for _strtoui64_l
-- Looking for _strtoui64_l - found
-- CMAKE_CXX_FLAGS: /DWIN32 /D_WINDOWS /EHsc /Zc:__cplusplus /EHsc /wd26812 -DEIGEN_HAS_C99_MATH -DCPUINFO_SUPPORTED
CMake Deprecation Warning at C:/onnxruntime/build/_deps/pytorch_clog-src/deps/clog/CMakeLists.txt:1 (CMAKE_MINIMUM_REQUIRED):
  Compatibility with CMake < 3.5 will be removed from a future version of
  CMake.

  Update the VERSION argument <min> value or use a ...<max> suffix to tell
  CMake that the project does not need compatibility with older versions.


CMake Warning (dev) at C:/onnxruntime/build/_deps/onnx-src/CMakeLists.txt:107 (find_package):
  Policy CMP0148 is not set: The FindPythonInterp and FindPythonLibs modules
  are removed.  Run "cmake --help-policy CMP0148" for policy details.  Use
  the cmake_policy command to set the policy and suppress this warning.

This warning is for project developers.  Use -Wno-dev to suppress it.

-- Found PythonInterp: C:/Users/nayou/AppData/Local/Programs/Python/Python312/python.exe (found version "3.12.3")
Generated: C:/onnxruntime/build/_deps/onnx-build/onnx/onnx-ml.proto
Generated: C:/onnxruntime/build/_deps/onnx-build/onnx/onnx-operators-ml.proto
Generated: C:/onnxruntime/build/_deps/onnx-build/onnx/onnx-data.proto
--
-- ******** Summary ********
--   CMake version                     : 3.29.3
--   CMake command                     : C:/Program Files/CMake/bin/cmake.exe
--   System                            : Windows
--   C++ compiler                      : C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe
--   C++ compiler version              : 19.29.30154.0
--   CXX flags                         : /DWIN32 /D_WINDOWS /EHsc /Zc:__cplusplus /EHsc /wd26812 -DEIGEN_HAS_C99_MATH -DCPUINFO_SUPPORTED /EHsc /wd26812
--   Build type                        : Debug
--   Compile definitions               : ORT_ENABLE_STREAM;ORT_NO_RTTI;EIGEN_MPL2_ONLY;EIGEN_HAS_CONSTEXPR;EIGEN_HAS_VARIADIC_TEMPLATES;EIGEN_HAS_CXX11_MATH;EIGEN_HAS_CXX11_ATOMIC;EIGEN_STRONG_INLINE=inline;__STDC_FORMAT_MACROS
--   CMAKE_PREFIX_PATH                 :
--   CMAKE_INSTALL_PREFIX              : C:/Program Files (x86)/onnxruntime
--   CMAKE_MODULE_PATH                 : C:/onnxruntime/cmake/external
--
--   ONNX version                      : 1.16.1
--   ONNX NAMESPACE                    : onnx
--   ONNX_USE_LITE_PROTO               : ON
--   USE_PROTOBUF_SHARED_LIBS          : OFF
--   Protobuf_USE_STATIC_LIBS          : ON
--   ONNX_DISABLE_EXCEPTIONS           : OFF
--   ONNX_DISABLE_STATIC_REGISTRATION  : OFF
--   ONNX_WERROR                       : OFF
--   ONNX_BUILD_TESTS                  : OFF
--   ONNX_BUILD_BENCHMARKS             : OFF
--   ONNX_BUILD_SHARED_LIBS            :
--   BUILD_SHARED_LIBS                 : OFF
--
--   Protobuf compiler                 : C:/protobuf/build/Release/protoc.exe
--   Protobuf includes                 : C:/protobuf/build/install/include
--   Protobuf libraries                : C:/protobuf/build/Release/libprotobuf.lib
--   BUILD_ONNX_PYTHON                 : OFF
Finished fetching external dependencies
-- Found Git: C:/Program Files/Git/cmd/git.exe (found version "2.45.1.windows.1")
fatal: detected dubious ownership in repository at 'C:/onnxruntime'
'C:/onnxruntime' is owned by:
        BUILTIN/Administrators (S-1-5-32-544)
but the current user is:
        KIMNAYOOUNG/nayou (S-1-5-21-3734693049-4166439889-937236257-1001)
To add an exception for this directory, call:

        git config --global --add safe.directory C:/onnxruntime
fatal: detected dubious ownership in repository at 'C:/onnxruntime'
'C:/onnxruntime' is owned by:
        BUILTIN/Administrators (S-1-5-32-544)
but the current user is:
        KIMNAYOOUNG/nayou (S-1-5-21-3734693049-4166439889-937236257-1001)
To add an exception for this directory, call:

        git config --global --add safe.directory C:/onnxruntime
CMake Warning at CMakeLists.txt:1649 (message):
  MPI and NCCL are disabled because build is on Windows or USE_NCCL is set to
  OFF.


-- Configuring done (31.3s)
-- Generating done (12.9s)
-- Build files have been written to: C:/onnxruntime/build

Deprecated CMake 정책 경고:

cmake_policy 관련 경고가 몇 가지 나타납니다. 이는 특정 CMake 정책이 향후 버전에서 지원되지 않거나 변경될 예정이라는 경고입니다.
예를 들어, CMP0104, CMP0145, CMP0148 등의 정책이 포함되어 있습니다. 이는 프로젝트 유지 관리자가 새로운 정책을 사용하도록 코드를 업데이트해야 한다는 의미입니다.
경고: FindDart 모듈 제거:

Dart 및 FindDart 모듈이 제거되었으며, 관련된 정책이 설정되지 않았다는 경고입니다. 이는 현재 사용 중인 CMakeLists.txt 파일이 오래된 모듈을 참조하고 있다는 것을 의미합니다.
Git 소유권 문제:

Git 리포지토리에서 dubious ownership(의심스러운 소유권) 문제가 발생했습니다. 현재 사용자와 리포지토리의 소유자가 다르기 때문에 발생하는 문제입니다.
이 문제를 해결하려면 아래 명령어를 사용하여 해당 디렉터리를 안전한 디렉터리로 설정할 수 있습니다:
bash
코드 복사
git config --global --add safe.directory C:/onnxruntime

Windows에서 MPI와 NCCL 비활성화:

MPI와 NCCL이 Windows에서는 비활성화되었음을 알리는 메시지가 있습니다. 이는 Windows 환경에서의 제한 사항을 나타냅니다.

PS C:\onnxruntime\build> cmake -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Debug ../cmake
-- Selecting Windows SDK version 10.0.22621.0 to target Windows 10.0.22631.
CMake Error at CMakeLists.txt:80 (include):
  include could not find requested file:

    Dart
PS C:\> git clone https://github.com/dart-lang/sdk.git
"C:\onnxruntime\cmake\CMakeLists.txt" 수정
# cmake_policy(SET CMP0104 OLD) # 권장되지 않음
# 추가
cmake_policy(SET CMP0104 NEW)
cmake_policy(SET CMP0145 NEW)
cmake_policy(SET CMP0148 NEW)
# Set Dart SDK root 추가
set(DART_ROOT "C:/Dart")

Debug 폴더 생성 안되는 현상
PS C:\onnxruntime\build> Remove-Item -Recurse -Force C:/onnxruntime/build/CMakeCache.txt
PS C:\onnxruntime\build> Remove-Item -Recurse -Force C:/onnxruntime/build/CMakeFiles
PS C:\onnxruntime> Remove-Item -Recurse -Force C:/onnxruntime/build
PS C:\onnxruntime> New-Item -ItemType Directory -Path C:/onnxruntime/build
    디렉터리: C:\onnxruntime
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2024-08-24   오전 7:05                build

PS C:\onnxruntime> cd build
PS C:\onnxruntime\build> cmake -G "Visual Studio 16 2019" ../cmake
"C:\onnxruntime\build\onnxruntime.sln" -> Visual Studio 2019 로 열기 한 후 디버그 모드/릴리즈 모드로 빌드하면 
C:\onnxruntime\build\Debug, C:\onnxruntime\build\Relase 폴더 생성됨

CMake Error at C:/opencv/sources/cmake/FindONNX.cmake:1 (ocv_clear_vars):
  Unknown CMake command "ocv_clear_vars".
Call Stack (most recent call first):
  CMakeLists.txt:267 (find_package)
"C:\opencv\sources\cmake\FindONNX.cmake" 수정
#ocv_clear_vars(HAVE_ONNX) #주석처리
# if(NOT HAVE_ONNX) 주석처리
#  ocv_clear_vars(HAVE_ONNX ORT_LIB ORT_INCLUDE_DIR)
# endif()
# 추가
if(NOT HAVE_ONNX)
  # 수동으로 변수 초기화
  set(HAVE_ONNX)
  set(ORT_LIB)
  set(ORT_INCLUDE_DIR)
endif()
PS C:\onnx\build> cmake -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Debug ..
PS C:\onnx\build> cmake -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Release ..
C:\onnx\build에 Debug or Relase 폴더가 생성되지않으면 Visual Studio 2019로 sln파일 열어서
Debug, Relase 모드로 빌드를 해주면 생성이 된다.

gsl 재설치(깃 주소 오류)
GNU Scientific Library (GSL)은 다양한 수학 및 과학 계산을 위한 라이브러리
MSYS2 MinGW 64-bit 쉘을 열고 다음 명령어를 실행하여 패키지를 업데이트
cd /c/
패키지를 업데이트
pacman -Syu
MinGW-w64 및 필요한 도구를 설치
pacman -S mingw-w64-x86_64-gcc mingw-w64-x86_64-make
깃 설치
pacman -S git
깃 로그인
아이디 입력, 패스워드에 Personal Access Token 생성해서 붙여넣기
GitHub에서 Personal Access Token 생성
[순서]
GitHub 계정에 로그인합니다.
우측 상단 프로필 아이콘을 클릭하고 Settings로 이동합니다.
Developer settings를 클릭하고, 왼쪽 메뉴에서 Personal access tokens > **Tokens (classic)**를 선택합니다.
Generate new token 버튼을 클릭합니다.
토큰에 이름을 지정하고, repo (모든 리포지토리에 대한 액세스 권한)와 read
(조직 정보 읽기 권한)와 같은 필요한 권한을 선택합니다.
토큰의 유효 기간을 선택한 후 Generate token 버튼을 클릭합니다.
생성된 토큰을 복사합니다. 이 토큰은 다시 표시되지 않으므로 안전한 곳에 저장하세요.
Git 명령어로 Personal Access Token 사용
GSL 리포지토리를 클론할 때 사용자 이름 대신 GitHub 사용자 이름을 입력하고, 
비밀번호 대신 Personal Access Token을 입력합니다.
다시 클론 명령어를 실행한 후:
git clone https://github.com/gnu/gsl.git
Username for 'https://github.com': 프롬프트가 나오면 GitHub 사용자 이름을 입력합니다.
Password for 'https://<your-email>@github.com': 프롬프트가 나오면, 
복사한 Personal Access Token을 붙여넣습니다.
nayou@kimnayooung MINGW64 /c
# git clone https://github.com/ampl/gsl.git
nayou@kimnayooung MINGW64 /c
# git clone https://github.com/ampl/gsl.git
'gsl'에 복제합니다...
remote: Enumerating objects: 5373, done.
remote: Counting objects: 100% (1071/1071), done.
remote: Compressing objects: 100% (529/529), done.
remote: Total 5373 (delta 576), reused 921 (delta 506), pack-reused 4302 (from 1)
오브젝트를 받는 중: 100% (5373/5373), 13.89 MiB | 10.35 MiB/s, 완료.
델타를 알아내는 중: 100% (2921/2921), 완료.
warning: Clone succeeded, but checkout failed.
You can inspect what was checked out with 'git status'
and retry with 'git restore --source=HEAD :/'
nayou@kimnayooung MINGW64 /c/gsl
# git restore --source=HEAD :/

nayou@kimnayooung MINGW64 /c/gsl
# git config --system core.longpaths true

nayou@kimnayooung MINGW64 /c/gsl
# git reset --hard HEAD
Updating files: 100% (2290/2290), 완료.
HEAD의 현재 위치는 60539d2입니다 Docs: replace direct link by reference
cd /c/
rm -rf gsl
git clone https://github.com/ampl/gsl.git
설치완료
CMake Error at ampl/CMakeLists.txt:6 (add_subdirectory):
  The source directory

    C:/gsl/ampl/thirdparty/asl

  does not contain a CMakeLists.txt file.


CMake Error at ampl/CMakeLists.txt:7 (add_to_folder):
  Unknown CMake command "add_to_folder".

nayou@kimnayooung MINGW64 /c/gsl
# git submodule update --init --recursive
'ampl/thirdparty/asl' 경로에 대해 'ampl/thirdparty/asl' (https://github.com/ampl/asl.git) 하위 모듈 등록
'/c/gsl/ampl/thirdparty/asl'에 복제합니다...
Submodule path 'ampl/thirdparty/asl': checked out 'dd1c4c4e5647ead51169caad280c36a88d0f0237'
"C:\gsl\CMakeLists.txt"
"C:\gsl\ampl\thirdparty\asl\CMakeLists.txt"
두파일의 CMake 버전 에러 -> 3.5로 변경
Debug, Release로 visual studio  2019로 빌드

CMake Error at C:/Program Files/CMake/share/cmake-3.29/Modules/FindPackageHandleStandardArgs.cmake:230 (message):
  Could NOT find GSL (missing: GSL_INCLUDE_DIR GSL_LIBRARY GSL_CBLAS_LIBRARY)
  (found version "")
Call Stack (most recent call first):
  C:/Program Files/CMake/share/cmake-3.29/Modules/FindPackageHandleStandardArgs.cmake:600 (_FPHSA_FAILURE_MESSAGE)
  C:/Program Files/CMake/share/cmake-3.29/Modules/FindGSL.cmake:151 (find_package_handle_standard_args)
  CMakeLists.txt:337 (find_package)
#find_package(GSL REQUIRED) 주석처리 후 성공

date date.lib 생성안돼서 재설치
c:/date 삭제
C:\>git clone https://github.com/HowardHinnant/date.git
Cloning into 'date'...
remote: Enumerating objects: 3989, done.
remote: Counting objects: 100% (334/334), done.
remote: Compressing objects: 100% (139/139), done.
remote: Total 3989 (delta 178), reused 254 (delta 155), pack-reused 3655 (from 1)
Receiving objects: 100% (3989/3989), 3.31 MiB | 10.51 MiB/s, done.
Resolving deltas: 100% (2556/2556), done.
C:\date\build>cmake -G "Visual Studio 16 2019" -DCMAKEBUILD_TYPE=Debug ..
C:\date\build>cmake -G "Visual Studio 16 2019" -DCMAKEBUILD_TYPE=Debug ..
-- Selecting Windows SDK version 10.0.22621.0 to target Windows 10.0.22631.
-- The C compiler identification is MSVC 19.29.30154.0
-- The CXX compiler identification is MSVC 19.29.30154.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
# date: USE_SYSTEM_TZ_DB OFF
# date: MANUAL_TZ_DB OFF
# date: USE_TZ_DB_IN_DOT OFF
# date: BUILD_SHARED_LIBS OFF
# date: ENABLE_DATE_TESTING OFF
# date: DISABLE_STRING_VIEW OFF
-- Configuring done (6.8s)
-- Generating done (0.0s)
CMake Warning:
  Manually-specified variables were not used by the project:

    CMAKEBUILD_TYPE


-- Build files have been written to: C:/date/build
C:\date\build>cmake --build . --config=Debug
.NET Framework용 Microsoft (R) Build Engine 버전 16.11.2+f32259642
Copyright (C) Microsoft Corporation. All rights reserved.

  1>Checking Build System
  Building Custom Rule C:/date/CMakeLists.txt

date.lib 생성안됨
"C:\date\CMakeLists.txt" 분석
BUILD_TZ_LIB 옵션이 켜져야 date-tz 라이브러리가 컴파일되며, 
date-tz 라이브러리는 date.lib와 같은 실제 라이브러리 파일을 생성
C:\date\build>cmake -G "Visual Studio 16 2019" -DBUILD_TZ_LIB=ON ..
Could NOT find CURL (missing: CURL_LIBRARY CURL_INCLUDE_DIR)
CURL 라이브러리를 설치
C:\>git clone https://github.com/curl/curl.git
C:\>cd curl
C:\curl>mkdir build
C:\curl>cd build
C:\curl\build>cmake -G "Visual Studio 16 2019" -DCMAKEBUILD_TYPE=Debug ..
visual studio 2019에서 curl.sln 열어서 빌드

- Could NOT find Libssh2 (missing: LIBSSH2_INCLUDE_DIR LIBSSH2_LIBRARY)
Protocols: dict file ftp gopher http imap ipfs ipns ldap ldaps mqtt pop3 rtsp smb smtp telnet tftp
Features: alt-svc AsynchDNS HSTS IPv6 Largefile libz NTLM threadsafe UnixSockets
-- Enabled SSL backends:

https://packages.msys2.org/package/gettext-devel
pacman -S gettext-devel
/usr/share/gettext/archive.dir.tar.xz

nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autoreconf-2.72: running: aclocal
configure.ac:175: error: '#' is already registered with AC_CONFIG_FILES.
../autoconf-2.72/lib/autoconf/status.m4:289: AC_CONFIG_FILES is expanded from...
configure.ac:175: the top level
autom4te-2.72: error: /usr/bin/m4 failed with exit status: 1
aclocal-1.17: error: /usr/bin/autom4te-2.72 failed with exit status: 1
autoreconf-2.72: error: aclocal failed with exit status: 1
AC_CONFIG_FILES에 동일한 파일이 여러 번 등록되었거나 중복된 파일명이 들어있기 때문
"C:\libidn2\configure.ac" 수정

nayou@kimnayooung MINGW64 /c/libidn2
autoreconf -v -i
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autoreconf-2.72: running: aclocal
configure.ac:175: error: '#' is already registered with AC_CONFIG_FILES.
../autoconf-2.72/lib/autoconf/status.m4:289: AC_CONFIG_FILES is expanded from...
configure.ac:175: the top level
autom4te-2.72: error: /usr/bin/m4 failed with exit status: 1
aclocal-1.17: error: /usr/bin/autom4te-2.72 failed with exit status: 1
autoreconf-2.72: error: aclocal failed with exit status: 1

nayou@kimnayooung MINGW64 /c/libidn2
# touch Makefile.am
"C:\libidn2\Makefile.am" 생성됨
파일 생성: 만약 해당 디렉터리에 Makefile.am 파일이 없다면, 
touch Makefile.am 명령어를 실행하면 빈 Makefile.am 파일이 생성
이미 존재하는 파일의 수정 시간이 갱신

각 Makefile.am생성 후 내용을 입력하고 저장한다.
src/Makefile.am:
bin_PROGRAMS = myprogram
myprogram_SOURCES = main.c utils.c
doc/Makefile.am:
dist_doc_DATA = README.md INSTALL.md
tests/Makefile.am:
check_PROGRAMS = test_program
test_program_SOURCES = test_main.c
examples/Makefile.am:
bin_PROGRAMS = example
example_SOURCES = example.c
lib/Makefile.am:
lib_LIBRARIES = libmylib.a
libmylib_a_SOURCES = mylib.c mylib.h
gl/Makefile.am:
include gnulib.mk
fuzz/Makefile.am:
# Include fuzzing related build files here.
po/Makefile.am:
# Include localization related build files here.
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autoreconf-2.72: running: aclocal -I m4
autoreconf-2.72: configure.ac: tracing
autoreconf-2.72: running: libtoolize --copy
autoreconf-2.72: configure.ac: not using Intltool
autoreconf-2.72: configure.ac: not using Gtkdoc
autoreconf-2.72: running: aclocal -I m4
autoreconf-2.72: running: /usr/bin/autoconf-2.72
autoreconf-2.72: running: /usr/bin/autoheader-2.72
autoreconf-2.72: running: automake --add-missing --copy --no-force
Makefile.am:1: warning: AM_GNU_GETTEXT used but 'po' not in SUBDIRS
Makefile.am:4: error: 'pkgconfig_DATA' is used but 'pkgconfigdir' is undefined
fuzz/Makefile.am:5: error: 'fuzz_PROGRAMS' is used but 'fuzzdir' is undefined
fuzz/Makefile.am:6: warning: variable 'fuzz_test_SOURCES' is defined but no program or
fuzz/Makefile.am:6: library has 'fuzz_test' as canonical name (possible typo)
fuzz/Makefile.am:8: warning: variable 'fuzz_test_LDADD' is defined but no program or
fuzz/Makefile.am:8: library has 'fuzz_test' as canonical name (possible typo)
configure.ac:150: error: required file 'lib/idn2.h.in' not found
autoreconf-2.72: error: automake failed with exit status: 1

c:/libidn2 하위폴더안에 Makefile.am을 모두 만든다
c:/libidn2/Maekfile.am 수정
c:/libidn2/configure.ac 수정
에러)
Makefile.am:1: warning: AM_GNU_GETTEXT used but 'po' not in SUBDIRS
Makefile.am:4: error: 'pkgconfig_DATA' is used but 'pkgconfigdir' is undefined
수정)
# Root 디렉토리의 Makefile.am
# 이 파일은 프로젝트의 최상위 디렉토리에서 Makefile을 설정합니다.

# Include subdirectories Makefile.am
SUBDIRS = gl gnulib lib m4 po src tests tmpwrk2270 unistring build-aux contrib doc examples fuzz gettext-0.19.8 gettext-0.19.8/os2

# Specify the directory for pkg-config files
pkgconfigdir = $(libdir)/pkgconfig
pkgconfig_DATA = libidn2.pc

# Define ACLOCAL_AMFLAGS for additional macros
ACLOCAL_AMFLAGS = -I m4

# Automake options
AM_GNU_GETTEXT([external])
에러)
fuzz/Makefile.am:5: error: 'fuzz_PROGRAMS' is used but 'fuzzdir' is undefined
fuzz/Makefile.am:6: warning: variable 'fuzz_test_SOURCES' is defined but no program or
fuzz/Makefile.am:6: library has 'fuzz_test' as canonical name (possible typo)
fuzz/Makefile.am:8: warning: variable 'fuzz_test_LDADD' is defined but no program or
fuzz/Makefile.am:8: library has 'fuzz_test' as canonical name (possible typo)
수정)
# fuzz 디렉토리의 Makefile.am
# 이 디렉토리에서 fuzz 테스트를 수행할 수 있습니다.

# Define the fuzz test programs
noinst_PROGRAMS = libidn2_to_ascii_8z_fuzzer libidn2_to_unicode_8z8z_fuzzer

# Source files for the fuzz test programs
libidn2_to_ascii_8z_fuzzer_SOURCES = libidn2_to_ascii_8z_fuzzer.c
libidn2_to_unicode_8z8z_fuzzer_SOURCES = libidn2_to_unicode_8z8z_fuzzer.c

# Linker flags for the fuzz test programs
libidn2_to_ascii_8z_fuzzer_LDADD = ../lib/libidn2.la
libidn2_to_unicode_8z8z_fuzzer_LDADD = ../lib/libidn2.la

# Additional files needed for fuzzing
EXTRA_DIST = libidn2_to_ascii_8z_fuzzer.dict libidn2_to_unicode_8z8z_fuzzer.dict README.md run-afl.sh run-clang.sh suppressions.valgrind libidn2_register_fuzzer.in libidn2_to_ascii_8z_fuzzer.in libidn2_to_ascii_8z_fuzzer.repro libidn2_to_unicode_8z8z_fuzzer.in fuzzer.h get_all_corpora get_ossfuzz_corpora libidn2_register_fuzzer.c
에러)
configure.ac:150: error: required file 'lib/idn2.h.in' not found
수정)
'lib/idn2.h.in' 파일을만든다.
에러)
autoreconf-2.72: error: automake failed with exit status: 1

nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autoreconf-2.72: running: aclocal -I m4
autoreconf-2.72: configure.ac: tracing
autoreconf-2.72: running: libtoolize --copy
autoreconf-2.72: configure.ac: not using Intltool
autoreconf-2.72: configure.ac: not using Gtkdoc
autoreconf-2.72: running: aclocal -I m4
autoreconf-2.72: running: /usr/bin/autoconf-2.72
autoreconf-2.72: running: /usr/bin/autoheader-2.72
autoreconf-2.72: running: automake --add-missing --copy --no-force
autoreconf-2.72: Leaving directory '.'

nayou@kimnayooung MINGW64 /c/libidn2
# automake --version
autoconf --version
automake (GNU automake) 1.17
Features: subsecond-mtime

Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later
  <https://gnu.org/licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Tom Tromey <tromey@redhat.com>
       and Alexandre Duret-Lutz <adl@gnu.org>.
autoconf (GNU Autoconf) 2.72
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+/Autoconf: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>, <https://gnu.org/licenses/exceptions.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille.

configure 스크립트를 실행하여 빌드 시스템을 구성
./configure
(에러)
nayou@kimnayooung MINGW64 /c/libidn2
# ./configure
configure: loading site script /etc/config.site
configure: Libidn2 2.3.7.2-64ab-dirty libidn2 2.3.7 0x02030007 4:0:4 0
checking for a BSD-compatible install... /usr/bin/install -c
checking whether sleep supports fractional seconds... yes
checking filesystem timestamp resolution... 0.01
checking whether build environment is sane... yes
checking for a race-free mkdir -p... /usr/bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking whether make supports nested variables... yes
checking xargs -n works... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.exe
checking for suffix of executables... .exe
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether the compiler supports GNU C... yes
checking whether gcc accepts -g... yes
checking for gcc option to enable C11 features... none needed
checking whether gcc understands -c and -o together... yes
checking whether make supports the include directive... yes (GNU style)
checking dependency style of gcc... gcc3
checking for stdio.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for strings.h... yes
checking for sys/stat.h... yes
checking for sys/types.h... yes
checking for unistd.h... yes
checking for wchar.h... yes
checking for minix/config.h... no
checking whether it is safe to define __EXTENSIONS__... yes
checking whether _XOPEN_SOURCE should be defined... no
./configure: line 4950: gl_EARLY: command not found
./configure: line 4951: unistring_EARLY: command not found
checking build system type... x86_64-w64-mingw32
checking host system type... x86_64-w64-mingw32
checking how to print strings... printf
checking for a sed that does not truncate output... /usr/bin/sed
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for fgrep... /usr/bin/grep -F
checking for ld used by gcc... C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe
checking if the linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /mingw64/bin/nm -B
checking the name lister (/mingw64/bin/nm -B) interface... BSD nm
checking whether ln -s works... no, using cp -pR
checking the maximum length of command line arguments... 8192
checking how to convert x86_64-w64-mingw32 file names to x86_64-w64-mingw32 format... func_convert_file_msys_to_w32
checking how to convert x86_64-w64-mingw32 file names to toolchain format... func_convert_file_msys_to_w32
checking for C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe option to reload object files... -r
checking for file... file
checking for objdump... objdump
checking how to recognize dependent libraries... file_magic ^x86 archive import|^x86 DLL
checking for dlltool... dlltool
checking how to associate runtime and link libraries... func_cygming_dll_for_implib
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /mingw64/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for a working dd... /usr/bin/dd
checking how to truncate binary pipes... /usr/bin/dd bs=4096 count=1
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... no
checking for as... as
checking for dlltool... (cached) dlltool
checking for objdump... (cached) objdump
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -DDLL_EXPORT -DPIC
checking if gcc PIC flag -DDLL_EXPORT -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) supports shared libraries... yes
checking whether -lc should be explicitly linked in... yes
checking dynamic linker characteristics... Win32 ld.exe
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
./configure: line 13550: gl_INIT: command not found
./configure: line 13551: unistring_INIT: command not found
checking whether NLS is requested... yes
checking for msgfmt... /usr/bin/msgfmt
checking for gmsgfmt... /usr/bin/msgfmt
checking for xgettext... /usr/bin/xgettext
checking for msgmerge... /usr/bin/msgmerge
checking for ld used by gcc... C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe
checking if the linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) is GNU ld... yes
checking for shared library run path origin... done
checking how to run the C preprocessor... gcc -E
checking for egrep -e... (cached) /usr/bin/grep -E
checking for CFPreferencesCopyAppValue... no
checking for CFLocaleCopyCurrent... no
checking for GNU gettext in libc... no
checking for iconv... yes
checking for working iconv... yes
checking how to link with libiconv... /mingw64/lib/libiconv.dll.a -L/mingw64/lib
checking for GNU gettext in libintl... yes
checking whether to use NLS... yes
checking where the gettext function comes from... external libintl
checking how to link with libintl... /mingw64/lib/libintl.dll.a -L/mingw64/lib
checking whether to build with code coverage support... no
./configure: line 16464: syntax error near unexpected token `-Werror,'
./configure: line 16464: `     gl_WARN_ADD(-Werror, WERROR_CFLAGS)'
(수정)
"C:\libidn2\configure.ac"
# Add warnings 추가
AM_CFLAGS = -Werror

"C:\libidn2\configure"
if test "$enable_gcc_warnings" = error; then
     gl_WARN_ADD(-Werror, WERROR_CFLAGS)
     gl_WARN_ADD(-Wno-error=analyzer-use-of-uninitialized-value, WERROR_CFLAGS)
     gl_WARN_ADD(-Wno-error=missing-field-initializers, WERROR_TESTS_CFLAGS)
     gl_WARN_ADD(-Wno-error=analyzer-double-free, WERROR_TESTS_CFLAGS)
   fi
여기서
gl_WARN_ADD(-Werror, WERROR_CFLAGS) 이부분이 에러
./configure: line 16464: syntax error near unexpected token -Werror,'
./configure: line 16464:      gl_WARN_ADD(-Werror, WERROR_CFLAGS)'
(수정)
if test "$enable_gcc_warnings" = error; then
     #gl_WARN_ADD(-Werror, WERROR_CFLAGS) 주석처리
     # Define gl_WARN_ADD if not defined 추가
     gl_WARN_ADD() {
         echo "Adding warning flags $1 to $2"
         CFLAGS="$CFLAGS $1"
     }
     gl_WARN_ADD(-Wno-error=analyzer-use-of-uninitialized-value, WERROR_CFLAGS)
     gl_WARN_ADD(-Wno-error=missing-field-initializers, WERROR_TESTS_CFLAGS)
     gl_WARN_ADD(-Wno-error=analyzer-double-free, WERROR_TESTS_CFLAGS)
   fi
"C:\libidn2\configure.ac"
# 주석처리
 #   if test "$enable_gcc_warnings" = error; then
 #    gl_WARN_ADD([-Werror], [WERROR_CFLAGS])
 #    gl_WARN_ADD([-Wno-error=analyzer-use-of-uninitialized-value], [WERROR_CFLAGS])
 #    gl_WARN_ADD([-Wno-error=missing-field-initializers], [WERROR_TESTS_CFLAGS])
 #    gl_WARN_ADD([-Wno-error=analyzer-double-free], [WERROR_TESTS_CFLAGS])
 #  fi

#gl_MANYWARN_ALL_GCC([possible_warning_options]) 주석처리

   # 추가
   # Define gl_MANYWARN_ALL_GCC if not defined 
   gl_MANYWARN_ALL_GCC() {
       echo "Adding warning options $1"
       CFLAGS="$CFLAGS $1"
   }

   # 추가
   if test "$enable_gcc_warnings" = error; then
       gl_MANYWARN_ALL_GCC "-Werror"
   fi

   # 추가
   AC_REQUIRE([gl_MANYWARN_ALL_GCC]) 
   AC_PROG_CC 
   AC_PROG_MAKE_SET 

자동화 도구 호출: 매크로 정의와 호출을 추가한 후, autoreconf를 사용하여 변경 사항을 적용
autoreconf -v -i
configure 파일은 configure.ac에서 자동으로 생성

"C:\libidn2\m4\custom-macros.m4" 생성
# custom-macros.m4

# Define gl_MANYWARN_ALL_GCC
gl_MANYWARN_ALL_GCC() {
    echo "Adding warning options $1"
    CFLAGS="$CFLAGS $1"
}

# Define gl_MANYWARN_COMPLEMENT
gl_MANYWARN_COMPLEMENT() {
    echo "Complementing warning options $1 with $2 and excluding $3"
    CFLAGS="$CFLAGS $1"
}

"C:\libidn2\configure.ac"
# 추가
AC_CONFIG_MACRO_DIR([m4])
m4_include([m4/custom-macros.m4])
자동화 도구 호출: 매크로 정의와 호출을 추가한 후, autoreconf를 사용하여 변경 사항을 적용
autoreconf -v -i
#빌드
./configure
nayou@kimnayooung MINGW64 /c/libidn2
# ./configure

checking whether to build with code coverage support... no
checking for CFPreferencesCopyAppValue... no
checking for CFLocaleCopyCurrent... no
checking for GNU gettext in libc... no
checking whether stripping libraries is possible... no
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... no
./configure: line 4950: gl_EARLY: command not found
./configure: line 4951: unistring_EARLY: command not found
./configure: line 13550: gl_INIT: command not found
./configure: line 13551: unistring_INIT: command not found
./configure: line 13554: AM_CFLAGS: command not found
./configure: line 16474: syntax error near unexpected token \"$desired_warning_options",`
./configure: line 16474: gl_MANYWARN_COMPLEMENT("$desired_warning_options", "$possible_warning_options")

m4/custom-macros.m4 수정
# Define gl_MANYWARN_ALL_GCC
gl_MANYWARN_ALL_GCC() {
    echo "Adding warning options $1"
    CFLAGS="$CFLAGS $1"
}

# Define gl_MANYWARN_COMPLEMENT
gl_MANYWARN_COMPLEMENT() {
    echo "Complementing warning options $1 with $2 and excluding $3"
    CFLAGS="$CFLAGS $1"
    CFLAGS="$CFLAGS $2"
    # Remove $3 from CFLAGS
    CFLAGS=$(echo "$CFLAGS" | sed "s/$3//g")
}

configuer.ac수정
# Define or use gl_MANYWARN_ALL_GCC
    gl_MANYWARN_ALL_GCC "$nw" 

    # Complement and modify warning options 주석처리
    #desired_warning_options="-Werror"
    #possible_warning_options="$nw"
    # Define warning options 추가
    nw="-Wall -Wextra"
    desired_warning_options="-Werror"
    possible_warning_options="$nw"
    remaining_undesired_warning_options="-Wno-unused-parameter"
    # Use gl_MANYWARN_ALL_GCC to add warning options
    gl_MANYWARN_ALL_GCC([$nw])
    # Use gl_MANYWARN_COMPLEMENT to adjust warning options
    gl_MANYWARN_COMPLEMENT([$desired_warning_options], [$possible_warning_options], [$remaining_undesired_warning_options])

    #주석처리
    #gl_MANYWARN_COMPLEMENT("$desired_warning_options", "$possible_warning_options")
    #gl_MANYWARN_COMPLEMENT("$remaining_undesired_warning_options", "$nw")

자동화 도구 호출: 매크로 정의와 호출을 추가한 후, autoreconf를 사용하여 변경 사항을 적용
autoreconf -v -i

m4/custom-macros.m4 수정
# custom-macros.m4

# Define gl_MANYWARN_ALL_GCC
gl_MANYWARN_ALL_GCC() {
    echo "Adding warning options $1"
    CFLAGS="$CFLAGS $1"
}

# Define gl_MANYWARN_COMPLEMENT
gl_MANYWARN_COMPLEMENT() {
    echo "Complementing warning options $1 with $2 and excluding $3"
    CFLAGS="$CFLAGS $1"
}

# Define gl_WARN_ADD
gl_WARN_ADD() {
    echo "Adding warning option $1"
    CFLAGS="$CFLAGS $1"
}
configuer.ac수정
AC_CONFIG_MACRO_DIR([m4])
m4_include([m4/custom-macros.m4])
# Define or use gl_MANYWARN_ALL_GCC
    gl_MANYWARN_ALL_GCC $nw 

    # Complement and modify warning options 주석처리
    #desired_warning_options="-Werror"
    #possible_warning_options="$nw"
    # Define warning options 추가
    nw="-Wall -Wextra"
    desired_warning_options="-Werror"
    possible_warning_options="$nw"
    
    # Define or use gl_MANYWARN_COMPLEMENT
    gl_MANYWARN_COMPLEMENT "$desired_warning_options" "$possible_warning_options"
    gl_MANYWARN_COMPLEMENT "$remaining_undesired_warning_options" "$nw"
 

    #주석처리
    #gl_MANYWARN_COMPLEMENT("$desired_warning_options", "$possible_warning_options")
    #gl_MANYWARN_COMPLEMENT("$remaining_undesired_warning_options", "$nw")


autoconf 및 automake 재생성
autoreconf -v -i
nayou@kimnayooung MINGW64 /c/libidn2
# ./configure
configure: loading site script /etc/config.site
configure: Libidn2 2.3.7.2-64ab-dirty libidn2 2.3.7 0x02030007 4:0:4 0
checking for a BSD-compatible install... /usr/bin/install -c
checking whether sleep supports fractional seconds... yes
checking filesystem timestamp resolution... 0.01
checking whether build environment is sane... yes
checking for a race-free mkdir -p... /usr/bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking whether make supports nested variables... yes
checking xargs -n works... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.exe
checking for suffix of executables... .exe
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether the compiler supports GNU C... yes
checking whether gcc accepts -g... yes
checking for gcc option to enable C11 features... none needed
checking whether gcc understands -c and -o together... yes
checking whether make supports the include directive... yes (GNU style)
checking dependency style of gcc... gcc3
checking for stdio.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for strings.h... yes
checking for sys/stat.h... yes
checking for sys/types.h... yes
checking for unistd.h... yes
checking for wchar.h... yes
checking for minix/config.h... no
checking whether it is safe to define __EXTENSIONS__... yes
checking whether _XOPEN_SOURCE should be defined... no
./configure: line 4970: gl_EARLY: command not found
./configure: line 4971: unistring_EARLY: command not found
checking build system type... x86_64-w64-mingw32
checking host system type... x86_64-w64-mingw32
checking how to print strings... printf
checking for a sed that does not truncate output... /usr/bin/sed
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for fgrep... /usr/bin/grep -F
checking for ld used by gcc... C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe
checking if the linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /mingw64/bin/nm -B
checking the name lister (/mingw64/bin/nm -B) interface... BSD nm
checking whether ln -s works... no, using cp -pR
checking the maximum length of command line arguments... 8192
checking how to convert x86_64-w64-mingw32 file names to x86_64-w64-mingw32 format... func_convert_file_msys_to_w32
checking how to convert x86_64-w64-mingw32 file names to toolchain format... func_convert_file_msys_to_w32
checking for C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe option to reload object files... -r
checking for file... file
checking for objdump... objdump
checking how to recognize dependent libraries... file_magic ^x86 archive import|^x86 DLL
checking for dlltool... dlltool
checking how to associate runtime and link libraries... func_cygming_dll_for_implib
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /mingw64/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for a working dd... /usr/bin/dd
checking how to truncate binary pipes... /usr/bin/dd bs=4096 count=1
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... no
checking for as... as
checking for dlltool... (cached) dlltool
checking for objdump... (cached) objdump
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -DDLL_EXPORT -DPIC
checking if gcc PIC flag -DDLL_EXPORT -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) supports shared libraries... yes
checking whether -lc should be explicitly linked in... yes
checking dynamic linker characteristics... Win32 ld.exe
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
./configure: line 13570: gl_INIT: command not found
./configure: line 13571: unistring_INIT: command not found
./configure: line 13574: AM_CFLAGS: command not found
checking whether NLS is requested... yes
checking for msgfmt... /usr/bin/msgfmt
checking for gmsgfmt... /usr/bin/msgfmt
checking for xgettext... /usr/bin/xgettext
checking for msgmerge... /usr/bin/msgmerge
checking for ld used by gcc... C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe
checking if the linker (C:/msys64/mingw64/x86_64-w64-mingw32/bin/ld.exe) is GNU ld... yes
checking for shared library run path origin... done
checking how to run the C preprocessor... gcc -E
checking for egrep -e... (cached) /usr/bin/grep -E
checking for CFPreferencesCopyAppValue... no
checking for CFLocaleCopyCurrent... no
checking for GNU gettext in libc... no
checking for iconv... yes
checking for working iconv... yes
checking how to link with libiconv... /mingw64/lib/libiconv.dll.a -L/mingw64/lib
checking for GNU gettext in libintl... yes
checking whether to use NLS... yes
checking where the gettext function comes from... external libintl
checking how to link with libintl... /mingw64/lib/libintl.dll.a -L/mingw64/lib
checking whether to build with code coverage support... no
Adding warning options -Wbad-function-cast
Complementing warning options -Werror with -Wall -Wextra and excluding
Complementing warning options  with -Wall -Wextra and excluding
Adding warning option -Werror
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating Makefile
config.status: creating gl/Makefile
config.status: creating doc/Makefile
config.status: creating lib/Makefile
config.status: creating gnulib/lib/unictype/Makefile
config.status: creating gnulib/Makefile
config.status: creating src/Makefile
config.status: creating tests/Makefile
config.status: creating doc/reference/Makefile
config.status: creating examples/Makefile
config.status: creating fuzz/Makefile
config.status: creating gettext-0.19.8/os2/Makefile
config.status: creating po/Makefile
config.status: creating libidn2.pc
config.status: creating po/Makefile.in
config.status: creating lib/idn2.h
config.status: creating config.h
config.status: executing depfiles commands
config.status: executing libtool commands
config.status: executing po-directories commands
config.status: creating po/POTFILES
config.status: creating po/Makefile
config.status: executing post-configure commands
chmod: cannot access 'misc/gettextize': No such file or directory
chmod: cannot access 'misc/autopoint': No such file or directory
chmod: cannot access 'misc/convert-archive': No such file or directory
./config.status: line 2199: FIX_MAKEFILE_DISTRIB: command not found
configure: summary of main build options:

  Version:            2.3.7.2-64ab-dirty
  Libtool version     4:0:4
  DLL version:        0
  Header version:     major 2 minor 3 patch 7 number 0x02030007
  Build system:       x86_64-w64-mingw32
  Host/Target system: x86_64-w64-mingw32
  Install prefix:     /mingw64
  Compiler:           gcc
  CFLAGS:             -g -O2 -Wbad-function-cast -Werror  -Werror
  CPPFLAGS:           -I/mingw64/include
  LDFLAGS:
  Library types:      Shared=yes, Static=yes

  Warning flags:
      WERROR_CFLAGS:
WERROR_TESTS_CFLAGS:
        WARN_CFLAGS:

  Documentation:      yes

  nl_langinfo:
  Libiconv:
         LTLIBICONV:  -L/mingw64/lib -liconv -R/mingw64/lib
  Libunistring:
            VERSION:
     LTLIBUNISTRING:

  Version script:

  Valgrind:
경고와 오류 메시지가 있지만, configure 과정 자체는 성공적으로 완료
나머지오류만해결하면됨(no로 끝나는 항목은 비활성화상태를 나타냄)
./configure: line 4970: gl_EARLY: command not found
./configure: line 4971: unistring_EARLY: command not found
./configure: line 13570: gl_INIT: command not found
./configure: line 13571: unistring_INIT: command not found
./configure: line 13574: AM_CFLAGS: command not found
./configure: line 16474: syntax error near unexpected token "$desired_warning_options",'
./configure: line 16474: gl_MANYWARN_COMPLEMENT("$desired_warning_options", "$possible_warning_options")
./configure: line 16502: syntax error near unexpected token $w'
./configure: line 16502: gl_WARN_ADD($w)
checking whether to build with code coverage support... no
checking for CFPreferencesCopyAppValue... no
checking for CFLocaleCopyCurrent... no
checking for GNU gettext in libc... no
checking whether stripping libraries is possible... no
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... no

configure.ac
주로 autoconf 매크로들을 사용하는 곳
# Add warnings 추가 Makefile.am파일에서 설정하는게 일반적
#AM_CFLAGS = -Werror #제거
Makefile.am
# Add warnings 추가 Makefile.am파일에서 설정하는게 일반적
#AM_CFLAGS = -Werror #추가
configure.ac
AC_PROG_LIBTOOL-> LT_INIT
autoreconf-2.72: ... not using Intltool
autoreconf-2.72: ... not using Gtkdoc
# 추가
IT_PROG_INTLTOOL([0.40.0]) # 다국어 지원을 위한 도구
GTK_DOC_CHECK([1.0]) # API 문서를 생성하는 도구
#추가
CFLAGS="$CFLAGS -Werror"
#추가
AC_SUBST(CFLAGS)
(에러)
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autoreconf-2.72: running: aclocal -I m4
m4/custom-macros.m4:44: warning: macro 'AM_CFLAGS' not found in library
autoreconf-2.72: configure.ac: tracing
autoreconf-2.72: running: libtoolize --copy
autoreconf-2.72: configure.ac: not using Intltool
autoreconf-2.72: configure.ac: not using Gtkdoc
autoreconf-2.72: running: aclocal -I m4
m4/custom-macros.m4:44: warning: macro 'AM_CFLAGS' not found in library
autoreconf-2.72: running: /usr/bin/autoconf-2.72
configure.ac:216: error: possibly undefined macro: AC_PROG_GETTEXT
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
autoreconf-2.72: error: /usr/bin/autoconf-2.72 failed with exit status: 1

gettext 설치 확인
pacman -S mingw-w64-x86_64-gettext
AC_PROG_GETTEXT 설정
configure.ac에 추가
AM_GNU_GETTEXT([external])
AM_GNU_GETTEXT_VERSION([0.19.8])
autopoint 확인
autopoint는 gettext 패키지의 일부로, 자동으로 프로젝트에 필요한 국제화 파일을 설정
 ACLOCAL_PATH 설정
export ACLOCAL_PATH="/usr/share/aclocal:$ACLOCAL_PATH"
Makefile.am 추
ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I m4
# Add warnings 추가 Makefile.am파일에서 설정하는게 일반적
#AM_CFLAGS = -Werror #m4/custom-macros.m4:44: warning: macro 'AM_CFLAGS' not found in library

autoreconf-2.72: configure.ac: not using Intltool
autoreconf-2.72: configure.ac: not using Gtkdoc
Intltool 사용하기
pacman -S intltool
configure.ac 파일 수정
IT_PROG_INTLTOOL([0.40.0]) #추가
Gtkdoc 사용하기(https://gitlab.gnome.org/GNOME/gtk-doc)
nayou@kimnayooung MINGW64 /c/libidn2
# git clone https://gitlab.gnome.org/GNOME/gtk-doc.git
cp /c/libidn2/gtk-doc/buildsystems/autotools/gtk-doc.m4 /c/libidn2/m4

# Root 디렉토리의 Makefile.am
# 이 파일은 프로젝트의 최상위 디렉토리에서 Makefile을 설정합니다.

# Include subdirectories Makefile.am
SUBDIRS = gl gnulib lib m4 po src tests tmpwrk2270 unistring build-aux contrib doc examples fuzz gettext-0.19.8 gettext-0.19.8/os2

# Specify the directory for pkg-config files
pkgconfigdir = $(libdir)/pkgconfig
pkgconfig_DATA = libidn2.pc

ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I /c/libidn2/m4 #export ACLOCAL_PATH="/c/libidn2/m4:$ACLOCAL_PATH"

# Automake options
AM_GNU_GETTEXT([external])

# Add warnings 추가 Makefile.am파일에서 설정하는게 일반적
#AM_CFLAGS = -Werror #m4/custom-macros.m4:44: warning: macro 'AM_CFLAGS' not found in library

# 추가
gtkdocdir = $(datadir)/gtk-doc/html #/c/libidn2/gtk-doc/html
gtkdoc_DATA = $(DOCS)
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
Makefile.am
ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I m4
configure.ac
AC_CONFIG_MACRO_DIRS([/usr/share/aclocal])

intltoolize: 'po/Makefile.in.in' exists: use '--force' to overwrite
intltoolize: 'po/Makefile.in.in' is out of date: use '--force' to overwrite
po/Makefile.in.in 파일이 존재하거나 구버전이라는 것을 알림
intltoolize는 이 파일이 이미 존재하거나 오래되었기 때문에 덮어쓰기를 제안
덮어쓰기를 하려면 --force 옵션을 사용하라는 메시지
nayou@kimnayooung MINGW64 /c/libidn2
# intltoolize --force
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint
autopoint: File po/Makefile.in.in has been locally modified.
autopoint: *** Some files have been locally modified. Not overwriting them because --force has not been specified. For your convenience, you find the local modifications in the file '/tmp/ar8PLRf3/gtJ1QdHy/autopoint.diff'.
autopoint: *** Stop.
autoreconf-2.72: error: autopoint failed with exit status: 1
/tmp/ar8PLRf3/gtJ1QdHy/autopoint.diff 파일을 열어 로컬 수정 내용을 확인
nayou@kimnayooung MINGW64 /c/libidn2
# autopoint --force
Copying file po/Makefile.in.in
파일을 삭제한 후, autopoint를 다시 실행
rm po/Makefile.in.in
autopoint
nayou@kimnayooung MINGW64 /c/libidn2
# autopoint
Copying file po/Makefile.in.in
autopoint와 autoreconf를 포함하여 전체 빌드 시스템을 재구성
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -v -i
intltoolize: 'po/Makefile.in.in' exists: use '--force' to overwrite
intltoolize: 'po/Makefile.in.in' is out of date: use '--force' to overwrite
autoreconf-2.72: error: intltoolize failed with exit status: 1
최신상태로 업데이트
intltoolize --force
수동삭
nayou@kimnayooung MINGW64 /c/libidn2
# rm po/Makefile.in.in
intltoolize
pacman -Syu gettext intltool
intltoolize: 'po/Makefile.in.in' exists: use '--force' to overwrite
intltoolize: 'po/Makefile.in.in' is out of date: use '--force' to overwrite

[google keyword autopoint: File po/Makefile.in.in has been locally modified.]
https://www.linuxquestions.org/questions/linux-software-2/building-cinelerra-cv-from-git-repository-syntax-error-820826-print/
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -if

Copying file po/Makefile.in.in
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1

libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
nayou@kimnayooung MINGW64 /c/libidn2
# pacman -S libtool automake
intltoolize: 'po/Makefile.in.in' exists: use '--force' to overwrite
intltoolize: 'po/Makefile.in.in' is out of date: use '--force' to overwrite
intltoolize 명령어를 실행할 때, po/Makefile.in.in 파일이 이미 존재하고 있지만, 
해당 파일이 현재 사용 중인 버전과 일치하지 않아서 업데이트가 필요
intltoolize는 이미 존재하는 파일을 덮어쓰지 않도록 설계되어 있다.
--force 옵션을 사용하여 강제로 덮어쓸 수 있다.
nayou@kimnayooung MINGW64 /c/libidn2
# intltoolize --force
autopoint: File po/Makefile.in.in has been locally modified.
autopoint: *** Some files have been locally modified. Not overwriting them because --force has not been specified. For your convenience, you find the local modifications in the file '/tmp/arjezVBk/gtWcVd0M/autopoint.diff'.
autopoint: *** Stop.
autopoint 도구가 po/Makefile.in.in 파일이 로컬에서 수정되었음을 감지하고, 
이를 덮어쓰지 않기 위해 작업을 중단한 것임
파일 덮어쓰기를 위해서는 추가적으로 --force 옵션이 필요하다고 경고
만약 백업할경우 cp po/Makefile.in.in po/Makefile.in.in.bak
nayou@kimnayooung MINGW64 /c/libidn2
# autopoint --force
Copying file po/Makefile.in.in

nayou@kimnayooung MINGW64 /c/libidn2
# intltoolize --force

https://www.linuxquestions.org/questions/linux-software-2/building-cinelerra-cv-from-git-repository-syntax-error-820826-print/
nayou@kimnayooung MINGW64 /c/libidn2
Autotools 기반의 프로젝트에서 일반적으로 사용되는 명령어로, 
configure 스크립트를 자동으로 생성하고 갱신하는 데 사용
-i 또는 --install: 필요한 경우, 프로젝트 디렉토리에 누락된 파일을 추가합니다. 예를 들어, config.guess, config.sub, install-sh 등의 파일을 추가합니다.
-f 또는 --force: 기존 파일을 강제로 덮어씁니다.
# autoreconf -if
aclocal, autoconf, autoheader, automake, libtoolize 등의 도구를 실행하여 configure 스크립트와 관련 파일들을 생성하고 갱신
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -if
Copying file po/Makefile.in.in
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1
/usr/share/aclocal/libtool.m4 파일을 찾지 못함
pacman -S libtool
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -if
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1
pacman -Syu           # 시스템 및 패키지 업데이트
pacman -S libtool     # libtool 설치
pacman -S autoconf automake  # autoconf 및 automake도 설치
nayou@kimnayooung MINGW64 /c/libidn2
# find /usr/share -name "libtool.m4"
/usr/share/aclocal/libtool.m4
export ACLOCAL_PATH="/usr/share/aclocal"
autoreconf -if
libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
libtoolize --copy --install --automake
환경변수설정할때
Makefile.am (현재 세션만 적용)
#m4 디렉토리는 AC_CONFIG_MACRO_DIRS에서 이미 포함되므로, 중복된 경로를 제거
#ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I /c/libidn2/m4 
#export ACLOCAL_PATH="export ACLOCAL_PATH="/usr/share/aclocal:/c/libidn2/m4":$ACLOCAL_PATH"
ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I m4
# -I m4를 제거 configure.ac파일의  AC_CONFIG_MACRO_DIRS([m4]) #여기에서 찾음
.bashrc 또는 .bash_profile 추가(지속적설정)
echo 'export ACLOCAL_PATH="/usr/share/aclocal"' >> ~/.bashrc
source ~/.bashrc
nayou@kimnayooung MINGW64 /usr/share/aclocal
# find / -name "libtool.m4" 2>/dev/null
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/third_party/googletest/googletest/m4/libtool.m4
/mingw64/share/aclocal/libtool.m4
nayou@kimnayooung MINGW64 /usr/share/aclocal
# echo 'export ACLOCAL_PATH="/mingw64/share/aclocal:/usr/share/aclocal"' >> ~/.bashrc

nayou@kimnayooung MINGW64 /usr/share/aclocal
# source ~/.bashrc

AC_CONFIG_MACRO_DIRS([/usr/share/aclocal]) 
AC_CONFIG_MACRO_DIRS([/usr/share/aclocal, /mingw64/share/aclocal]) 
ACLOCAL_AMFLAGS = -I /usr/share/aclocal -I /mingw64/share/aclocal -I m4
echo 'export ACLOCAL_PATH="/mingw64/share/aclocal:/usr/share/aclocal"' >> ~/.bashrc
source ~/.bashrc
export ACLOCAL_PATH="/mingw64/share/aclocal:/usr/share/aclocal"
=> libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.

nayou@kimnayooung MINGW64 /c/libidn2
/dev/null로 오류 메시지를 버려서 결과를 깨끗하게 확인하는 것
파일 디스크립터 표준 입력 (stdin) 0, 표준 출력 (stdout) 1, 표준 오류 (stderr) 2
# find / -name "libtool.m4" 2>/dev/null
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/third_party/googletest/googletest/m4/libtool.m4
/mingw64/share/aclocal/libtool.m4
nayou@kimnayooung MINGW64 /c/libidn2
# echo $ACLOCAL_PATH
/mingw64/share/aclocal:/usr/share/aclocal
삭제하고 다시설치
pacman -R libtool
pacman -S libtool
libtoolize --verbose
pacman -R autoconf automake
pacman -S autoconf automake
libtoolize:   error: '/usr/share/aclocal/libtool.m4' does not exist.
Makefile.am
AC_CONFIG_MACRO_DIRS([/mingw64/share/aclocal, /usr/share/aclocal, m4])
configure.ac
ACLOCAL_AMFLAGS = -I /mingw64/share/aclocal -I /usr/share/aclocal -I m4
nayou@kimnayooung MINGW64 /c/libidn2
# chmod 644 /mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2
# ls -l /mingw64/share/aclocal/libtool.m4
-rw-r--r-- 1 nayou nayou 307384  8월 14  2023 /mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /mingw64/share/aclocal
# find / -name "libtool.m4" 2>/dev/null
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/third_party/googletest/googletest/m4/libtool.m4

cp /home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4 /mingw64/share/aclocal/

nayou@kimnayooung MINGW64 /mingw64/share/aclocal
# find / -name "libtool.m4" 2>/dev/null                                        /home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/third_party/googletest/googletest/m4/libtool.m4
/mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2
# libtoolize --version
libtoolize (GNU libtool) 2.4.7
Written by Gary V. Vaughan <gary@gnu.org>, 2003

Copyright (C) 2022 Free Software Foundation, Inc.

Can't exec "gtkdocize": No such file or directory at /usr/share/autoconf-2.72/Autom4te/FileUtils.pm line 318.
nayou@kimnayooung MINGW64 /c/libidn2
# pacman -S gtk-doc
의존성 해결 중...
꾸러미 충돌을 찾는 중...

꾸러미 (16) docbook-xml-4.5-4  docbook-xsl-1.79.2-3  glib2-2.80.4-1
            itstool-2.0.7-1  libxml2-2.13.3-1  libxml2-python-2.13.3-1
            libxslt-1.1.42-1  mpdecimal-4.0.0-1  python-3.12.5-1
            python-lxml-5.2.2-4  python-mallard-ducktype-1.0.2-6
            python-pygments-2.18.0-2  vim-9.1.0648-1  yelp-tools-42.1-1
            yelp-xsl-42.1-1  gtk-doc-1.34.0-1

총 다운로드 크기:   39.19 MiB
총 설치 크기:      292.29 MiB

:: 설치를 진행하시겠습니까? [Y/n] y
:: 꾸러미 가져오는 중...
 vim-9.1.0648-1-x...     9.0 MiB  3.02 MiB/s 00:03 [####################] 100%
 python-pygments-...  1895.1 KiB   622 KiB/s 00:03 [####################] 100%
 docbook-xsl-1.79...   677.8 KiB  1281 KiB/s 00:01 [####################] 100%
 python-lxml-5.2....  1222.3 KiB   305 KiB/s 00:04 [####################] 100%
 glib2-2.80.4-1-x...     2.5 MiB   607 KiB/s 00:04 [####################] 100%
 gtk-doc-1.34.0-1...   304.3 KiB   664 KiB/s 00:00 [####################] 100%
 yelp-xsl-42.1-1-any   191.1 KiB   357 KiB/s 00:01 [####################] 100%
 libxslt-1.1.42-1...   138.0 KiB   271 KiB/s 00:01 [####################] 100%
 python-mallard-d...   100.1 KiB   211 KiB/s 00:00 [####################] 100%
 docbook-xml-4.5-...    85.0 KiB   152 KiB/s 00:01 [####################] 100%
 mpdecimal-4.0.0-...    73.7 KiB  88.8 KiB/s 00:01 [####################] 100%
 yelp-tools-42.1-...    32.9 KiB  47.9 KiB/s 00:01 [####################] 100%
 python-3.12.5-1-...    22.4 MiB  3.16 MiB/s 00:07 [####################] 100%
 itstool-2.0.7-1-...    19.7 KiB  33.0 KiB/s 00:01 [####################] 100%
 libxml2-2.13.3-1...   485.3 KiB   180 KiB/s 00:03 [####################] 100%
 libxml2-python-2...   260.0 KiB   401 KiB/s 00:01 [####################] 100%
 총합 (16/16)           39.2 MiB  2.06 MiB/s 00:19 [####################] 100%
오류: 파일 'libxml2-2.13.3-1-x86_64.pkg.tar.zst'를 mirror.msys2.org에서 가져오는 데 실패 : Operation too slow. Less than 1 bytes/sec transferred the last 10 seconds
오류: 파일 'libxml2-python-2.13.3-1-x86_64.pkg.tar.zst'를 mirror.msys2.org에서 가져오는 데 실패 : Operation too slow. Less than 1 bytes/sec transferred the last 10 seconds
(16/16) 키링의 키를 검사 중                        [####################] 100%
(16/16) 꾸러미 무결성 검사 중                      [####################] 100%
(16/16) 꾸러미 파일 불러오는 중                    [####################] 100%
(16/16) 파일 충돌 검사 중                          [####################] 100%
(16/16) 사용 가능한 디스크 공간 검사 중            [####################] 100%
:: 꾸러미 변경사항을 처리 중...
( 1/16) 설치 중 libxml2                            [####################] 100%
etc/xml/catalog:1: parser error : Document is empty

^
( 2/16) 설치 중 libxslt                            [####################] 100%
( 3/16) 설치 중 docbook-xml                        [####################] 100%
( 4/16) 설치 중 docbook-xsl                        [####################] 100%
( 5/16) 설치 중 glib2                              [####################] 100%
( 6/16) 설치 중 libxml2-python                     [####################] 100%
( 7/16) 설치 중 mpdecimal                          [####################] 100%
( 8/16) 설치 중 python                             [####################] 100%
( 9/16) 설치 중 python-pygments                    [####################] 100%
(10/16) 설치 중 vim                                [####################] 100%
(11/16) 설치 중 yelp-xsl                           [####################] 100%
(12/16) 설치 중 python-lxml                        [####################] 100%
(13/16) 설치 중 itstool                            [####################] 100%
(14/16) 설치 중 python-mallard-ducktype            [####################] 100%
(15/16) 설치 중 yelp-tools                         [####################] 100%
(16/16) 설치 중 gtk-doc                            [####################] 100%

# echo $PATH
/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl
export PATH="/mingw64/bin:$PATH"
# which gtkdocize
/usr/bin/gtkdocize
nayou@kimnayooung MINGW64 /c/libidn2
# pacman -Qi gtk-doc
이름               : gtk-doc
버전               : 1.34.0-1
설명               : Documentation tool for public library API
아키텍처           : x86_64
URL                : https://gitlab.gnome.org/GNOME/gtk-doc
라이선스           : GPL  FDL
모음들             : 없음
다음을 제공        : 없음
다음에 의존        : docbook-xsl  glib2  libxml2-python  python
                     python-pygments  vim  yelp-tools
선택 의존성        : 없음
다음이 요구        : 없음
다음의 선택 의존성 : 없음
다음과 충돌        : 없음
다음을 대체        : 없음
설치된 크기        : 2.63 MiB
꾸러미 만든이      : CI (msys2/msys2-autobuild/dad66715/8220363058)
빌드 날짜          : 2024년 03월 10일 일 오후 4:24:49
설치 날짜          : 2024년 08월 27일 화 오전 9:48:31
설치 이유          : 명시적으로 설치했습니다
설치 스크립트      : 아니요
유효검사자         : SHA-256 합  서명

# autoreconf -if
Copying file build-aux/config.rpath
Copying file po/Makefile.in.in
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.
cp /usr/share/aclocal/libtool.m4 /mingw64/share/aclocal/

# pacman -Ql libtool | grep libtool.m4
libtool /usr/share/aclocal/libtool.m4

autoreconf-2.72: running: intltoolize --copy --force
autoreconf-2.72: running: gtkdocize --copy
cp: cannot create regular file './/mingw64/share/aclocal/': No such file or directory
autoreconf-2.72: error: gtkdocize failed with exit status: 1
cd /c/libidn2
폴더를 생성
mkdir -p .//mingw64/share/aclocal/
ls -l .//mingw64/share/aclocal/
0개
autoreconf는 소프트웨어 프로젝트의 설정 및 빌드를 위한 자동화 도구인 
autoconf, automake, libtool 등을 업데이트하는 과정
프로젝트의 빌드 및 설정을 위해 필요한 파일을 준비하고 갱신
# autoreconf -if --verbose
# ls -l .//mingw64/share/aclocal/
합계 8
-rw-r--r-- 1 nayou nayou 4528  8월 27 13:19 gtk-doc.m4
gtkdocize가 잘못된 경로를 참조하는지 확인
gtkdocize --copy
성공!
(autoreconf)
configure.ac 또는 configure.in 파일과 같은 입력 파일을 기반으로 configure 스크립트를 생성하거나 갱신합니다.
configure 스크립트는 시스템 환경을 검사하여 적절한 Makefile과 기타 빌드 설정 파일을 생성
aclocal: aclocal.m4 파일을 생성하고, 필요한 m4 매크로 파일을 포함합니다.
autoconf: configure 스크립트를 생성합니다.
autoheader: config.h 헤더 파일을 생성합니다.
automake: Makefile.in 파일을 생성합니다.
libtoolize: libtool 관련 파일을 생성합니다.
-i 옵션은 autoreconf가 aclocal.m4와 같은 필수 파일을 설치하도록 지시

autoreconf가 생성하거나 갱신한 configure 스크립트를 실행하여 프로젝트의 빌드 환경을 설정
./configure
셸 스크립트를 run_configure.sh라는 파일생성
#!/bin/bash

# 로그 파일 설정
LOG_FILE="configure.log"

# ./configure 실행 및 로그 파일에 기록
./configure &> "$LOG_FILE"

# 로그 파일에서 ./configure 또는 : error로 시작하는 줄만 출력
grep -E '^./configure|^: error' "$LOG_FILE"
저장
chmod +x run_configure.sh
./run_configure.sh
(참고)
./configure &> configure.log
grep -E '^./configure|^: error' configure.log | sort | uniq
nayou@kimnayooung MINGW64 /c/libidn2
# ./run_configure.sh
./configure: line 13736: as_fn_executable_p: command not found
./configure: line 13837: as_fn_executable_p: command not found
./configure: line 13882: as_fn_executable_p: command not found
./configure: line 13930: as_fn_executable_p: command not found
./configure: line 13980: as_fn_executable_p: command not found
./configure: line 14303: as_fn_executable_p: command not found
./configure: line 1614: as_fn_set_status: command not found
./configure: line 17405: `        gl_WARN_ADD("-W$w")'
./configure: line 17405: syntax error near unexpected token `"-W$w"'
./configure: line 1800: as_fn_set_status: command not found
./configure: line 2856: as_fn_executable_p: command not found
./configure: line 2962: as_fn_executable_p: command not found
./configure: line 3076: as_fn_executable_p: command not found
./configure: line 3184: as_fn_executable_p: command not found
./configure: line 3912: as_fn_executable_p: command not found
./configure: line 411: as_fn_exit: command not found
./configure: line 4354: as_fn_executable_p: command not found
./configure: line 4405: as_fn_executable_p: command not found
./configure: line 5208: as_fn_executable_p: command not found
./configure: line 5292: as_fn_executable_p: command not found
./configure: line 5366: as_fn_executable_p: command not found
./configure: line 5443: as_fn_executable_p: command not found
./configure: line 6232: as_fn_executable_p: command not found
./configure: line 6342: as_fn_executable_p: command not found
./configure: line 6697: as_fn_executable_p: command not found
./configure: line 6855: as_fn_executable_p: command not found
./configure: line 7051: as_fn_executable_p: command not found
./configure: line 7162: as_fn_executable_p: command not found
./configure: line 7661: as_fn_executable_p: command not found
./configure: line 8061: as_fn_executable_p: command not found
./configure: line 8934: as_fn_executable_p: command not found
: error: C compiler cannot create executables
: error: C preprocessor "/lib/cpp" fails sanity check
: error: cannot compute suffix of executables: cannot compile and link
: error: cannot compute suffix of object files: cannot compile
: error: cannot run C compiled programs.
: error: in '/c/libidn2':
: error: no acceptable C compiler found in $PATH
: error: no acceptable egrep could be found in /usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/usr/xpg4/bin
: error: no acceptable fgrep could be found in /usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/usr/xpg4/bin
: error: no acceptable grep could be found in /usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/usr/xpg4/bin
: error: no acceptable sed could be found in $PATH
# gcc --version
g++ --version
make --version
gcc.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

g++.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

GNU Make 4.4.1
x86_64-pc-msys 빌드
Copyright (C) 1988-2023 Free Software Foundation, Inc.
라이선스 GPLv3+: GNU GPL 버전 3 또는 이후 <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
# grep --version
sed --version
grep (GNU grep) 3.0
Copyright (C) 2017 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Mike Haertel and others, see <http://git.sv.gnu.org/cgit/grep.git/tree/AUTHORS>.
sed (GNU sed) 4.9
Copyright (C) 2022 Free Software Foundation, Inc.
GPLv3+ 라이선스: GNU GPL 버전 3 이상 <https://gnu.org/licenses/gpl.html>.
이 프로그램은 자유 소프트웨어입니다: 자유롭게 바꾸고 재배포할 수 있습니다.
법률이 허용하는 모든 범위내의 보증은 없습니다.

Jay Fenlason와(과) Tom Lord, Ken Pizzini,
Paolo Bonzini, Jim Meyering, Assaf Gordon이(가) 작성함.

이 sed 프로그램은 SELinux 기능을 제외하고 빌드했습니다.

GNU sed 홈 페이지: <https://www.gnu.org/software/sed/>.
GNU 소프트웨어 활용 일반 도움말: <https://www.gnu.org/gethelp/>.
버그 보고 전자메일 주소: <bug-sed@gnu.org>.

# echo $PATH
/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl

autoconf, automake, libtool 재설치 및 업데이트
autoreconf 명령어를 사용하여 configure 스크립트를 다시 생성
autoreconf -fi
# autoreconf -fi
Copying file po/Makefile.in.in
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '/mingw64/share/aclocal'.
libtoolize: copying file '/mingw64/share/aclocal/libtool.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltoptions.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltsugar.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltversion.m4'
libtoolize: copying file '/mingw64/share/aclocal/lt~obsolete.m4'
configure.ac:65: installing 'build-aux/compile'
configure.ac:67: installing 'build-aux/missing'
examples/Makefile.am: installing 'build-aux/depcomp'

./configure &> configure.log

nayou@kimnayooung MINGW64 /c/libidn2
# export CC=/usr/bin/gcc
export CXX=/usr/bin/g++

nayou@kimnayooung MINGW64 /c/libidn2
# which egrep
which fgrep
/usr/bin/egrep
/usr/bin/fgrep

autoreconf -i
nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -i
autopoint: File po/Makefile.in.in has been locally modified.
autopoint: *** Some files have been locally modified. Not overwriting them because --force has not been specified. For your convenience, you find the local modifications in the file '/tmp/arMvdyxx/gtNCTlWp/autopoint.diff'.
autopoint: *** Stop.
autoreconf-2.72: error: autopoint failed with exit status: 1

configure 스크립트 다시생
grep -E '^./configure|^: error' configure.log | sort | uniq

nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -if
Copying file po/Makefile.in.in
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '/mingw64/share/aclocal'.
libtoolize: copying file '/mingw64/share/aclocal/libtool.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltoptions.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltsugar.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltversion.m4'
libtoolize: copying file '/mingw64/share/aclocal/lt~obsolete.m4'
configure.ac:65: installing 'build-aux/compile'
configure.ac:67: installing 'build-aux/missing'
examples/Makefile.am: installing 'build-aux/depcomp'
./configure &> configure.log
# which gcc
which g++
which make
which grep
which sed
/mingw64/bin/gcc
/mingw64/bin/g++
/usr/bin/make
/usr/bin/grep
/usr/bin/sed
notepad ~/.bashrc에 추가
export PATH=/mingw64/bin/gcc:/mingw64/bin/g++:/usr/bin/make:/usr/bin/grep:/usr/bin/sed:$PATH # 추가
적용
source ~/.bashrc
# echo $PATH
/mingw64/bin/gcc:/mingw64/bin/g++:/usr/bin/make:/usr/bin/grep:/usr/bin/sed:/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin/gcc:/mingw64/bin/g++:/usr/bin/make:/usr/bin/grep:/usr/bin/sed:/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/bin:/mingw64/bin:/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl
autoreconf를 사용하여 configure 스크립트 재생성

# autoconf --version
automake --version
libtool --version
autoconf (GNU Autoconf) 2.72
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+/Autoconf: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>, <https://gnu.org/licenses/exceptions.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille.
automake (GNU automake) 1.17
Features: subsecond-mtime

Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later
  <https://gnu.org/licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Tom Tromey <tromey@redhat.com>
       and Alexandre Duret-Lutz <adl@gnu.org>.
libtool (GNU libtool) 2.4.7
Written by Gordon Matzigkeit, 1996

Copyright (C) 2014 Free Software Foundation, Inc.

autoreconf 명령을 사용하여 configure 스크립트를 재생성 
-i 플래그는 필요한 파일을 설치하고, -f 플래그는 강제로 재생성을 수행
configure 스크립트와 관련된 모든 필요한 파일을 재생성하고 업데이트
autoreconf -i -f
configure 스크립트 실행
./configure

notepad ~./bashrc
~./bashrc 수정
# MinGW 64-bit 경로 추가
export PATH="/mingw64/bin:$PATH"

# 기본 유틸리티 경로 추가
export PATH="/usr/bin:$PATH"

# Java 설치 경로
export JAVA_HOME="/c/Program Files/Java/jdk-21"
export PATH="$JAVA_HOME/bin:$PATH"

# gRPC Java Plugin 경로
export GRPC_JAVA_PLUGIN="/c/grpc-java/build/gradle/wrapper/protoc-gen-grpc-java.exe"

# 기본 유틸리티 경로
export PATH="/usr/local/bin:/bin:$PATH"

# Windows 시스템 경로
export PATH="/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:$PATH"

# Perl 모듈 경로
export PATH="/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:$PATH"

# Python 경로
export PATH="/c/Users/nayou/AppData/Local/Programs/Python/Python312:$PATH"

/c/libidn2
autoreconf -if
run_configure.sh #./configure

환경설정 
export PATH="/c/Program Files/Java/jdk-21/bin:/c/bazel:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/mingw64/bin:/usr/local/bin:/usr/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl"
/c/libidn2
autoreconf -if
run_configure.sh #./configure
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.

notepad ~./bashrc
# aclocal 경로 추가
export PATH="/usr/share/aclocal:/mingw64/share/aclocal:$PATH"
source ~/.bashrc
autoreconf -if
# autoreconf -if
FIND: 매개 변수 형식이 틀립니다.
autopoint: *** infrastructure files for version 0.19.8 not found; this is autopoint from GNU gettext-tools 0.22.4
autopoint: *** Stop.
autoreconf-2.72: error: autopoint failed with exit status: 1
autopoint 도구가 필요한 파일들을 찾지 못해 발생하는 문제
autopoint는 gettext 패키지의 일부이며, 인프라 파일들 (예: config.guess, config.sub 등)이 
특정 버전과 일치하지 않거나 누락된 경우
# gettext --version
gettext (GNU gettext-runtime) 0.22.4
Copyright (C) 1995-2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Ulrich Drepper이(가) 만들었습니다.
# autopoint --version
/bin/autopoint (GNU gettext-tools) 0.22.4
This binary is configured to use a versions archive in dirxz format.

Copyright (C) 2002-2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Written by Bruno Haible

버전 아카이브를 재설치하거나 갱신
autopoint --force
# autopoint --force
FIND: 매개 변수 형식이 틀립니다.
autopoint: *** infrastructure files for version 0.19.8 not found; this is autopoint from GNU gettext-tools 0.22.4
autopoint: *** Stop.

# which find
/c/Windows/System32/find

~/.bashrc 수정
export PATH="/mingw64/bin:/usr/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312"
source ~/.bashrc
which find
/usr/bin/find (성공!)

프로젝트에 필요한 gettext 인프라 파일들을 가져오고 설정
autopoint --force

autotools를 사용하는 프로젝트에서 configure 스크립트와 
관련된 모든 파일들을 생성하거나 업데이트하는 데 사용
configure.ac 또는 configure.in 파일을 기반으로 
configure 스크립트와 기타 관련 파일을 자동으로 생성하거나 갱신하는 역할
autoreconf -if (install, force)
autoreconf -if는 더 포괄적인 작업을 수행

libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1

libtool 설치 확인
pacman -Q libtool
# pacman -Q libtool
libtool 2.4.7-4
libtoolize --force
/mingw64/share/aclocal/libtool.m4 파일이 여전히 없거나 문제가 계속된다면,
libtool의 설치 상태를 점검하고 필요한 파일이 포함된 패키지를 재설치하거나 업데이트한다.
# pacman -Fy
:: 꾸러미 데이터베이스 동기화 중...
 clangarm64              3.7 MiB   726 KiB/s 00:05 [#########################] 100%
 mingw32              1454.7 KiB   744 KiB/s 00:02 [#########################] 100%
 mingw64                 4.7 MiB   909 KiB/s 00:05 [#########################] 100%
 ucrt64                  5.0 MiB  1772 KiB/s 00:03 [#########################] 100%
 clang32              1281.8 KiB   294 KiB/s 00:04 [#########################] 100%
 clang64                 4.8 MiB  1063 KiB/s 00:05 [#########################] 100%
 msys                 1188.5 KiB  1776 KiB/s 00:01 [#########################] 100%

pacman -F libtool.m4
clangarm64/mingw-w64-clang-aarch64-libtool 2.4.7-2
    clangarm64/share/aclocal/libtool.m4
mingw32/mingw-w64-i686-libtool 2.4.7-2
    mingw32/share/aclocal/libtool.m4
mingw64/mingw-w64-x86_64-libtool 2.4.7-2 [설치함]
    mingw64/share/aclocal/libtool.m4
ucrt64/mingw-w64-ucrt-x86_64-libtool 2.4.7-2
    ucrt64/share/aclocal/libtool.m4
clang32/mingw-w64-clang-i686-libtool 2.4.7-2
    clang32/share/aclocal/libtool.m4
clang64/mingw-w64-clang-x86_64-libtool 2.4.7-2
    clang64/share/aclocal/libtool.m4
msys/libtool 2.4.7-4 [설치함]
    usr/share/aclocal/libtool.m4

pacman -S libtool

nayou@kimnayooung MINGW64 /c/libidn2
# ls -l /mingw64/share/aclocal/libtool.m4
-rw-r--r-- 1 nayou nayou 307384  8월 27 19:30 /mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2
# autoreconf -if
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1

nayou@kimnayooung MINGW64 /c/libidn2

nayou@kimnayooung MINGW64 /c/libidn2
# cp /usr/share/aclocal/libtool.m4 /mingw64/share/aclocal/

nayou@kimnayooung MINGW64 /c/libidn2
# ls -l /mingw64/share/aclocal/libtool.m4
-rw-r--r-- 1 nayou nayou 307384  8월 27 20:10 /mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2
# chmod 644 /mingw64/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2
# libtool --version
libtool (GNU libtool) 2.4.7
Written by Gordon Matzigkeit, 1996

Copyright (C) 2014 Free Software Foundation, Inc.


nayou@kimnayooung MINGW64 /c/libidn2
# pacman -R libtool
의존성 검사 중...

꾸러미 (1) libtool-2.4.7-4

총 제거 크기:  2.15 MiB

:: 이 꾸러미를 제거하시겠습니까? [Y/n] y
:: 전처리 훅들을 실행 중...
(1/1) Removing old entries from the info directory file...
:: 꾸러미 변경사항을 처리 중...
(1/1) 삭제 중 libtool                              [#] 100%

nayou@kimnayooung MINGW64 /c/libidn2
# pacman -S libtool
의존성 해결 중...
꾸러미 충돌을 찾는 중...

꾸러미 (1) libtool-2.4.7-4

총 설치 크기:  2.15 MiB

:: 설치를 진행하시겠습니까? [Y/n] y
(1/1) 키링의 키를 검사 중                          [#] 100%
(1/1) 꾸러미 무결성 검사 중                        [#] 100%
(1/1) 꾸러미 파일 불러오는 중                      [#] 100%
(1/1) 파일 충돌 검사 중                            [#] 100%
(1/1) 사용 가능한 디스크 공간 검사 중              [#] 100%
:: 꾸러미 변경사항을 처리 중...
(1/1) 설치 중 libtool                              [#] 100%
:: 후처리 훅들을 실행 중...
(1/1) Updating the info directory file...

nayou@kimnayooung MINGW64 /c/libidn2
# echo $ACLOCAL_PATH
/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/m4

nayou@kimnayooung MINGW64 /c/libidn2
# find . -name "config.cache" -delete
find . -name "config.log" -delete

libtoolize를 소스에서 직접 빌드
# wget https://ftp.gnu.org/gnu/libtool/libtool-2.4.6.tar.gz
# tar -xzvf libtool-2.4.6.tar.gz
# cd libtool-2.4.6
# ./configure
configure: creating ./config.status
config.status: creating Makefile
config.status: creating config.h
config.status: executing tests/atconfig commands
config.status: executing depfiles commands
config.status: executing libtool commands
# make
# make install

# which libtoolize
/mingw64/bin/libtoolize

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# notepad ~/.bashrc
PATH에 /c/libidn2/libtool-2.4.6 추가

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# source ~/.bashrc

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# which libtoolize
/c/libidn2/libtool-2.4.6/libtoolize

경로확인 
# ls /c/libidn2/libtool-2.4.6/libtoolize
/c/libidn2/libtool-2.4.6/libtoolize

# libtoolize --version
libtoolize (GNU libtool) 2.4.6
Written by Gary V. Vaughan <gary@gnu.org>, 2003

Copyright (C) 2015 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

# find / -name libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/m4/libtool.m4
/home/nayou/_bazel_nayou/4yp365mj/external/protobuf~/third_party/googletest/googletest/m4/libtool.m4
/mingw64/share/aclocal/libtool.m4 (있음)
/usr/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# ls -l /mingw64/share/aclocal/libtool.m4
ls -l /usr/share/aclocal/libtool.m4
-rw-r--r-- 1 nayou nayou 305723  8월 27 20:17 /mingw64/share/aclocal/libtool.m4
-rw-r--r-- 1 nayou nayou 307384  7월  5 17:31 /usr/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# chmod 644 /mingw64/share/aclocal/libtool.m4
chmod 644 /usr/share/aclocal/libtool.m4

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# chmod 755 /mingw64/share/aclocal
chmod 755 /usr/share/aclocal

libtool의 설정 파일들을 프로젝트 디렉토리에 복사하거나 업데이트하여, 
라이브러리 관리와 관련된 설정을 자동으로 처리할 수 있게 됨.
configure.ac나 Makefile.am 파일에 필요한 설정을 추가하는 데 도움이 됨.
# libtoolize --force --copy
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/compile'
libtoolize: copying file 'build-aux/config.guess'
libtoolize: copying file 'build-aux/config.sub'
libtoolize: copying file 'build-aux/depcomp'
libtoolize: copying file 'build-aux/install-sh'
libtoolize: copying file 'build-aux/missing'
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.
libtoolize: copying file 'm4/libtool.m4'
libtoolize: copying file 'm4/ltoptions.m4'
libtoolize: copying file 'm4/ltsugar.m4'
libtoolize: copying file 'm4/ltversion.m4'
libtoolize: copying file 'm4/lt~obsolete.m4'

autoreconf는 autoconf, automake, libtool, 등과 같은 Autotools 구성 도구들을 자동으로 업데이트하는 데 사용
프로젝트의 빌드 시스템을 최신 상태로 유지하는 데 도움
# autoreconf -if
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/compile'
libtoolize: copying file 'build-aux/config.guess'
libtoolize: copying file 'build-aux/config.sub'
libtoolize: copying file 'build-aux/depcomp'
libtoolize: copying file 'build-aux/install-sh'
libtoolize: copying file 'build-aux/missing'
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.
libtoolize: copying file 'm4/libtool.m4'
libtoolize: copying file 'm4/ltargz.m4'
libtoolize: You should add the contents of 'm4/ltargz.m4' to 'aclocal.m4'.
libtoolize: copying file 'm4/ltdl.m4'
libtoolize: You should add the contents of 'm4/ltdl.m4' to 'aclocal.m4'.
libtoolize: copying file 'm4/ltoptions.m4'
libtoolize: copying file 'm4/ltsugar.m4'
libtoolize: copying file 'm4/ltversion.m4'
libtoolize: copying file 'm4/lt~obsolete.m4'
libtoolize: putting libltdl files in LT_CONFIG_LTDL_DIR, 'libltdl'.
libtoolize: copying file 'libltdl/COPYING.LIB'
libtoolize: copying file 'libltdl/Makefile.am'
libtoolize: copying file 'libltdl/README'
libtoolize: copying file 'libltdl/configure.ac'
libtoolize: copying file 'libltdl/aclocal.m4'
libtoolize: copying file 'libltdl/Makefile.in'
libtoolize: copying file 'libltdl/config-h.in'
libtoolize: copying file 'libltdl/configure'
libtoolize: copying file 'libltdl/libltdl/lt__alloc.h'
libtoolize: copying file 'libltdl/libltdl/lt__argz_.h'
libtoolize: copying file 'libltdl/libltdl/lt__dirent.h'
libtoolize: copying file 'libltdl/libltdl/lt__glibc.h'
libtoolize: copying file 'libltdl/libltdl/lt__private.h'
libtoolize: copying file 'libltdl/libltdl/lt__strl.h'
libtoolize: copying file 'libltdl/libltdl/lt_dlloader.h'
libtoolize: copying file 'libltdl/libltdl/lt_error.h'
libtoolize: copying file 'libltdl/libltdl/lt_system.h'
libtoolize: copying file 'libltdl/libltdl/slist.h'
libtoolize: copying file 'libltdl/loaders/dld_link.c'
libtoolize: copying file 'libltdl/loaders/dlopen.c'
libtoolize: copying file 'libltdl/loaders/dyld.c'
libtoolize: copying file 'libltdl/loaders/load_add_on.c'
libtoolize: copying file 'libltdl/loaders/loadlibrary.c'
libtoolize: copying file 'libltdl/loaders/preopen.c'
libtoolize: copying file 'libltdl/loaders/shl_load.c'
libtoolize: copying file 'libltdl/lt__alloc.c'
libtoolize: copying file 'libltdl/lt__argz.c'
libtoolize: copying file 'libltdl/lt__dirent.c'
libtoolize: copying file 'libltdl/lt__strl.c'
libtoolize: copying file 'libltdl/lt_dlloader.c'
libtoolize: copying file 'libltdl/lt_error.c'
libtoolize: copying file 'libltdl/ltdl.c'
libtoolize: copying file 'libltdl/ltdl.h'
libtoolize: copying file 'libltdl/slist.c'
libtoolize: Remember to add 'LTDL_INIT' to configure.ac.
automake-1.15: error: cannot open < libltdl/ltdl.mk: No such file or directory
autoreconf-2.69: automake failed with exit status: 1

libltdl 디렉토리 확인
# ls -l /c/libidn2/libtool-2.4.6/libltdl
합계 909
-rw-r--r-- 1 nayou nayou  42362  8월 27 20:31 aclocal.m4
-rw-r--r-- 1 nayou nayou   4863  8월 27 20:31 config-h.in
-rwxr-xr-x 1 nayou nayou 461349  8월 27 20:31 configure
-rw-r--r-- 1 nayou nayou   2628  8월 27 20:31 configure.ac
-rw-r--r-- 1 nayou nayou  26530  8월 27 20:31 COPYING.LIB
drwxr-xr-x 1 nayou nayou      0  8월 27 20:31 libltdl
-rw-r--r-- 1 nayou nayou    941  8월 27 20:16 libltdl.la
-rw-r--r-- 1 nayou nayou    344  8월 27 20:16 libltdl_libltdl_la-lt__alloc.lo
-rw-r--r-- 1 nayou nayou   8636  8월 27 20:16 libltdl_libltdl_la-lt__alloc.o
-rw-r--r-- 1 nayou nayou    350  8월 27 20:16 libltdl_libltdl_la-lt_dlloader.lo
-rw-r--r-- 1 nayou nayou  12489  8월 27 20:16 libltdl_libltdl_la-lt_dlloader.o
-rw-r--r-- 1 nayou nayou    341  8월 27 20:16 libltdl_libltdl_la-lt_error.lo
-rw-r--r-- 1 nayou nayou   8080  8월 27 20:16 libltdl_libltdl_la-lt_error.o
-rw-r--r-- 1 nayou nayou    329  8월 27 20:16 libltdl_libltdl_la-ltdl.lo
-rw-r--r-- 1 nayou nayou 100456  8월 27 20:16 libltdl_libltdl_la-ltdl.o
-rw-r--r-- 1 nayou nayou    332  8월 27 20:16 libltdl_libltdl_la-slist.lo
-rw-r--r-- 1 nayou nayou  13258  8월 27 20:16 libltdl_libltdl_la-slist.o
drwxr-xr-x 1 nayou nayou      0  8월 27 20:31 loaders
-rw-r--r-- 1 nayou nayou    859  8월 27 20:16 loadlibrary.la
-rw-r--r-- 1 nayou nayou   2298  8월 27 20:31 lt__alloc.c
-rw-r--r-- 1 nayou nayou   5896  8월 27 20:31 lt__argz.c
-rw-r--r-- 1 nayou nayou    284  8월 27 20:16 lt__argz.lo
-rw-r--r-- 1 nayou nayou  11779  8월 27 20:16 lt__argz.o
-rw-r--r-- 1 nayou nayou   3014  8월 27 20:31 lt__dirent.c
-rw-r--r-- 1 nayou nayou   3610  8월 27 20:31 lt__strl.c
-rw-r--r-- 1 nayou nayou    284  8월 27 20:16 lt__strl.lo
-rw-r--r-- 1 nayou nayou   5959  8월 27 20:16 lt__strl.o
-rw-r--r-- 1 nayou nayou   6088  8월 27 20:31 lt_dlloader.c
-rw-r--r-- 1 nayou nayou   2967  8월 27 20:31 lt_error.c
-rw-r--r-- 1 nayou nayou  55324  8월 27 20:31 ltdl.c
-rw-r--r-- 1 nayou nayou   5709  8월 27 20:31 ltdl.h
-rw-r--r-- 1 nayou nayou   5146  8월 27 20:31 Makefile.am
-rw-r--r-- 1 nayou nayou  53358  8월 27 20:31 Makefile.in
-rw-r--r-- 1 nayou nayou    693  8월 27 20:31 README
-rw-r--r-- 1 nayou nayou   9830  8월 27 20:31 slist.c
-rw-r--r-- 1 nayou nayou      6  2월 16  2015 stamp-mk
=>libltdl/ltdl.mk 파일이 누락

libtool 소스에서 libltdl 디렉토리 설치
# make
make: *** 'm4/ltversion.m4'에서 필요한 'm4/ltversion.in' 타겟을 만들 규칙이 없습니다.  멈춤.

/c/libidn2
# wget https://ftp.gnu.org/gnu/libtool/libtool-2.4.6.tar.gz
tar -xzf libtool-2.4.6.tar.gz
cd libtool-2.4.6
--2024-08-27 20:45:41--  https://ftp.gnu.org/gnu/libtool/libtool-2.4.6.tar.gz
'/usr/ssl/certs/ca-bundle.crt' CA 인증서를 불러왔습니다
ftp.gnu.org (ftp.gnu.org) 해석 중... 209.51.188.20, 2001:470:142:3::b
다음으로 연결 중: ftp.gnu.org (ftp.gnu.org)|209.51.188.20|:443... 연결했습니다.
HTTP 요청을 보냈습니다. 응답 기다리는 중... 200 OK
길이: 1806697 (1.7M) [application/x-gzip]
저장 위치: `libtool-2.4.6.tar.gz.1'

libtool-2.4.6. 100%[====>]   1.72M   864KB/s    /  2.0s

2024-08-27 20:45:45 (864 KB/s) - `libtool-2.4.6.tar.gz.1' 저장함 [1806697/1806697]

cd libtool-2.4.6
# make
  GEN      libtoolize
  GEN      libltdl/libltdl/lt__argz.h
make  all-recursive
make[1]: Entering directory '/c/libidn2/libtool-2.4.6'
Making all in .
make[2]: Entering directory '/c/libidn2/libtool-2.4.6'
  CC       libltdl/loaders/libltdl_libltdl_la-preopen.lo
  CC       libltdl/libltdl_libltdl_la-lt__alloc.lo
  CC       libltdl/libltdl_libltdl_la-lt_dlloader.lo
  CC       libltdl/libltdl_libltdl_la-lt_error.lo
  CC       libltdl/libltdl_libltdl_la-ltdl.lo
  CC       libltdl/libltdl_libltdl_la-slist.lo
  CC       libltdl/loaders/loadlibrary.lo
  CCLD     libltdl/loadlibrary.la
C:\msys64\mingw64\bin\ar.exe: `u' modifier ignored since `D' is the default (see `U')
  CC       libltdl/lt__argz.lo
  CCLD     libltdl/libltdl.la
C:\msys64\mingw64\bin\ar.exe: `u' modifier ignored since `D' is the default (see `U')
make[2]: Leaving directory '/c/libidn2/libtool-2.4.6'
make[1]: Leaving directory '/c/libidn2/libtool-2.4.6'

# make install
make  install-recursive
make[1]: Entering directory '/c/libidn2/libtool-2.4.6'
Making install in .
make[2]: Entering directory '/c/libidn2/libtool-2.4.6'
make[3]: Entering directory '/c/libidn2/libtool-2.4.6'
 /usr/bin/mkdir -p '/mingw64/bin'
 /usr/bin/install -c libtool '/mingw64/bin'
 /usr/bin/mkdir -p '/mingw64/lib'
 /bin/sh ./libtool   --mode=install /usr/bin/install -c   libltdl/libltdl.la '/mingw64/lib'
libtool: install: /usr/bin/install -c libltdl/.libs/libltdl.dll.a /mingw64/lib/libltdl.dll.a
libtool: install: base_file=`basename libltdl/libltdl.la`
libtool: install:  dlpath=`/bin/sh 2>&1 -c '. libltdl/.libs/'libltdl.la'i; echo libltdl-7.dll'`
libtool: install:  dldir=/mingw64/lib/`dirname ../bin/libltdl-7.dll`
libtool: install:  test -d /mingw64/lib/../bin || mkdir -p /mingw64/lib/../bin
libtool: install:  /usr/bin/install -c libltdl/.libs/libltdl-7.dll /mingw64/lib/../bin/libltdl-7.dll
libtool: install:  chmod a+x /mingw64/lib/../bin/libltdl-7.dll
libtool: install:  if test -n '' && test -n 'strip --strip-unneeded'; then eval 'strip --strip-unneeded /mingw64/lib/../bin/libltdl-7.dll' || exit 0; fi
libtool: install: /usr/bin/install -c libltdl/.libs/libltdl.lai /mingw64/lib/libltdl.la
libtool: install: /usr/bin/install -c libltdl/.libs/libltdl.a /mingw64/lib/libltdl.a
libtool: install: chmod 644 /mingw64/lib/libltdl.a
libtool: install: ranlib /mingw64/lib/libltdl.a
 GREP='/usr/bin/grep' SED='/usr/bin/sed' './build-aux/inline-source' libtoolize > '/mingw64/bin/libtoolize'
rm -rf '/mingw64/share/libtool'/*
 /usr/bin/install -c -m 644 './m4/libtool.m4' '/mingw64/share/aclocal/libtool.m4'
 /usr/bin/install -c -m 644 './m4/ltargz.m4' '/mingw64/share/aclocal/ltargz.m4'
 /usr/bin/install -c -m 644 './m4/ltdl.m4' '/mingw64/share/aclocal/ltdl.m4'
 /usr/bin/install -c -m 644 './m4/ltoptions.m4' '/mingw64/share/aclocal/ltoptions.m4'
 /usr/bin/install -c -m 644 './m4/ltsugar.m4' '/mingw64/share/aclocal/ltsugar.m4'
 /usr/bin/install -c -m 644 './m4/ltversion.m4' '/mingw64/share/aclocal/ltversion.m4'
 /usr/bin/install -c -m 644 './m4/lt~obsolete.m4' '/mingw64/share/aclocal/lt~obsolete.m4'
 /usr/bin/install -c './build-aux/compile' '/mingw64/share/libtool/build-aux/compile'
 /usr/bin/install -c './build-aux/config.guess' '/mingw64/share/libtool/build-aux/config.guess'
 /usr/bin/install -c './build-aux/config.sub' '/mingw64/share/libtool/build-aux/config.sub'
 /usr/bin/install -c './build-aux/depcomp' '/mingw64/share/libtool/build-aux/depcomp'
 /usr/bin/install -c './build-aux/install-sh' '/mingw64/share/libtool/build-aux/install-sh'
 /usr/bin/install -c './build-aux/missing' '/mingw64/share/libtool/build-aux/missing'
 /usr/bin/install -c -m 644 './build-aux/ltmain.sh' '/mingw64/share/libtool/build-aux/ltmain.sh'
 /usr/bin/install -c -m 644 './libltdl/COPYING.LIB' '/mingw64/share/libtool/COPYING.LIB'
 /usr/bin/install -c -m 644 './libltdl/Makefile.am' '/mingw64/share/libtool/Makefile.am'
 /usr/bin/install -c -m 644 './libltdl/README' '/mingw64/share/libtool/README'
 /usr/bin/install -c -m 644 './libltdl/configure.ac' '/mingw64/share/libtool/configure.ac'
 /usr/bin/install -c -m 644 './libltdl/aclocal.m4' '/mingw64/share/libtool/aclocal.m4'
 /usr/bin/install -c -m 644 './libltdl/Makefile.in' '/mingw64/share/libtool/Makefile.in'
 /usr/bin/install -c -m 644 './libltdl/config-h.in' '/mingw64/share/libtool/config-h.in'
 /usr/bin/install -c -m 644 './libltdl/configure' '/mingw64/share/libtool/configure'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__alloc.h' '/mingw64/share/libtool/libltdl/lt__alloc.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__argz_.h' '/mingw64/share/libtool/libltdl/lt__argz_.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__dirent.h' '/mingw64/share/libtool/libltdl/lt__dirent.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__glibc.h' '/mingw64/share/libtool/libltdl/lt__glibc.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__private.h' '/mingw64/share/libtool/libltdl/lt__private.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt__strl.h' '/mingw64/share/libtool/libltdl/lt__strl.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt_dlloader.h' '/mingw64/share/libtool/libltdl/lt_dlloader.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt_error.h' '/mingw64/share/libtool/libltdl/lt_error.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/lt_system.h' '/mingw64/share/libtool/libltdl/lt_system.h'
 /usr/bin/install -c -m 644 './libltdl/libltdl/slist.h' '/mingw64/share/libtool/libltdl/slist.h'
 /usr/bin/install -c -m 644 './libltdl/loaders/dld_link.c' '/mingw64/share/libtool/loaders/dld_link.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/dlopen.c' '/mingw64/share/libtool/loaders/dlopen.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/dyld.c' '/mingw64/share/libtool/loaders/dyld.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/load_add_on.c' '/mingw64/share/libtool/loaders/load_add_on.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/loadlibrary.c' '/mingw64/share/libtool/loaders/loadlibrary.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/preopen.c' '/mingw64/share/libtool/loaders/preopen.c'
 /usr/bin/install -c -m 644 './libltdl/loaders/shl_load.c' '/mingw64/share/libtool/loaders/shl_load.c'
 /usr/bin/install -c -m 644 './libltdl/lt__alloc.c' '/mingw64/share/libtool/lt__alloc.c'
 /usr/bin/install -c -m 644 './libltdl/lt__argz.c' '/mingw64/share/libtool/lt__argz.c'
 /usr/bin/install -c -m 644 './libltdl/lt__dirent.c' '/mingw64/share/libtool/lt__dirent.c'
 /usr/bin/install -c -m 644 './libltdl/lt__strl.c' '/mingw64/share/libtool/lt__strl.c'
 /usr/bin/install -c -m 644 './libltdl/lt_dlloader.c' '/mingw64/share/libtool/lt_dlloader.c'
 /usr/bin/install -c -m 644 './libltdl/lt_error.c' '/mingw64/share/libtool/lt_error.c'
 /usr/bin/install -c -m 644 './libltdl/ltdl.c' '/mingw64/share/libtool/ltdl.c'
 /usr/bin/install -c -m 644 './libltdl/ltdl.h' '/mingw64/share/libtool/ltdl.h'
 /usr/bin/install -c -m 644 './libltdl/ltdl.mk' '/mingw64/share/libtool/ltdl.mk'
 /usr/bin/install -c -m 644 './libltdl/slist.c' '/mingw64/share/libtool/slist.c'
chmod a+x '/mingw64/share/libtool/configure'
 /usr/bin/mkdir -p '/mingw64/include'
 /usr/bin/install -c -m 644 libltdl/ltdl.h '/mingw64/include'
 /usr/bin/mkdir -p '/mingw64/share/info'
 /usr/bin/install -c -m 644 ./doc/libtool.info ./doc/libtool.info-1 ./doc/libtool.info-2 '/mingw64/share/info'
 install-info --info-dir='/mingw64/share/info' '/mingw64/share/info/libtool.info'
 /usr/bin/mkdir -p '/mingw64/include/libltdl'
 /usr/bin/install -c -m 644 libltdl/libltdl/lt_system.h libltdl/libltdl/lt_error.h libltdl/libltdl/lt_dlloader.h '/mingw64/include/libltdl'
 /usr/bin/mkdir -p '/mingw64/share/man/man1'
 /usr/bin/install -c -m 644 ./doc/libtool.1 ./doc/libtoolize.1 '/mingw64/share/man/man1'
make[3]: Leaving directory '/c/libidn2/libtool-2.4.6'
make[2]: Leaving directory '/c/libidn2/libtool-2.4.6'
make[1]: Leaving directory '/c/libidn2/libtool-2.4.6'

=> libtool 실행 파일: /mingw64/bin/libtoolize
라이브러리 파일들: /mingw64/lib/
헤더 파일들: /mingw64/include/
문서와 매뉴얼: /mingw64/share/info/ 및 /mingw64/share/man/man1/

/c/libidn2/libtool-2.4.6
# /mingw64/bin/libtool --version
libtool (GNU libtool) 2.4.6
Written by Gordon Matzigkeit, 1996

Copyright (C) 2014 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

# which libtoolize
/c/libidn2/libtool-2.4.6/libtoolize

다시 돌아와서
cd /c/libidn2
# autoreconf -if
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.
autoreconf-2.72: error: libtoolize failed with exit status: 1

# libtoolize --install --force
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: linking file 'build-aux/config.guess'
libtoolize: linking file 'build-aux/config.sub'
libtoolize: linking file 'build-aux/install-sh'
libtoolize: linking file 'build-aux/ltmain.sh'
libtoolize:   error: '/mingw64/share/aclocal/libtool.m4' does not exist.

nayou@kimnayooung MINGW64 /c/libidn2
# which
/c/libidn2/libtool-2.4.6/libtoolize

nayou@kimnayooung MINGW64 /c/libidn2
# cd /c/libidn2/libtool-2.4.6

nayou@kimnayooung MINGW64 /c/libidn2/libtool-2.4.6
# notepad libtoolize

  # Locations for important files:
  prefix="/mingw64"
  datadir="/mingw64/share"
  pkgauxdir="/mingw64/share/libtool/build-aux"
  pkgltdldir="/mingw64/share/libtool"
  aclocaldir="/mingw64/share/aclocal"
=>
  #aclocaldir="/mingw64/share/aclocal"
  aclocaldir="/usr/share/aclocal"

다시 돌아와서
cd /c/libidn2
필요한 파일들을 생성 및 재생성
# autoreconf -if
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '/mingw64/share/aclocal'.
libtoolize: copying file '/mingw64/share/aclocal/libtool.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltoptions.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltsugar.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltversion.m4'
libtoolize: copying file '/mingw64/share/aclocal/lt~obsolete.m4'
configure.ac:65: installing 'build-aux/compile'
configure.ac:67: installing 'build-aux/missing'
examples/Makefile.am: installing 'build-aux/depcomp'

프로젝트의 빌드 환경 설정 및 Makefile 생성
#./configure
# ./run_configure.sh
./configure: line 13736: as_fn_executable_p: command not found
./configure: line 13837: as_fn_executable_p: command not found
./configure: line 13882: as_fn_executable_p: command not found
./configure: line 13930: as_fn_executable_p: command not found
./configure: line 13980: as_fn_executable_p: command not found
./configure: line 14303: as_fn_executable_p: command not found
./configure: line 1614: as_fn_set_status: command not found
./configure: line 17405: `        gl_WARN_ADD("-W$w")'
./configure: line 17405: syntax error near unexpected token `"-W$w"'
./configure: line 1800: as_fn_set_status: command not found
./configure: line 2856: as_fn_executable_p: command not found
./configure: line 2962: as_fn_executable_p: command not found
./configure: line 3076: as_fn_executable_p: command not found
./configure: line 3184: as_fn_executable_p: command not found
./configure: line 3912: as_fn_executable_p: command not found
./configure: line 411: as_fn_exit: command not found
./configure: line 4354: as_fn_executable_p: command not found
./configure: line 4405: as_fn_executable_p: command not found
./configure: line 5208: as_fn_executable_p: command not found
./configure: line 5292: as_fn_executable_p: command not found
./configure: line 5366: as_fn_executable_p: command not found
./configure: line 5443: as_fn_executable_p: command not found
./configure: line 6232: as_fn_executable_p: command not found
./configure: line 6342: as_fn_executable_p: command not found
./configure: line 6697: as_fn_executable_p: command not found
./configure: line 6855: as_fn_executable_p: command not found
./configure: line 7051: as_fn_executable_p: command not found
./configure: line 7162: as_fn_executable_p: command not found
./configure: line 7661: as_fn_executable_p: command not found
./configure: line 8061: as_fn_executable_p: command not found
./configure: line 8934: as_fn_executable_p: command not found
: error: C compiler cannot create executables
: error: C preprocessor "/lib/cpp" fails sanity check
: error: cannot compute suffix of executables: cannot compile and link
: error: cannot compute suffix of object files: cannot compile
: error: cannot run C compiled programs.
: error: in '/c/libidn2':
: error: no acceptable C compiler found in $PATH
: error: no acceptable egrep could be found in /c/libidn2/libtool-2.4.6:/mingw64/bin:/usr/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/xpg4/bin
: error: no acceptable fgrep could be found in /c/libidn2/libtool-2.4.6:/mingw64/bin:/usr/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/xpg4/bin
: error: no acceptable grep could be found in /c/libidn2/libtool-2.4.6:/mingw64/bin:/usr/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/xpg4/bin
: error: no acceptable sed could be found in $PATH

(오류처리)
as_fn_executable_p as_fn_set_status as_fn_executable_p not found
configure 스크립트가 제대로 생성되지 않았거나, 필요한 매크로들이 포함되지 않았기 때문에 발생
autoconf, automake, libtool 등을 최신 버전으로 업데이트
pacman -Syu autoconf automake libtool

# grep "as_fn_executable_p ()" /c/libidn2/configure
as_fn_executable_p ()
nayou@kimnayooung MINGW64 /c/libidn2
# notepad configure
정의없이 바로 
if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
    ac_cv_prog_CC="${ac_tool_prefix}gcc"
    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
    break 2
  fi
정의가 없다면, configure 스크립트가 손상된 것이므로 다시 생성
configure 스크립트 재생성
rm -f /c/libidn2/configure
#configure 스크립트를 다시 생성하거나 갱신할 때 사용하는 명령어
-f (--force): 강제로 모든 파일을 다시 생성합니다. 
-i (--install): 필요한 파일들을 자동으로 설치합니다.
-v (--verbose): 실행 과정을 자세히 출력합니다. 
autoreconf -fiv
설치내역
# pacman -Q | grep -E 'autoconf|automake|libtool'
autoconf-wrapper 20240607-1
autoconf2.13 2.13-6
autoconf2.69 2.69-4
autoconf2.71 2.71-3
autoconf2.72 2.72-1
automake-wrapper 20240607-1
automake1.11 1.11.6-6
automake1.12 1.12.6-6
automake1.13 1.13.4-7
automake1.14 1.14.1-6
automake1.15 1.15.1-4
automake1.16 1.16.5-1
automake1.17 1.17-1
libtool 2.4.7-4
mingw-w64-x86_64-libtool 2.4.7-2
패키지 제거
pacman -R autoconf-wrapper autoconf2.13 autoconf2.69 autoconf2.71 autoconf2.72
pacman -R automake-wrapper automake1.11 automake1.12 automake1.13 automake1.14 automake1.15 automake1.16 automake1.17
pacman -R libtool mingw-w64-x86_64-libtool
패키지 재설치
pacman -S autoconf-wrapper autoconf2.72 automake-wrapper automake1.17 libtool mingw-w64-x86_64-libtool
최신 패키지 업데이트
pacman -Syu
기본적인 빌드 도구(예: gcc, make)가 설치되어 있는지 확인
pacman -S base-devel
echo $PATH
/usr/bin 및 mingw64/bin 디렉토리가 포함
Autoconf 및 관련 도구의 설치 상태
# which autoconf
which automake
which libtool
/usr/bin/autoconf
/usr/bin/automake
/c/libidn2/libtool-2.4.6/libtool

# autoreconf -fiv
autoreconf-2.72: export WARNINGS=
autoreconf-2.72: Entering directory '.'
autoreconf-2.72: running: autopoint --force
Copying file po/Makefile.in.in
autoreconf-2.72: running: aclocal --force
autoreconf-2.72: configure.ac: tracing
autoreconf-2.72: running: libtoolize --copy --force
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in AC_CONFIG_MACRO_DIRS, '/mingw64/share/aclocal'.
libtoolize: copying file '/mingw64/share/aclocal/libtool.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltoptions.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltsugar.m4'
libtoolize: copying file '/mingw64/share/aclocal/ltversion.m4'
libtoolize: copying file '/mingw64/share/aclocal/lt~obsolete.m4'
libtoolize: Consider adding '-I /mingw64/share/aclocal' to ACLOCAL_AMFLAGS in Makefile.am.
autoreconf-2.72: running: intltoolize --copy --force
autoreconf-2.72: running: gtkdocize --copy
autoreconf-2.72: running: aclocal --force
autoreconf-2.72: running: /usr/bin/autoconf-2.72 --force
autoreconf-2.72: running: /usr/bin/autoheader-2.72 --force
autoreconf-2.72: running: automake --add-missing --copy --force-missing
configure.ac:65: installing 'build-aux/compile'
configure.ac:67: installing 'build-aux/missing'
examples/Makefile.am: installing 'build-aux/depcomp'
autoreconf-2.72: Leaving directory '.'

Autoconf가 올바르게 설치되어 있는지 확인
# pacman -Ql autoconf-wrapper | grep bin
autoconf-wrapper /usr/bin/
autoconf-wrapper /usr/bin/autoconf
autoconf-wrapper /usr/bin/autoheader
autoconf-wrapper /usr/bin/autom4te
autoconf-wrapper /usr/bin/autoreconf
autoconf-wrapper /usr/bin/autoscan
autoconf-wrapper /usr/bin/autoupdate
autoconf-wrapper /usr/bin/ifnames
패키지 데이터베이스 업데이트
pacman -Syu
Autoconf 설치
pacman -S autoconf
autoconf --version
autoconf (GNU Autoconf) 2.72
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+/Autoconf: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>, <https://gnu.org/licenses/exceptions.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Written by David J. MacKenzie and Akim Demaille.

Autoconf의 직접 다운로드 및 설치
https://ftp.gnu.org/gnu/autoconf/
autoconf-latest.tar.gz
/c/libidn2
wget https://ftp.gnu.org/gnu/autoconf/autoconf-2.72.tar.gz
tar -xzvf autoconf-2.72.tar.gz
cd autoconf-2.72
/c/libidn2/autoconf-2.72
./configure
make
make install
notepad ~/.bashrc
PATH에 추가
/c/libidn2/autoconf-2.72/bin

nayou@kimnayooung MINGW64 /c/libidn2
# which autoconf
/mingw64/bin/autoconf

nayou@kimnayooung MINGW64 /c/libidn2
# source ~/.bashrc

nayou@kimnayooung MINGW64 /c/libidn2
# which autoconf
/c/libidn2/autoconf-2.72/bin/autoconf

# autoreconf -fiv
# ./configure
동일한에러발생

# pacman -S --needed mingw-w64-x86_64-gcc
경고: mingw-w64-x86_64-gcc-14.2.0-1는 최신 버전입니다 -- 건너뜀
 할 일이 없습니다
PATH /mingw64/bin 있는지 확인 없으면 등록 C++, C 컴파일러경
컴파일러 작동 확
gcc는 C 코드에 대한 컴파일을 처리

# gcc --version 
g++ --version

gcc**는 C 언어 소스 코드를 컴파일하는 도구
C 전용 라이브러리 및 옵션을 기본적으로 설정
gcc hello.c -o hello
./hello
gcc.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

g++ hello.cpp -o hello
./hello
g++는 C++ 코드에 대한 컴파일을 처리, C++ 언어 소스 코드를 컴파일하는 도구
C++ 표준 라이브러리 및 C++ 전용 컴파일 옵션을 기본적으로 설정
g++.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

# C 컴파일러 테스트
nayou@kimnayooung MINGW64 /c/libidn2
# echo -e '#include <stdio.h> \nint main() {printf("Hello\\n"); return 0;}' > test.c

nayou@kimnayooung MINGW64 /c/libidn2
# gcc test.c -o test

nayou@kimnayooung MINGW64 /c/libidn2
# ./test
Hello

# C++ 컴파일러 테스트
nayou@kimnayooung MINGW64 /c/libidn2
# echo -e '#include <iostream> \nint main(){std::cout << "Hello\\n";return 0;}' > test.cpp

nayou@kimnayooung MINGW64 /c/libidn2
# g++ test.cpp -o test

nayou@kimnayooung MINGW64 /c/libidn2
# ./test
Hello

no acceptable egrep could be found in /c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/mingw64/bin:/usr/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/xpg4/bin
pacman -S grep
/usr/bin/egrep

(오류)
./configure: line 17405: `        gl_WARN_ADD("-W$w")'
./configure: line 17405: syntax error near unexpected token `"-W$w"'

/c/libidn2
notepad configure.ac
(수정)
# Correct way to call gl_MANYWARN_COMPLEMENT
gl_MANYWARN_COMPLEMENT "$desired_warning_options" "$possible_warning_options"
gl_MANYWARN_COMPLEMENT "$remaining_undesired_warning_options" "$nw"

# Process desired warning options
for w in $desired_warning_options; do
    gl_WARN_ADD $w
done

# Process remaining undesired warning options
for w in `echo "$remaining_undesired_warning_options" | sed -e 's/-W/-Wno-/g'`; do
   gl_WARN_ADD $w
done

(오류)
: error: no acceptable egrep, fgrep, grep could be found in 
/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/mingw64/bin:
/usr/bin:
/usr/share/aclocal:/mingw64/share/aclocal:
/c/Program Files/Java/jdk-21/bin:/usr/local/bin:
/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:
/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:
/usr/bin/vendor_perl:/usr/bin/core_perl:
/c/Users/nayou/AppData/Local/Programs/Python/Python312:/usr/xpg4/bin

# echo $PATH (위와 내용이 다름)
/mingw64/bin:/usr/bin:/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312

환경변수갱신
# source ~/.bashrc

nayou@kimnayooung MINGW64 /c/libidn2
# notepad configure

nayou@kimnayooung MINGW64 /c/libidn2
# which egrep
/usr/bin/egrep

nayou@kimnayooung MINGW64 /c/libidn2
# which fgrep
/usr/bin/fgrep

nayou@kimnayooung MINGW64 /c/libidn2
# which grep
/usr/bin/grep

환경변수조사
# printenv
ProgramFiles(x86)=C:\Program Files (x86)
CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
SHELL=/usr/bin/bash
NUMBER_OF_PROCESSORS=16
PROCESSOR_LEVEL=6
TERM_PROGRAM_VERSION=3.7.4
MINGW_PREFIX=/mingw64
NVCUDASAMPLES11_5_ROOT=C:\ProgramData\NVIDIA Corporation\CUDA Samples\v11.8
OPENCV_ENABLE_TBB=ON
PKG_CONFIG_PATH=/mingw64/lib/pkgconfig:/mingw64/share/pkgconfig
USERDOMAIN_ROAMINGPROFILE=KIMNAYOOUNG
HOSTNAME=kimnayooung
PROGRAMFILES=C:\Program Files
PROTOBUF_HOME=C:\protobuf
MSYSTEM=MINGW64
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
JAVA_HOME=C:\Program Files\Java\jdk-17;
CUDNN_LIBRARY=C:\Program Files\NVIDIA\CUDNN\v9.1\lib\12.4\x64
ORIGINAL_TEMP=/c/Users/nayou/AppData/Local/Temp
CUDA_PATH_V12_1=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1
MINGW_CHOST=x86_64-w64-mingw32
OS=Windows_NT
HOMEDRIVE=C:
MSYSTEM_CARCH=x86_64
TBB_DIR=C:\Program Files (x86)\Intel\oneAPI\tbb\2021.12\bin
USERDOMAIN=KIMNAYOOUNG
TORCH_CUDA_HOME=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1
PWD=/c/libidn2
GIT_LFS_PATH=C:\Program Files\Git LFS
USERPROFILE=C:\Users\nayou
TBB_ROOT=C:\Program Files (x86)\Intel\oneAPI\tbb\2021.12\bin
OneDriveConsumer=C:\Users\nayou\OneDrive
CUDNN_HOME=C:\Program Files\NVIDIA\CUDNN\v9.1
MANPATH=/mingw64/local/man:/mingw64/share/man:/usr/local/man:/usr/share/man:/usr/man:/share/man
TESSDATA_PREFIX=C:\Program Files (x86)\Tesseract-OCR\
PRINTER=Kyocera ECOSYS M5521cdn
CUDA_BIN_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1\bin
JAVA_HOME_21=C:\Program Files\Java\jdk-21
VS140COMNTOOLS=C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\Tools\
TZ=Asia/Seoul
include=C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\um\x86;C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.29.30133\lib\x86;C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\ucrt\x86;C:\VulkanSDK\1.3.290.0\Include;C:\abseil-cpp\build\install\include;
MINGW_PACKAGE_PREFIX=mingw-w64-x86_64
ALLUSERSPROFILE=C:\ProgramData
ORIGINAL_PATH=/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/
CommonProgramW6432=C:\Program Files\Common Files
HOME=/home/nayou
USERNAME=nayou
VULKAN_SDK=C:\VulkanSDK\1.3.290.0
LANG=ko_KR.UTF-8
OneDrive=C:\Users\nayou\OneDrive
COMSPEC=C:\Windows\system32\cmd.exe
PROTOC=C:\protobuf\build\install\bin\protoc.exe
CMAKE_PREFIX_PATH=C:\Qt\6.7.1\msvc2019_64\include
APPDATA=C:\Users\nayou\AppData\Roaming
NVCUDASAMPLES_ROOT=C:\ProgramData\NVIDIA Corporation\CUDA Samples\v11.8
SYSTEMROOT=C:\Windows
LOCALAPPDATA=C:\Users\nayou\AppData\Local
CUDA_INCLUDE_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1\include
CUDA_TOOLKIT_ROOT_DIR=C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v12.1
COMPUTERNAME=KIMNAYOOUNG
VK_SDK_PATH=C:\VulkanSDK\1.3.290.0
INFOPATH=/mingw64/local/info:/mingw64/share/info:/usr/local/info:/usr/share/info:/usr/info:/share/info
PYTHONPATH=C:\Users\nayou\AppData\Local\Programs\Python\Python312
TERM=xterm
LOGONSERVER=\\KIMNAYOOUNG
ZES_ENABLE_SYSMAN=1
CPLUS_INCLUDE_PATH=C:\Users\nayou\yaml-cpp\include
ACLOCAL_PATH=/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/m4
NVCODEC_ROOT=C:\Video_Codec_SDK
USER=nayou
PSModulePath=C:\Program Files\WindowsPowerShell\Modules;C:\Windows\system32\WindowsPowerShell\v1.0\Modules
NVTOOLSEXT_PATH=C:\Program Files\NVIDIA Corporation\NvToolsExt\
LIBRARY_PATH=C:\protobuf\build\install\lib;C:\abseil-cpp\build\install\lib
CUDA_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1
OPENCV_DIR=C:\opencv\build
TEMP=/tmp
BAZEL_SH=C:\msys64\usr\bin\bash.exe
MSYSTEM_CHOST=x86_64-w64-mingw32
ORIGINAL_TMP=/c/Users/nayou/AppData/Local/Temp
SHLVL=1
PROCESSOR_REVISION=ba02
DriverData=C:\Windows\System32\Drivers\DriverData
GRPC_JAVA_PLUGIN=c:\grpc-java\build\gradle\wrapper\protoc-gen-grpc-java.exe
COMMONPROGRAMFILES=C:\Program Files\Common Files
LD_LIBRARY_PATH=/c/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v11.8/lib/x64
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 186 Stepping 2, GenuineIntel
PS1=\[\e]0;\w\a\]\n\[\e[32m\]\u@\h \[\e[35m\]$MSYSTEM\[\e[0m\] \[\e[33m\]\w\[\e[0m\]\n\[\e[1m\]#\[\e[0m\]
lib=C:\VulkanSDK\1.3.290.0\Lib
MKLROOT=C:\Program Files (x86)\Intel\oneAPI\mkl
PKG_CONFIG_SYSTEM_LIBRARY_PATH=/mingw64/lib
CUDA_HOME=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1
HOMEPATH=\Users\nayou
XDG_DATA_DIRS=/mingw64/share/:/usr/local/share/:/usr/share/
MSYSCON=mintty.exe
TMP=/tmp
CONFIG_SITE=/etc/config.site
PATH=/mingw64/bin:/usr/bin:/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312
CUDA_LIB_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1\lib\x64
ProgramW6432=C:\Program Files
MSYSTEM_PREFIX=/mingw64
QtMsBuild=C:\Users\nayou\AppData\Local\QtMsBuild
WINDIR=C:\Windows
PROCESSOR_ARCHITECTURE=AMD64
PUBLIC=C:\Users\Public
PKG_CONFIG_SYSTEM_INCLUDE_PATH=/mingw64/include
SYSTEMDRIVE=C:
BAZEL_VS=C:\Program Files (x86)\Microsoft Visual Studio\2019\Community
OLDPWD=/home/nayou
TERM_PROGRAM=mintty
ProgramData=C:\ProgramData
_=/usr/bin/printenv
=>/c/libidn2/autoconf-2.72/bin로 시작되는 환경변수없음
=>다시등록
# export PATH='/mingw64/bin:/usr/bin:/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312'
MSYS2 패키지 설치 확인
pacman -S base-devel mingw-w64-x86_64-toolchain

nayou@kimnayooung MINGW64 /c/libidn2
# which pkg-config
/mingw64/bin/pkg-config

nayou@kimnayooung MINGW64 /c/libidn2
# which sed
/usr/bin/sed

nayou@kimnayooung MINGW64 /c/libidn2
# which grep
/usr/bin/grep

# echo $PATH
/mingw64/bin:/usr/bin:/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312
# pacman -S pkg-config sed grep egrep fgrep
경고: pkgconf-2.3.0-1는 최신 버전입니다. -- 재설치
경고: sed-4.9-1는 최신 버전입니다. -- 재설치
경고: grep-1~3.0-6는 최신 버전입니다. -- 재설치
grep)오류: 대상이 없습니다: egrep
grep)오류: 대상이 없습니다: fgrep

notepad ~/.bashrc
#추가
export CPP=/mingw64/bin/cpp
export CC=/mingw64/bin/gcc
export CXX=/mingw64/bin/g++
./run_configure.sh
C preprocessor /mingw64/bin/cpp fails sanity check" 오류는 cpp 명령어가 올바르게 작동하지 않거나, cpp의 환경 설정이 잘못되어 있다는 것을 의미
CPP동작확
nayou@kimnayooung MINGW64 /c/libidn2
# echo "int main() { return 0; }" | cpp -E -
# 0 "<stdin>"
# 0 "<built-in>"
# 0 "<command-line>"
# 1 "<stdin>"
int main() { return 0; }
오류 메시지가 없다면 cpp는 정상적으로 작동하는 것

gcc와 cpp의 버전이 일치하는지 확인
# /mingw64/bin/gcc --version
/mingw64/bin/cpp --version
\gcc.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

cpp.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

패키지 확인 및 재설치
pacman -Syu mingw-w64-x86_64-gcc
config.log 확인

nayou@kimnayooung MINGW64 /c/libidn2
# echo $CC
/mingw64/bin/gcc

nayou@kimnayooung MINGW64 /c/libidn2
# export CC=/mingw64/bin/gcc

nayou@kimnayooung MINGW64 /c/libidn2
# echo $CXX
/mingw64/bin/g++

nayou@kimnayooung MINGW64 /c/libidn2
# export CXX=/mingw64/bin/g++

(오류)
pkg-config not found
export PKG_CONFIG=/mingw64/bin/pkg-config

nayou@kimnayooung MINGW64 /c/libidn2
# notepad ~/.bashrc
#추가
export CPP=/mingw64/bin/cpp
export CC=/mingw64/bin/gcc
export CXX=/mingw64/bin/g++
export PKG_CONFIG=/mingw64/bin/pkg-config
export SED=/usr/bin/sed
export GREP=/usr/bin/grep
export FGREP=/usr/bin/fgrep
export EGREP=/usr/bin/egrep
성공!
(오류)
: error: C preprocessor "/mingw64/bin/cpp" fails sanity check
: error: in '/c/libidn2':

nayou@kimnayooung MINGW64 /c/libidn2
# gcc -v
Using built-in specs.
COLLECT_GCC=C:\msys64\mingw64\bin\gcc.exe
COLLECT_LTO_WRAPPER=C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/lto-wrapper.exe
Target: x86_64-w64-mingw32
Configured with: ../gcc-14.2.0/configure --prefix=/mingw64 --with-local-prefix=/mingw64/local --build=x86_64-w64-mingw32 --host=x86_64-w64-mingw32 --target=x86_64-w64-mingw32 --with-native-system-header-dir=/mingw64/include --libexecdir=/mingw64/lib --enable-bootstrap --enable-checking=release --with-arch=nocona --with-tune=generic --enable-languages=c,lto,c++,fortran,ada,objc,obj-c++,rust,jit --enable-shared --enable-static --enable-libatomic --enable-threads=posix --enable-graphite --enable-fully-dynamic-string --enable-libstdcxx-filesystem-ts --enable-libstdcxx-time --disable-libstdcxx-pch --enable-lto --enable-libgomp --disable-libssp --disable-multilib --disable-rpath --disable-win32-registry --disable-nls --disable-werror --disable-symvers --with-libiconv --with-system-zlib --with-gmp=/mingw64 --with-mpfr=/mingw64 --with-mpc=/mingw64 --with-isl=/mingw64 --with-pkgversion='Rev1, Built by MSYS2 project' --with-bugurl=https://github.com/msys2/MINGW-packages/issues --with-gnu-as --with-gnu-ld --disable-libstdcxx-debug --enable-plugin --with-boot-ldflags=-static-libstdc++ --with-stage1-ldflags=-static-libstdc++
Thread model: posix
Supported LTO compression algorithms: zlib zstd
gcc version 14.2.0 (Rev1, Built by MSYS2 project)

C Preprocessor Sanity Check Failed
nayou@kimnayooung MINGW64 /c/libidn2
gcc -v와 cpp -v를 실행하여 컴파일러와 전처리기가 올바르게 설정되었는지 확인
# cpp -v
Using built-in specs.
COLLECT_GCC=C:\msys64\mingw64\bin\cpp.exe
Target: x86_64-w64-mingw32
Configured with: ../gcc-14.2.0/configure --prefix=/mingw64 --with-local-prefix=/mingw64/local --build=x86_64-w64-mingw32 --host=x86_64-w64-mingw32 --target=x86_64-w64-mingw32 --with-native-system-header-dir=/mingw64/include --libexecdir=/mingw64/lib --enable-bootstrap --enable-checking=release --with-arch=nocona --with-tune=generic --enable-languages=c,lto,c++,fortran,ada,objc,obj-c++,rust,jit --enable-shared --enable-static --enable-libatomic --enable-threads=posix --enable-graphite --enable-fully-dynamic-string --enable-libstdcxx-filesystem-ts --enable-libstdcxx-time --disable-libstdcxx-pch --enable-lto --enable-libgomp --disable-libssp --disable-multilib --disable-rpath --disable-win32-registry --disable-nls --disable-werror --disable-symvers --with-libiconv --with-system-zlib --with-gmp=/mingw64 --with-mpfr=/mingw64 --with-mpc=/mingw64 --with-isl=/mingw64 --with-pkgversion='Rev1, Built by MSYS2 project' --with-bugurl=https://github.com/msys2/MINGW-packages/issues --with-gnu-as --with-gnu-ld --disable-libstdcxx-debug --enable-plugin --with-boot-ldflags=-static-libstdc++ --with-stage1-ldflags=-static-libstdc++
Thread model: posix
Supported LTO compression algorithms: zlib zstd
gcc version 14.2.0 (Rev1, Built by MSYS2 project)
COLLECT_GCC_OPTIONS='-E' '-v' '-mtune=generic' '-march=nocona'
 C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/cc1.exe -E -quiet -v -iprefix C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/ -D_REENTRANT - -mtune=generic -march=nocona -dumpbase -
ignoring nonexistent directory "C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/include"
ignoring duplicate directory "C:/msys64/mingw64/lib/gcc/../../lib/gcc/x86_64-w64-mingw32/14.2.0/include"
ignoring nonexistent directory "D:/a/msys64/mingw64/include"
ignoring nonexistent directory "/mingw64/include"
ignoring duplicate directory "C:/msys64/mingw64/lib/gcc/../../lib/gcc/x86_64-w64-mingw32/14.2.0/include-fixed"
ignoring nonexistent directory "C:/msys64/mingw64/lib/gcc/../../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/include"
ignoring nonexistent directory "D:/a/msys64/mingw64/include"
#include "..." search starts here:
#include <...> search starts here:
 C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/include
 C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../include
 C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/include-fixed
End of search list.

gettext Library Not Found
pacman -S mingw-w64-x86_64-gettext
PKG_CONFIG_PATH를 설정
notepad ~/.bashrc
export CPP=/mingw64/bin/cpp
export CC=/mingw64/bin/gcc
export CXX=/mingw64/bin/g++
export PKG_CONFIG=/mingw64/bin/pkg-config
export PKG_CONFIG_PATH=/mingw64/lib/pkgconfig:/usr/lib/pkgconfig
export SED=/usr/bin/sed
export GREP=/usr/bin/grep
export FGREP=/usr/bin/fgrep
export EGREP=/usr/bin/egrep
=>soruce ~/.bashrc

iconv Library Not Found
문자 인코딩 변환을 위해 필요한 라이브러리
pacman -S mingw-w64-x86_64-gettext mingw-w64-x86_64-libiconv

nayou@kimnayooung MINGW64 /mingw64/lib/pkgconfig
# notepad iconv.pc

# pacman -Q pkg-config
pacman -Q mingw-w64-x86_64-libiconv
pkgconf 2.3.0-1
mingw-w64-x86_64-libiconv 1.17-4
=> 이렇게 안나오면 설치 pacman -S pkg-config

notepad /mingw64/lib/pkgconfig/iconv 확인 없으면 생성
prefix=/mingw64
exec_prefix=${prefix}
libdir=${exec_prefix}/lib
includedir=${prefix}/include

Name: iconv
Description: libiconv
URL: https://www.gnu.org/software/libiconv/
Version: 1.17
Libs: -L${libdir} -liconv
Cflags: -I${includedir}

pkg-config가 올바른 .pc 파일을 찾을 수 있도록 설정
export PKG_CONFIG_PATH=/mingw64/lib/pkgconfig:/usr/lib/pkgconfig
CFLAGS, CPPFLAGS, LDFLAGS: 헤더 파일과 라이브러리 경로를 올바르게 설정
nayou@kimnayooung MINGW64 /c/libidn2
# export CFLAGS="-I/mingw64/include"
export CPPFLAGS="-I/mingw64/include"
export LDFLAGS="-L/mingw64/lib"
pkg-config 명령어 확인

# pkg-config --cflags gettext
pkg-config --libs gettext
Package gettext was not found in the pkg-config search path.
Perhaps you should add the directory containing `gettext.pc'
to the PKG_CONFIG_PATH environment variable
Package 'gettext' not found
Package gettext was not found in the pkg-config search path.
Perhaps you should add the directory containing `gettext.pc'
to the PKG_CONFIG_PATH environment variable
Package 'gettext' not found

nayou@kimnayooung MINGW64 /c/libidn2
#
pkg-config --cflags iconv
pkg-config --libs iconv

-liconv

nayou@kimnayooung MINGW64 /mingw64/lib/pkgconfig
# ls -l /mingw64/lib/pkgconfig/iconv.pc
-rw-r--r-- 1 nayou nayou 235  2월  2  2024 /mingw64/lib/pkgconfig/iconv.pc

nayou@kimnayooung MINGW64 /mingw64/lib/pkgconfig
# ls -l /mingw64/lib/pkgconfiggettext.pc
ls: cannot access '/mingw64/lib/pkgconfiggettext.pc': No such file or directory

# pkg-config --cflags gettext
pkg-config --libs gettext
Package gettext was not found in the pkg-config search path.
Perhaps you should add the directory containing `gettext.pc'
to the PKG_CONFIG_PATH environment variable
Package 'gettext' not found
Package gettext was not found in the pkg-config search path.
Perhaps you should add the directory containing `gettext.pc'
to the PKG_CONFIG_PATH environment variable
Package 'gettext' not found

일반적으로 MSYS2에서는 /mingw64/lib/pkgconfig 경로에 pkg-config 파일들이 위치
export PKG_CONFIG_PATH=/mingw64/lib/pkgconfig:$PKG_CONFIG_PATH

nayou@kimnayooung MINGW64 /c/libidn2
# find /mingw64 -name gettext.pc

nayou@kimnayooung MINGW64 /mingw64/lib/pkgconfig
# ls -l /mingw64/lib/pkgconfig/gettext.pc
ls: cannot access '/mingw64/lib/pkgconfig/gettext.pc': No such file or directory

nayou@kimnayooung MINGW64 /c/libidn2
# pacman -Q mingw-w64-x86_64-gettext
mingw-w64-x86_64-gettext-tools 0.22.5-2
=> gettext가아닌 gettexttools 

https://mlocati.github.io/articles/gettext-iconv-windows.html
gettext 0.21 and iconv 1.16 - Binaries for Windows
0.21	1.16	64 bit	static2	Setup ZIP

https://www.gnu.org/software/gettext/
https://ftp.gnu.org/pub/gnu/gettext/gettext-0.22.5.tar.gz

wget https://ftp.gnu.org/pub/gnu/gettext/gettext-0.22.5.tar.gz
tar xzf gettext-0.22.5.tar.gz
cd gettext-0.22.5
./configure --prefix=/c/libidn2/gettext-0.22.5
(오류)
환경설정변수 추가
~/.bashrc
export C_INCLUDE_PATH=/mingw64/include
export CPLUS_INCLUDE_PATH=/mingw64/include
source ~/.bashrc
3가지설치하기
pacman -S mingw-w64-x86_64-libtextstyle mingw-w64-x86_64-iconv mingw-w64-x86_64-gettext
오류: 대상이 없습니다: mingw-w64-x86_64-libtextstyle
경고: mingw-w64-x86_64-gettext-tools-0.22.5-2는 최신 버전입니다. -- 재설치

nayou@kimnayooung MINGW64 /c/libidn2
# find / -name gettext-0.22.5
/mingw64/share/gettext-0.22.5
# wget https://ftp.gnu.org/gnu/gettext/gettext-0.22.5.tar.gz
nayou@kimnayooung MINGW64 /c/libidn2
# tar xzf gettext-0.22.5.tar.gz
/mingw64: MSYS2 환경에서 사용하는 표준 경로입니다. MSYS2 패키지 관리 시스템에 의해 관리되며, 
소프트웨어와 라이브러리를 이 경로에 설치하면 다른 패키지와의 충돌을 방지할 수 있습니다.
c/libidn2: 특정 프로젝트나 소스 코드에 관련된 별도의 디렉터리입니다. 일반적으로 패키지 관리와는 무관하며,
특정 프로젝트나 라이브러리만을 위한 경로입니다.
./configure --prefix=/mingw64

# make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
(오류)
## You can ignore compiler warnings in this directory.  ##
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x140): undefined reference to `__imp_color_test_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x15d): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x16b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x19b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1a9): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1b8): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1cb): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1d9): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1e7): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x214): undefined reference to `__imp_style_file_name'
collect2.exe: error: ld returned 1 exit status
make[4]: *** [Makefile:1784: hello.exe] 오류 1
make[3]: *** [Makefile:1999: all-recursive] 오류 1
make[2]: *** [Makefile:1927: all] 오류 2
make[1]: *** [Makefile:408: all-recursive] 오류 1
make: *** [Makefile:364: all] 오류 2

undefined reference to '__imp_color_test_mode'
특정 심볼(__imp_color_test_mode)에 대한 참조가 정의되지 않았음을 의미
라이브러리 링크 확인: libtextstyle이 올바르게 링크되었는지 확인
pacman -S mingw-w64-x86_64-libtextstyle
오류: 대상이 없습니다: mingw-w64-x86_64-libtextstyle
https://packages.msys2.org/package/db?repo=msys&variant=x86_64 패키지검색
없음
구글 검색 
https://github.com/autotools-mirror/gettext/tree/master/libtextstyle
일단 파일이 있는 지 확인
/c/libidn2/gettext-0.22.5/libtextstyle
ls
aclocal.m4   config.h.in    doc              lib          README
adhoc-tests  config.log     examples         libtool      stamp-h1
AUTHORS      config.status  gnulib-local     m4           tests
autogen.sh   configure      gnulib-m4        Makefile     version.sh
build-aux    configure.ac   HACKING          Makefile.am
ChangeLog    COPYING        INSTALL          Makefile.in
config.h     DEPENDENCIES   INSTALL.windows  NEWS
있어서
libtextstyle을 빌드하고 설치
make, gcc, autoconf, automake 등이 필요, MSYS2 패키지 매니저를 사용
pacman -S base-devel

구성(Configuration)
시스템에 맞게 패키지 빌드 환경을 설정
./configure

소스 코드를 컴파일
make
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
## You can ignore compiler warnings in this directory.  ##
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x140): undefined reference to `__imp_color_test_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x15d): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x16b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x19b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1a9): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1b8): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1cb): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1d9): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1e7): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x214): undefined reference to `__imp_style_file_name'
collect2.exe: error: ld returned 1 exit status
make[2]: *** [Makefile:1784: hello.exe] 오류 1
make[1]: *** [Makefile:1999: all-recursive] 오류 1
make: *** [Makefile:1927: all] 오류 2

"C:\libidn2\gettext-0.22.5\libtextstyle\Makefile"
LIBS += -ltextstyle #추가
LDFLAGS = -L/mingw64/lib -ltextstyle #추가
nayou@kimnayooung MINGW64 /mingw64/lib
# ls libtextstyle*
libtextstyle.a  libtextstyle.la
libtextstyle.a 파일이 있는 경로가 lib
기존 빌드 캐시를 정리하고 빌드를 시도
make clean
make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
C:/msys64/mingw64/include/c++/14.2.0/cstdlib:79:15: fatal error: stdlib.h: No such file or directory
make[6]: *** [Makefile:1475: autosprintf.lo] 오류 1
make[5]: *** [Makefile:1655: all-recursive] 오류 1
make[4]: *** [Makefile:1354: all] 오류 2
make[3]: *** [Makefile:1852: all-recursive] 오류 1
make[2]: *** [Makefile:1757: all] 오류 2
make[1]: *** [Makefile:408: all-recursive] 오류 1
make: *** [Makefile:364: all] 오류 2
stdlib.h 같은 표준 라이브러리 파일이 누락되었거나 경로 설정이 잘못되었음
패키지 업데이트
pacman -Syu
C++ 컴파일러와 관련 패키지 재설치
pacman -S mingw-w64-x86_64-gcc mingw-w64-x86_64-headers mingw-w64-x86_64-crt
C++ 헤더 파일 경로 확인
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5
# ls /mingw64/include/stdlib.h
/mingw64/include/stdlib.h

"C:\msys64\mingw64\include\stdlib.h"
PATH에 /mingw64/bin포함확인
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5
# echo $PATH
/mingw64/bin:/usr/bin:/bin:/usr/share/aclocal:/mingw64/share/aclocal:/c/libidn2/autoconf-2.72/bin:/c/libidn2/libtool-2.4.6:/c/Program Files/Java/jdk-21/bin:/usr/local/bin:/c/Windows/System32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Users/nayou/AppData/Local/Programs/Python/Python312
# echo $C_INCLUDE_PATH
/mingw64/include
# echo $CPLUS_INCLUDE_PATH
/mingw64/include
# gcc --version
g++ --version
gcc.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

g++.exe (Rev1, Built by MSYS2 project) 14.2.0
Copyright (C) 2024 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
MSYS2 패키지 설치
pacman -S mingw-w64-x86_64-toolchain
컴파일 옵션 및 설정 확인
"C:\libidn2\gettext-0.22.5\libtextstyle\Makefile"
CFLAGS = -I/mingw64/include
CXX = /mingw64/bin/g++
CXXFLAGS = -I/mingw64/include
컴파일러직접정하기 예)g++ -I/mingw64/include -o myprogram myprogram.cpp
MSYS2 패키지 재설치
pacman -S mingw-w64-x86_64-gcc mingw-w64-x86_64-headers mingw-w64-x86_64-crt
컴파일러 및 라이브러리 재설치
pacman -Syu mingw-w64-x86_64-toolchain
패키지 관리 데이터베이스 갱신
pacman -Syu
빌드 캐시 정리
make clean
빌드 재시도
make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
(에러)
...
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x140): undefined reference to __imp_color_test_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x15d): undefined reference to __imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x16b): undefined reference to __imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x19b): undefined reference to __imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1a9): undefined reference to __imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1b8): undefined reference to __imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1cb): undefined reference to __imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1d9): undefined reference to __imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1e7): undefined reference to __imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x214): undefined reference to __imp_style_file_name'
collect2.exe: error: ld returned 1 exit status
make[2]: *** [Makefile:1784: hello.exe] 오류 1
make[1]: *** [Makefile:2003: all-recursive] 오류 1
make: *** [Makefile:1931: all] 오류 2
심볼 정의가 포함된 헤더 파일을 찾고, 헤더 파일이 코드와 일치하는지 확인
헤더 파일 위치 확인
color_test_mode라는 심볼이 정의된 파일
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# echo $C_INCLUDE_PATH
/mingw64/include

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# find $C_INCLUDE_PATH -name "*.h" | grep "color"
/mingw64/include/colordlg.h
/mingw64/include/gdiplus/gdipluscolor.h
/mingw64/include/gdiplus/gdipluscolormatrix.h
없음

__imp_color_test_mode, __imp_color_mode, __imp_style_file_name 라이브러리를 찾을 수 없음
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# ls /mingw64/include/textstyle
stdbool.h  version.h  woe32dll.h

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep -r "color_test_mode" /mingw64/include/textstyle
grep -r "color_mode" /mingw64/include/textstyle
grep -r "style_file_name" /mingw64/include/textstyle

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# nm -g /mingw64/lib/libtextstyle.a | grep "color_test_mode"
nm -g /mingw64/lib/libtextstyle.a | grep "color_mode"
nm -g /mingw64/lib/libtextstyle.a | grep "style_file_name"
0000000000000000 B color_test_mode
0000000000000000 D color_mode
0000000000000008 B style_file_name
libtextstyle.a 라이브러리 파일에서 color_test_mode, color_mode, style_file_name 기호를 찾을 수 있다는 것은 
이 라이브러리가 이러한 기호를 정의하고 있음을 나타낸다
undefined reference 오류가 발생하는 이유는 링크 시에 올바른 기호를 참조하지 못하거나, 
링크 시 순서나 설정이 올바르지 않기 때문
종속성이 있는 라이브러리를 먼저 링크하고, 그에 의존하는 라이브러리를 나중에 링크
nm 명령어의 결과에서 기호가 B (BSS 섹션, 초기화되지 않은 데이터) 또는 D (데이터 섹션)로 표시되는 것을 확인할 수 있습니다. 
이들은 전역 변수가 선언된 위치를 나타낸다.
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# find . -name "hello.o"
./adhoc-tests/hello.o
libtextstyle이 정확히 링크되고 있는지 확인
libtextstyle이 동적라이브러리로 컴파일되었는데 정적라이브러리를 사용하려다보니 충돌이 일어난것
libtextstyle을 정적라이브러리로 컴파일하기로함
libtextstyle의 소스 코드가 있는 디렉터리로 이동
./configure --enable-static --disable-shared
make
make install
확인
정적 라이브러리 확인
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# ls /mingw64/lib/libtextstyle.a
/mingw64/lib/libtextstyle.a
링커 명령어 확인(라이브러리를 링크하는 순서가 중요, -Wl,--no-as-needed 플래그를 추가하여 링커가 필요 없는 라이브러리를 제외하지 않도록 설정)
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# gcc -o hello ./adhoc-tests/hello.o -L/mingw64/lib -ltextstyle -lncurses -lws2_32 -lkernel32 -luser32 -lgdi32
(gcc -o hello ./adhoc-tests/hello.o -L/mingw64/lib -lncurses -lws2_32 -ltextstyle)
헤더 파일과 심볼 확인
find /mingw64/include -name "textstyle.h"
(만약 누락되었다면 
find /c/libidn2/gettext-0.22.5/libtextstyle -name "textstyle.h"
cp /c/libidn2/gettext-0.22.5/libtextstyle/textstyle.h /mingw64/include/)
/mingw64/include/textstyle.h
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep "color_test_mode" /mingw64/include/textstyle.h
grep "color_mode" /mingw64/include/textstyle.h
grep "style_file_name" /mingw64/include/textstyle.h
extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
/* Assign a default value to style_file_name if necessary.

hello.o의 심볼
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# nm -g ./adhoc-tests/hello.o | grep "color_test_mode"
nm -g ./adhoc-tests/hello.o | grep "color_mode"
nm -g ./adhoc-tests/hello.o | grep "style_file_name"
0000000000000000 R .refptr.color_test_mode
                 U color_test_mode
0000000000000000 R .refptr.color_mode
                 U color_mode
0000000000000000 R .refptr.style_file_name
                 U style_file_name

libtextstyle.a 파일의 심볼 확인
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# nm -g /mingw64/lib/libtextstyle.a | grep "color_test_mode"
nm -g /mingw64/lib/libtextstyle.a | grep "color_mode"
nm -g /mingw64/lib/libtextstyle.a | grep "style_file_name"
0000000000000000 B color_test_mode
0000000000000000 D color_mode
0000000000000008 B style_file_name

make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
(에러)
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# cp /mingw64/lib/libtextstyle.la /c/libidn2/gettext-0.22.5/libtextstyle/lib/
/c/libidn2/gettext-0.22.5/libtextstyle/lib/libtextstyle.a 생성되야함
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5
# make 2>&1 | grep -E "(error|not|오류|warning|undefined)"
## You can ignore compiler warnings in this directory.  ##
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x140): undefined reference to `__imp_color_test_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x15d): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x16b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x19b): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1a9): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1b8): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1cb): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1d9): undefined reference to `__imp_color_mode'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x1e7): undefined reference to `__imp_style_file_name'
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: hello.o:hello.c:(.text+0x214): undefined reference to `__imp_style_file_name'
collect2.exe: error: ld returned 1 exit status
make[4]: *** [Makefile:1784: hello.exe] 오류 1
make[3]: *** [Makefile:1999: all-recursive] 오류 1
make[2]: *** [Makefile:1927: all] 오류 2
make[1]: *** [Makefile:408: all-recursive] 오류 1
make: *** [Makefile:364: all] 오류 2
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5
# cd libtextstyle
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
aclocal은 configure.ac 파일에 정의된 매크로를 처리하여 aclocal.m4 파일을 생성
# aclocal
configure.ac:25: error: AC_INIT should be called with package and version arguments
/usr/share/aclocal-1.16/init.m4:29: AM_INIT_AUTOMAKE is expanded from...
configure.ac:25: the top level
autom4te: error: /usr/bin/m4 failed with exit status: 1
aclocal-1.16: error: autom4te failed with exit status: 1
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# aclocal
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
configure.ac 또는 configure.in 파일을 바탕으로 configure 스크립트를 생성
# autoconf
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
automake는 Makefile.am 파일을 바탕으로 Makefile.in 파일을 생성
# automake --add-missing
(오류)
C:\libidn2\gettext-0.22.5\libtextstyle
Makefile.am과 Makefile.gnulib 오류

Makefile.am 수정
subdir-objects 옵션이 활성화
Makefile.am 파일 Makefile.am 파일의 최상단에 추가
AM_DEFAULT_OPTIONS = subdir-objects
=> AUTOMAKE_OPTIONS = subdir-objects 수정
#추가 configure.ac 와 맞춰준다
# 조건부 설정: WOE32 조건이 활성화되면 추가 소스 파일을 포함합니다.
if WOE32
libtextstyle_la_SOURCES += lib/woe32-specific.c
endif

# 조건부 설정: WOE32DLL 조건이 활성화되면 DLL 관련 설정을 추가합니다.
if WOE32DLL
libtextstyle_la_LDFLAGS = -export-dynamic
endif

configure.ac 수정
AC_INIT([libtextstyle], [0.1], [bug-libtextstyle@example.com]) #수정

# Check for host type and setup conditionals.
case "$host_os" in
  mingw* | cygwin*) is_woe32=yes ;;
  *) is_woe32=no ;;
esac
AM_CONDITIONAL([WOE32], [test $is_woe32 = yes])

if test "$enable_shared" = yes; then
  case "$host_os" in
    mingw* | cygwin*) is_woe32dll=yes ;;
    *) is_woe32dll=no ;;
  esac
else
  is_woe32dll=no
fi
AM_CONDITIONAL([WOE32DLL], [test $is_woe32dll = yes])

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# automake --add-missing
Makefile.am:32: but option 'subdir-objects' is disabled

makefile.am 수정
AUTOMAKE_OPTIONS = 1.13 gnu no-dependencies subdir-objects
AUTOMAKE_OPTIONS = 1.13 gnu no-dependencies subdir-objects
ACLOCAL_AMFLAGS = -I m4 -I gnulib-m4

# The list of subdirectories containing Makefiles.
SUBDIRS = lib tests adhoc-tests doc

# Remove the dynamic library rule
# lib_LTLIBRARIES = libtextstyle.la

# Add a static library rule
noinst_LIBRARIES = libtextstyle.a

libtextstyle_a_SOURCES = \
  lib/foo.c \
  lib/bar.c \
  lib/baz.c 

install: all
	$(INSTALL) -m 755 lib/libtextstyle.a $(prefix)/lib

configure.ac 수정
dnl 정적 라이브러리만을 위해 LT_INIT을 단순하게 초기화
LT_INIT([disable-shared])

case "$host_os" in
  mingw* | cygwin*) is_woe32=yes ;;
  *) is_woe32=no ;;
esac
AM_CONDITIONAL([WOE32], [test $is_woe32 = yes])

##include "textstyle/woe32dll.h"
#AC_CONFIG_FILES([lib/textstyle/woe32dll.h:lib/textstyle/woe32dll.in.h])

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# autoreconf -ivf
autoreconf: export WARNINGS=
autoreconf: Entering directory '.'
autoreconf: configure.ac: not using Gettext
autoreconf: running: aclocal --force -I m4 -I gnulib-m4
autoreconf: configure.ac: tracing
autoreconf: running: libtoolize --copy --force
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, 'build-aux'.
libtoolize: copying file 'build-aux/ltmain.sh'
libtoolize: putting macros in 'm4'.
libtoolize: copying file 'm4/libtool.m4'
libtoolize: copying file 'm4/ltoptions.m4'
libtoolize: copying file 'm4/ltsugar.m4'
libtoolize: copying file 'm4/ltversion.m4'
libtoolize: copying file 'm4/lt~obsolete.m4'
libtoolize: Consider adding 'AC_CONFIG_MACRO_DIRS([m4])' to configure.ac,
libtoolize: and rerunning libtoolize and aclocal.
autoreconf: configure.ac: not using Intltool
autoreconf: configure.ac: not using Gtkdoc
autoreconf: running: aclocal --force -I m4 -I gnulib-m4
autoreconf: running: /mingw64/bin/autoconf --force
autoreconf: running: /mingw64/bin/autoheader --force
autoreconf: running: automake --add-missing --copy --force-missing
configure.ac:35: installing 'build-aux/compile'
configure.ac:28: installing 'build-aux/missing'
adhoc-tests/Makefile.am: installing 'build-aux/depcomp'
autoreconf: 'build-aux/install-sh' is updated
autoreconf: 'build-aux/config.sub' is updated
autoreconf: 'build-aux/config.guess' is updated
autoreconf: Leaving directory '.'
성공!
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# ./configure

# make
In file included from color.c:23:
color.h:30:33: error: expected ';' before '_Bool'
   30 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |                                 ^
      |                                 ;
color.h:34:33: error: expected ';' before 'enum'
   34 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |                                 ^~~~~
      |                                 ;
color.h:37:33: error: expected ';' before 'const'
   37 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |                                 ^~~~~~
      |                                 ;
make[2]: *** [Makefile:6189: config.h] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/lib' 나감
make[1]: *** [Makefile:2040: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:1939: all] 오류 2

configure.ac 수정
/* Ignore DLL_VARIABLE markup that is meant for gettext.  */
/*#define DLL_VARIABLE 주석처리*/

# autoreconf -ivf
# ./configure --disable-shared --enable-static 
# make
In file included from gl_array_list.c:21:
gl_array_list.h:27:20: error: expected ';' before 'const'
   27 | extern DLL_VARIABLE const struct gl_list_implementation gl_array_list_implementation;
      |                    ^~~~~~
      |                    ;
make[2]: *** [Makefile:6189: config.h] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/lib' 나감
make[1]: *** [Makefile:2039: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:1938: all] 오류 2
config.h
#define DLL_VARIABLE 주석제거

config.h
#undef LIBTEXTSTYLE_DLL_VARIABLE 추가
"C:\libidn2\gettext-0.22.5\libtextstyle\lib\color.h"
/*DLL 주석처리 */
/* Whether to output a test page.  */
extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode; 

/* Color option.  */
enum color_option { color_no, color_tty, color_yes, color_html };
extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;

/* Style to use when coloring.  */
extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;

/* --color argument handling.  Return an error indicator.  */
extern bool handle_color_option (const char *option);

/* --style argument handling.  */
extern void handle_style_option (const char *option);

/* Print a color test page.  */
extern void print_color_test (void);

Makefile.am
# Remove any dynamic library specific rules
# if WOE32DLL
# libtextstyle_la_LDFLAGS = -export-dynamic
# endif

config.h 수정
/* Ignore DLL_VARIABLE markup that is meant for gettext. */
#undef DLL_VARIABLE

/* Remove or comment out any other DLL-related macros */
#undef LIBTEXTSTYLE_DLL_VARIABLE

"C:\libidn2\gettext-0.22.5\libtextstyle\lib\gl_array_list.h"
/* If DLL_VARIABLE is not defined, define it as empty. 추가*/
#ifndef DLL_VARIABLE
#define DLL_VARIABLE
#endif

# make
In file included from error.c:25:
./error.h:549:20: error: expected ';' before 'void'
  549 | extern DLL_VARIABLE void (*error_print_progname) (void);
      |                    ^~~~~
      |                    ;
./error.h:552:20: error: expected ';' before 'unsigned'
  552 | extern DLL_VARIABLE unsigned int error_message_count;
      |                    ^~~~~~~~~
      |                    ;
./error.h:556:20: error: expected ';' before 'int'
  556 | extern DLL_VARIABLE int error_one_per_line;
      |                    ^~~~
      |                    ;
make[2]: *** [Makefile:6189: config.h] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/lib' 나감
make[1]: *** [Makefile:2039: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:1938: all] 오류 2

"C:\libidn2\gettext-0.22.5\libtextstyle\lib\error.h" 
(동적라이브러리로 변경)
configure.ac
LT_INIT([win32-dll]) 
#define DLL_VARIABLE
#include "textstyle/woe32dll.h"
AC_CONFIG_FILES([lib/textstyle/woe32dll.h:lib/textstyle/woe32dll.in.h])

makefile.am
# DLL 추가
# Make sure to link dynamic libraries
lib_LTLIBRARIES = libtextstyle.la
libtextstyle_la_SOURCES = \
    color.c \
    gl_array_list.c

libtextstyle_la_LDFLAGS = -no-undefined
# DLL 추가 끝
#DLL 추가
 if WOE32DLL
 libtextstyle_la_LDFLAGS = -export-dynamic
 endif
# Add the static archive to be installed
#install: all
#	$(INSTALL) -m 755 lib/libtextstyle.a $(prefix)/lib

config.h
/* Ignore DLL_VARIABLE markup that is meant for gettext.  */
/*#define DLL_VARIABLE*/
/* Ensure DLL_VARIABLE is defined as empty if not already defined */
#ifndef DLL_VARIABLE
#define DLL_VARIABLE __declspec(dllexport)
#endif
/* Ignore DLL_VARIABLE markup that is meant for gettext.  */
#define DLL_VARIABLE

/* Get LIBTEXTSTYLE_DLL_VARIABLE.  */
#include "textstyle/woe32dll.h"

error.h
color.h
/*추가시작*/
/* Define LIBTEXTSTYLE_DLL_VARIABLE as empty if building a static library */
#ifndef LIBTEXTSTYLE_DLL_VARIABLE
#define LIBTEXTSTYLE_DLL_VARIABLE __declspec(dllexport)
#endif

/* Color option enumeration */
enum color_option { color_no, color_tty, color_yes, color_html };

/* External variables with DLL export macro */
extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
/*추가끝*/





GNU Autotools 빌드 및 설치 과정

configure.ac 또는 Makefile.am 파일 수정
autoreconf -ivf
 configure.ac, aclocal.m4, Makefile.am 등의 변경 사항을 반영하여 configure 스크립트와 관련 파일을 다시 생성
이 단계에서 automake, autoconf, aclocal 등의 도구가 실행
=>configure.ac 및 Makefile.am 파일의 변경 사항을 기반으로 configure 스크립트와 관련 파일들을 생성

./configure 스크립트 실행
./configure --disable-shared --enable-static #정적라이브러리용
configure.ac에 설정한 대로 컴파일 환경을 설정
시스템의 컴파일러, 라이브러리, 헤더 파일 등을 검사하고, Makefile과 관련 설정 파일을 생성
 설치 경로와 기타 컴파일 옵션을 설정할 수 있다.
=>시스템의 환경을 검사하여 Makefile을 생성, Makefile.in을 기반으로 최종 Makefile이 생성
 필요한 라이브러리와 헤더 파일이 존재하는지 확인하고, 빌드에 필요한 경로와 옵션을 설정

 소스 코드 파일 수정
 src, lib 등의 소스 코드 파일을 수정
소스 코드만 수정했을 때는 autoreconf와 configure를 다시 실행할 필요가 없음
make
Makefile에 따라 소스 코드를 컴파일합니다. 수정한 코드에 따라 실행 파일이나 라이브러리 파일이 재생성

테스트 및 검증
소스 코드 수정 후, 테스트 코드를 추가하거나 수정할 수 있다.
make check
or
make test
프로젝트 내의 테스트 코드를 실행하여 수정된 소스 코드가 제대로 동작하는지 검증

설치
컴파일된 바이너리나 라이브러리를 시스템에 설치
make install

makefile.am 수정
AM_CONDITIONAL([WOE32DLL], [test "$host_os" = "mingw32"])

#DLL 추가
if WOE32DLL
  libtextstyle_la_LDFLAGS += -export-dynamic
endif

configure.ac
#AM_CONDITIONAL([WOE32], [test $is_woe32 = yes])
AM_CONDITIONAL([WOE32DLL], [test "$host_os" = "mingw32"])
AM_CONDITIONAL([WOE32], [test "$host_os" = "mingw32"])
echo "WOE32DLL is set to: $WOE32DLL"
echo "WOE32DLL is set to: $WOE32"

makefile.am
AM_CONDITIONAL([WOE32DLL], [test "$host_os" = "mingw32"])

if WOE32DLL
  libtextstyle_la_LDFLAGS = -no-undefined -export-dynamic
else
  libtextstyle_la_LDFLAGS = -no-undefined
endif

configure.ac
AM_CONDITIONAL([WOE32DLL], [test $host_os = mingw32])
AM_CONDITIONAL([WOE32], [test $host_os = mingw32])
echo "configure.ac : WOE32DLL is set to: $WOE32DLL"
echo "configure.ac : WOE32 is set to: $WOE32"

makefile.am
AM_CONDITIONAL([WOE32DLL], [test $host_os = mingw32])
AM_CONDITIONAL([WOE32], [test $host_os = mingw32])
echo "Makefile.am : WOE32DLL is set to: $WOE32DLL"
echo "Makefile.am : WOE32 is set to: $WOE32"

순차실행 에러만 출력
autoreconf -ivf 2>&1 | grep -Ei 'not|error|오류|undefined|warning' && ./configure 2>&1 | grep -Ei 'not|error|오류|undefined|warning' && make 2>&1 | grep -Ei 'not|error|오류|undefined|warning'
각 명령어출력후 에러 출력
echo "Running: autoreconf -ivf" && autoreconf -ivf 2>&1 | tee autoreconf.log | grep -Ei '멈춤|not|error|오류|undefined|warning' && \
echo "Running: ./configure" && ./configure 2>&1 | tee configure.log | grep -Ei '멈춤|not|error|오류|undefined|warning' && \
echo "Running: make" && make 2>&1 | tee make.log | grep -Ei '멈춤|not|error|오류|undefined|warning' && \
echo "Running: make install" && make install 2>&1 | tee make_install.log | grep -Ei '멈춤|not|error|오류|undefined|warning'

Running: autoreconf -ivf
autoreconf: export WARNINGS=
autoreconf: configure.ac: not using Gettext
autoreconf: configure.ac: not using Intltool
autoreconf: configure.ac: not using Gtkdoc
Running: ./configure
checking for error.h... yes
checking whether C compiler handles -Werror -Wunknown-warning-option... no
checking for C compiler option to inhibit all warnings... -w
checking for a sed that does not truncate output... /usr/bin/sed
checking for error... no
checking whether error_at_line is declared... no
checking whether strerror_r is declared... no
checking whether strerror_r returns char *... no
checking whether strerror(0) succeeds... yes
checking for C compiler option to allow warnings... -Wno-error
checking for C++ compiler option to allow warnings... -Wno-error
/components.xml: line 1: syntax error near unexpected token `newline'
Running: make
Makefile:2522: *** 분리 기호가 빠졌음.  멈춤.
Running: make install
Makefile:2522: *** 분리 기호가 빠졌음.  멈춤.
(디버깅)
/components.xml: line 1: syntax error near unexpected token `newline'
파일 지우고 생성함
touch /components.xml
Makefile:2522: *** 분리 기호가 빠졌음.  멈춤.
Makefile 수정
AM_CONDITIONAL([WOE32DLL], [test $host_os = mingw32])
=>AM_CONDITIONAL([WOE32DLL], [test "$host_os" = "mingw32"])
https://miind.tistory.com/21
1. 분리 기호 (tab) 이 잘 들어가있나 확인한다.
2. 그래도 에러가 나는 경우 .vimrc 에서 에디터 설정을 확인해야한다.
$ cd ~ // 홈 디렉토리로 이동
$ vim .vimrc // 에디터 설정
간혹 편집기가 탭 키를 스페이스로 바꿔버리는 경우가 있다. 
그런 경우 다음과 같은 줄이 있을 것이다.
set expandtab  // tab을 space로 처리
이것을 다음과 같이 바꿔준다
set noexpandtab

nayou@kimnayooung MINGW64 ~
# find / -name ".vimrc" 2>/dev/null
/etc/skel/.vimrc
vim /etc/skel/.vimrc
" 추가
"set expandtab  // tab을 space로 처리
set noexpandtab

# file /components.xml
/components.xml: XML 1.0 document, ASCII text, with CRLF line terminators
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# dos2unix /components.xml
dos2unix: /components.xml 파일을 유닉스 형식으로 변환중...

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# file /components.xml
/components.xml: XML 1.0 document, ASCII text
# export CPLUS_INCLUDE_PATH=/mingw64/include/c++/14.2.0:$CPLUS_INCLUDE_PATH
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <cstring>  // For strerror
#include <cerrno>   // For errno

void convert_ascii_to_utf8(const std::string& input_file, const std::string& output_file) {
    std::cout << "Trying to open input file: " << input_file << std::endl;

    // Open the input file
    std::ifstream infile(input_file, std::ios::binary);
    if (!infile.is_open()) {
        std::cerr << "Error opening input file: " << input_file << std::endl;
        std::cerr << "Error reason: " << std::strerror(errno) << std::endl;
        return;
    }

    // Read the input file into a string
    std::stringstream buffer;
    buffer << infile.rdbuf();
    std::string content = buffer.str();
    infile.close();

    std::cout << "Input file opened successfully." << std::endl;

    // Open the output file
    std::ofstream outfile(output_file, std::ios::binary);
    if (!outfile.is_open()) {
        std::cerr << "Error opening output file: " << output_file << std::endl;
        std::cerr << "Error reason: " << std::strerror(errno) << std::endl;
        return;
    }

    // Write BOM for UTF-8 encoding
    unsigned char bom[] = {0xEF, 0xBB, 0xBF}; // UTF-8 BOM
    outfile.write(reinterpret_cast<char*>(bom), sizeof(bom));

    // Write the content to the output file
    outfile << content;
    outfile.close();

    std::cout << "Output file created successfully." << std::endl;
}

int main() {
    std::string input_file = "C:/msys64/components.xml";       // Absolute path in Windows style
    std::string output_file = "C:/msys64/components_utf8.xml"; // Absolute path in Windows style

    convert_ascii_to_utf8(input_file, output_file);

    return 0;
}

g++ -o encoding_utf8 encoding_utf8.cpp
./encoding_utf8
Trying to open input file: C:/msys64/components.xml
Input file opened successfully.
Output file created successfully.
# file -i /components_utf8.xml
/components_utf8.xml: text/html; charset=utf-8
cp /c/msys64/components_utf8.xml /c/msys64/components.xml
# file -i /components.xml
/components.xml: text/html; charset=utf-8

vscode에서 tab을 space로 변환 그반대도 제공하고 아예 off할 수 있다고 함
File > Preferences > Settings
검색창에 detect indentation을 입력
Editor: Detect Indentation 설정을 찾아 체크박스를 비활성화
insert spaces 검색 > Editor: Insert Spaces 비활성

VS Code에서 파일을 열고 
Ctrl + Shift + P를 눌러 Command Palette를 열고 Convert Indentation to Tabs

xml newline 에러
https://ant.apache.org/bindownload.cgi
C:\Users\nayou\Downloads\apache-ant-1.10.15-bin\apache-ant-1.10.15
C:\apache-ant-1.10.15 이동
환경변수설정
ANT_HOEM : C:\apache-ant-1.10.15
Path : %ANT_HOME%\bin
# export ANT_HOME=/c/apache-ant-1.10.15
# export PATH=$ANT_HOME/bin:$PATH
# java -version
java version "21.0.4" 2024-07-16 LTS
Java(TM) SE Runtime Environment (build 21.0.4+8-LTS-274)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.4+8-LTS-274, mixed mode, sharing)
ant는 build.xml 전용으로
아래 xmllint로 하기로
# xmllint --noout /components.xml
/components.xml:1: parser error : Start tag expected, '<' not found
<?xml version="1.0" encoding="UTF-8"?>
   ^ㅣ
vscode에서 하단 오른쪽에 Encoding 을 누르면 상단 가운데에 save with encoding을 누르면 
원하는 encoding을 선택하면 그 선택한 encoding으로 저장됨
nayou@kimnayooung MINGW64 /c/libidn2
# xmllint --noout /components.xml

nayou@kimnayooung MINGW64 /c/libidn2
# file -i /components.xml
/components.xml: text/xml; charset=utf-8
# head -n 10 /components.xml
<?xml version="1.0" encoding="UTF-8"?>
<root>
<Packages>
    <ApplicationName>MSYS2</ApplicationName>
    <ApplicationVersion>1.0.0</ApplicationVersion>
    <Package>
        <Name>com.msys2.root</Name>
        <Title>MSYS2</Title>
        <Description>Cygwin-derived Posix-like env. for Windows with Arch Linux's Pacman</Description>
        <SortingPriority>0</SortingPriority>
다시 실행
echo "Running: autoreconf -ivf" && autoreconf -ivf 2>&1 | tee autoreconf.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq  && \
echo "Running: ./configure" && ./configure 2>&1 | tee configure.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq  && \
echo "Running: make" && make 2>&1 | tee make.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq && \
echo "Running: make install" && make install 2>&1 | tee make_install.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq 

nayou@kimnayooung MINGW64 ~
# autoconf --version
autoconf (GNU Autoconf) 2.72
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+/Autoconf: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>, <https://gnu.org/licenses/exceptions.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille.

nayou@kimnayooung MINGW64 ~
# ^C

nayou@kimnayooung MINGW64 ~
# automake --version
automake (GNU automake) 1.17
Features: subsecond-mtime

Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later
  <https://gnu.org/licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Tom Tromey <tromey@redhat.com>
       and Alexandre Duret-Lutz <adl@gnu.org>.

nayou@kimnayooung MINGW64 ~
# ^C

nayou@kimnayooung MINGW64 ~
# cd /c/libidn2

nayou@kimnayooung MINGW64 /c/libidn2
# cd gettext-0.22.5/libtextstyle/

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# rm -f configure aclocal.m4 config.log config.status

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# aclocal

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# autoconf

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# automake --add-missing
lib/Makefile.am:48: error: INCLUDED_LIBXML does not appear in AM_CONDITIONAL
lib/Makefile.gnulib:104: error: GL_GENERATE_ALLOCA_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:132: error: GL_GENERATE_ASSERT_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:218: error: GL_COND_OBJ_CLOSE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:234: error: GL_COND_OBJ_DUP2 does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:246: error: GL_GENERATE_ERRNO_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:274: error: GL_COND_OBJ_ERROR does not appear in AM_CONDITIONAL

Makefile.am과 Makefile.gnulib 파일에서 조건부 빌드 설정(AM_CONDITIONAL)이 누락되었음
gnulib-tool을 사용하여 gnulib 모듈 재생성
gnulib 라이브러리와의 통합 과정에서 발생할 수 있으며, 이는 Makefile에서 조건부 정의가 필요한 상황에서 발생
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# gnulib-tool --add-import
-bash: gnulib-tool: 명령어를 찾을 수 없음
Gnulib 설치
nayou@kimnayooung MINGW64 /c
# git clone https://git.savannah.gnu.org/git/gnulib.git
'gnulib'에 복제합니다...
remote: Counting objects: 308524, done.
remote: Compressing objects: 100% (35319/35319), done.
remote: Total 308524 (delta 273515), reused 307924 (delta 273093)
오브젝트를 받는 중: 100% (308524/308524), 81.11 MiB | 3.18 MiB/s, 완료.
델타를 알아내는 중: 100% (273515/273515), 완료.
Updating files: 100% (11851/11851), 완료.
export PATH=$PATH:/c/gnulib
Gnulib 통합
nayou@kimnayooung MINGW64 /c/gnulib
cd /c/libidn2/gettext-0.22.5/libtextstyle
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# /c/gnulib/gnulib-tool --add-import
autoreconf 및 automake 재실행
configure.ac 수정
#추가
gl_INIT
gl_EARLY

Makefile.am 수정
EXTRA_DIST m4/gnulib-cache.m4 \ #추가

/c/gnulib/gnulib-tool --add-import 자동복사가 안돼서 수동으로 복사
cp /c/gnulib/m4 /c/libidn2/gettext-0.22.5/libtextstyle/m4

echo "Running: autoreconf -ivf" && autoreconf -ivf 2>&1 | tee autoreconf.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq  && \
echo "Running: ./configure" && ./configure 2>&1 | tee configure.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq  && \
echo "Running: make" && make 2>&1 | tee make.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq && \
echo "Running: make install" && make install 2>&1 | tee make_install.log | grep -Ei '멈춤|not|error|오류|undefined|warning' | sort | uniq 

xml파일 encoding 
/c/libidn2/gettext-0.22.5/libtextstyle>
#./encoding_utf8 
#cp /components_utf8.xml /components.xml
#file -i /components.xml
=>utf-8
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# xmllint --noout /c/msys64/components.xml

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
#
계속적으로 
/components.xml: line 1: syntax error near unexpected token `newline'
/components.xml: line 1: `﻿<?xml version="1.0" encoding="UTF-8"?>'
오류발생

"C:\msys64\mingw64\include\c++\14.2.0\cstdlib"
//#include_next <stdlib.h>
#include <stdlib.h>
C:/msys64/mingw64/include/c++/14.2.0/bits/std_abs.h
//#include_next <stdlib.h>
#include <stdlib.h>
수정 후 
# g++ -o encoding_utf8 encoding_utf8.cpp
# ./encoding_utf8
Trying to open input file: C:/msys64/components.xml
Input file opened successfully.
Output file created successfully.
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# file -i /components_utf8.xml
/components_utf8.xml: text/xml; charset=utf-8
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# cp /components_utf8.xml /components.xml
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# file -i /components.xml
/components.xml: text/xml; charset=utf-8
# autoreconf -ivf
# ./configure

configure.ac
# 호스트 OS 확인
AC_CANONICAL_HOST
echo "configure.ac: Configured host OS: $host_os"

# 조건부 매크로 정의
if test "$host_os" = "mingw32"; then
    AM_CONDITIONAL([WOE32DLL], true)
    AM_CONDITIONAL([WOE32], true)
    echo "WOE32DLL and WOE32 are enabled."
	LDFLAGS="-no-undefined -export-dynamic"
else
    AM_CONDITIONAL([WOE32DLL], false)
    AM_CONDITIONAL([WOE32], false)
    echo "WOE32DLL and WOE32 are disabled."
	LDFLAGS="-no-undefined"
fi

makefile.am
libtextstyle_la_LDFLAGS = $(LDFLAGS)
Makefile:2425: *** 분리 기호가 빠졌음.  멈춤. => 성공

(에러)
./stddef.h:133:6: error: operator '!' has no right operand
  133 | #if !
/c/libidn2/gettext-0.22.5/libtextstyle/lib/stddef.h 수정
/*#if !
# define wchar_t int
#endif*/
#ifndef wchar_t
# define wchar_t int
#endif

lib/stddef.h를 생성하는 파일을 수정하기로함
# find /c/libidn2/gettext-0.22.5/libtextstyle/ -maxdepth 1 -type f -exec grep -nH "#if !" {} +
/c/libidn2/gettext-0.22.5/libtextstyle/config.h:1179:#if !(defined __STDC_WANT_LIB_EXT1__ && __STDC_WANT_LIB_EXT1__)
/c/libidn2/gettext-0.22.5/libtextstyle/config.h:1825:#if !(defined _GL_ATTRIBUTE_ERROR && defined _GL_ATTRIBUTE_WARNING)
/c/libidn2/gettext-0.22.5/libtextstyle/config.h:2309:#if !defined HAVE_C_ALIGNASOF \
/c/libidn2/gettext-0.22.5/libtextstyle/config.h.in:1178:#if !(defined __STDC_WANT_LIB_EXT1__ && __STDC_WANT_LIB_EXT1__)
...
생성하는 파일인거 같은 파일을 찾아 수정 
configure.ac configure 스크립트를 생성하는 메타 파일
 이 파일에서 config.h의 내용을 결정짓는 매크로를 설정
# if ! 방지용
# Check for wchar_t type
AC_CHECK_TYPE([wchar_t], 
    [AC_DEFINE([HAVE_WCHAR_T], [1], [Define to 1 if you have the `wchar_t` type])], 
    [AC_DEFINE([HAVE_WCHAR_T], [0], [Define to 0 if you do not have the `wchar_t` type])])
수정 후
aclocal을 실행하여 aclocal.m4 파일을 업데이트
aclocal
autoconf를 실행하여 configure 스크립트를 생성하거나 업데이트
autoconf
configure 스크립트를 실행하여 config.h 파일을 생성
./configure
config.h 파일이 생성되고, HAVE_WCHAR_T가 정의된 상태로 확인
/* Define if you have wchar_t */
#define HAVE_WCHAR_T 1

configure: creating ./config.status
config.status: creating Makefile
config.status: creating doc/Makefile
config.status: creating lib/Makefile
config.status: creating lib/exported.sh
config.status: creating lib/textstyle/version.h
config.status: creating lib/textstyle/woe32dll.h
config.status: creating tests/Makefile
config.status: creating adhoc-tests/Makefile
config.status: creating config.h
config.status: executing depfiles commands
config.status: executing libtool commands

# make
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# make
 cd . && /bin/sh /c/libidn2/gettext-0.22.5/libtextstyle/build-aux/missing automake-1.16 --gnu
Makefile.am:49: warning: whitespace following trailing backslash
lib/Makefile.am:48: error: INCLUDED_LIBXML does not appear in AM_CONDITIONAL
lib/Makefile.gnulib:104: error: GL_GENERATE_ALLOCA_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:132: error: GL_GENERATE_ASSERT_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:218: error: GL_COND_OBJ_CLOSE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:234: error: GL_COND_OBJ_DUP2 does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:246: error: GL_GENERATE_ERRNO_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:274: error: GL_COND_OBJ_ERROR does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:320: error: GL_COND_OBJ_FCNTL does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:442: error: GL_GENERATE_FLOAT_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:459: error: GL_COND_OBJ_FLOAT does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:462: error: GL_COND_OBJ_ITOLD does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:479: error: GL_COND_OBJ_FREE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:505: error: GL_COND_OBJ_FSTAT does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:517: error: GL_COND_OBJ_FSYNC does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:562: error: GL_COND_OBJ_GETDTABLESIZE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:570: error: GL_COND_OBJ_GETHOSTNAME does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:580: error: GL_COND_OBJ_GETPROGNAME does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:596: error: GL_COND_OBJ_GETTIMEOFDAY does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:762: error: GL_COND_OBJ_ISATTY does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:770: error: GL_COND_OBJ_ISINF does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:834: error: INCLUDED_LIBCROCO does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:873: error: GL_COND_LIBTOOL does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:885: error: INCLUDED_LIBGLIB does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:984: error: GL_COND_LIBTOOL does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:996: error: INCLUDED_LIBXML does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1439: error: GL_COND_LIBTOOL does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1455: error: GL_GENERATE_LIMITS_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1489: error: GL_COND_OBJ_LOG10 does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1859: error: GL_COND_OBJ_MEMCHR does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1914: error: GL_COND_OBJ_MSVC_INVAL does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1924: error: GL_COND_OBJ_MSVC_NOTHROW does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1967: error: GL_GENERATE_OBSTACK_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1979: error: GL_COND_OBJ_OBSTACK does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:1989: error: GL_COND_OBJ_OPEN does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2051: error: GL_COND_OBJ_RAISE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2059: error: GL_COND_OBJ_READ does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2085: error: GL_COND_OBJ_REALLOCARRAY does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2117: error: GL_COND_OBJ_SIGACTION does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2168: error: GL_COND_OBJ_SIGNBIT3 does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2178: error: GL_COND_OBJ_SIGPROCMASK does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2257: error: GL_COND_OBJ_STAT does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2281: error: GL_GENERATE_STDARG_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2307: error: GL_GENERATE_STDCKDINT_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2328: error: GL_GENERATE_STDDEF_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2357: error: GL_GENERATE_STDINT_H does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2537: error: GL_COND_OBJ_STDIO_READ does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2540: error: GL_COND_OBJ_STDIO_WRITE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2718: error: GL_COND_OBJ_STPCPY does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2726: error: GL_COND_OBJ_STRERROR does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:2734: error: GL_COND_OBJ_STRERROR_OVERRIDE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3484: error: LIBUNISTRING_COMPILE_UNISTR_U8_MBTOUC does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3674: error: GL_COND_OBJ_WINDOWS_MUTEX does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3684: error: GL_COND_OBJ_WINDOWS_ONCE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3694: error: GL_COND_OBJ_WINDOWS_RECMUTEX does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3704: error: GL_COND_OBJ_WINDOWS_RWLOCK does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.gnulib:3714: error: GL_COND_OBJ_WRITE does not appear in AM_CONDITIONAL
lib/Makefile.am:63:   'lib/Makefile.gnulib' included from here
lib/Makefile.am:201: error: INCLUDED_LIBCROCO does not appear in AM_CONDITIONAL
lib/Makefile.am:204: error: INCLUDED_LIBXML does not appear in AM_CONDITIONAL
lib/Makefile.am:207: error: INCLUDED_LIBGLIB does not appear in AM_CONDITIONAL
make: *** [Makefile:1997: Makefile.in] 오류 1

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# automake --version
autoconf --version
automake (GNU automake) 1.16.5
Copyright (C) 2021 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later <https://gnu.org/licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Tom Tromey <tromey@redhat.com>
       and Alexandre Duret-Lutz <adl@gnu.org>.
autoconf (GNU Autoconf) 2.72
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+/Autoconf: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>, <https://gnu.org/licenses/exceptions.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille.

configure.ac
# 추가
AM_CONDITIONAL([INCLUDED_LIBXML], [test "x$have_libxml" = "xyes"])

#추가
# Check for gnulib modules
GL_GNU_SOURCE
GL_REQUIRE_VERSION([2.0])

gnulib 모듈 업데이트
export PATH=$PATH:/c/gnulib
nayou@kimnayooung MINGW64 /c/gnulib
# gnulib-tool --update
1 out of 1 hunk FAILED -- saving rejects to file C:/msys64/tmp/glpy7noks9h3/lib/exitfail.h.rej
C:/gnulib/gnulib-tool.py: *** patch file lib/exitfail.h didn't apply cleanly
C:/gnulib/gnulib-tool.py: *** Stop.
gnulib 최신 버전으로 업데이트
cd /c/gnulib
git pull origin master

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# gnulib-tool --import
# make
CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh '/c/libidn2/gettext-0.22.5/libtextstyle/build-aux/missing' aclocal-1.16 -I m4 -I gnulib-m4
 cd . && /bin/sh /c/libidn2/gettext-0.22.5/libtextstyle/build-aux/missing automake-1.16 --gnu
Makefile.am:54: warning: whitespace following trailing backslash
CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh '/c/libidn2/gettext-0.22.5/libtextstyle/build-aux/missing' autoconf
configure.ac:77: warning: AC_COMPILE_IFELSE was called before AC_USE_SYSTEM_EXTENSIONS
gnulib-m4/gnulib-comp.m4:34: lts_EARLY is expanded from...
configure.ac:77: the top level
configure.ac:77: warning: AC_CHECK_INCLUDES_DEFAULT was called before AC_USE_SYSTEM_EXTENSIONS
gnulib-m4/gnulib-comp.m4:34: lts_EARLY is expanded from...
configure.ac:77: the top level
/bin/sh ./config.status --recheck
running CONFIG_SHELL=/bin/sh /bin/sh ./configure CC=/mingw64/bin/gcc CFLAGS=-I/mingw64/include LDFLAGS=-L/mingw64/lib CPPFLAGS=-I/mingw64/include CPP=/mingw64/bin/cpp --no-create --no-recursion
configure: loading site script /etc/config.site
./configure: line 4901: GL_GNU_SOURCE: command not found
./configure: line 4902: syntax error near unexpected token `2.0'
./configure: line 4902: `GL_REQUIRE_VERSION(2.0)'
make: *** [Makefile:2020: config.status] 오류 2
configure:4678: error: possibly undefined macro: gl_CC_GNULIB_WARNINGS
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
configure:4699: error: possibly undefined macro: gl_COMMON
configure:4744: error: possibly undefined macro: gl_PROG_AR_RANLIB
autoreconf: error: /mingw64/bin/autoconf failed with exit status: 1

configure:4678: error: possibly undefined macro: gl_CC_GNULIB_WARNINGS
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
configure:4699: error: possibly undefined macro: gl_COMMON
configure:4744: error: possibly undefined macro: gl_PROG_AR_RANLIB
autoreconf: error: /mingw64/bin/autoconf failed with exit status: 1

#추가
# 먼저 시스템 확장 기능을 활성화합니다.
AC_USE_SYSTEM_EXTENSIONS
# 그 다음에 기본 헤더 파일을 체크합니다.
AC_CHECK_INCLUDES_DEFAULT

configure.ac
#추가
# Allow usage of specific macros if they are not yet recognized
m4_pattern_allow([gl_CC_GNULIB_WARNINGS])
m4_pattern_allow([gl_COMMON])
m4_pattern_allow([gl_PROG_AR_RANLIB])

aclocal.m4 파일을 업데이트
m4 매크로 파일을 포함하여 configure 스크립트를 생성
# aclocal
# autoreconf -ivf
# ./configure
configure: loading site script /etc/config.site
./configure: line 4678: gl_CC_GNULIB_WARNINGS: command not found
./configure: line 4699: gl_COMMON: command not found
./configure: line 4721: gl_COMMON: command not found
./configure: line 4744: gl_PROG_AR_RANLIB: command not found
./configure: line 4981: syntax error near unexpected token `2.0'
./configure: line 4981: `GL_REQUIRE_VERSION(2.0)'

configure.ac 수정
GL_REQUIRE_VERSION"([2.0])"

#make
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/adhoc-tests' 들어감
/mingw64/bin/gcc -DHAVE_CONFIG_H -I. -I..  -I. -I. -I.. -I../lib -I./../lib -DSRCDIR=\"./\" -I/mingw64/include  -I/mingw64/include -MT hello.o -MD -MP -MF .deps/hello.Tpo -c -o hello.o hello.c
In file included from ../lib/textstyle.h:23,
                 from hello.c:20:
../lib/stddef.h:133:6: error: operator '!' has no right operand
  133 | #if !
      |      ^
In file included from ../config.h:2463,
                 from hello.c:18:
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle/version.h:32:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
   32 | extern LIBTEXTSTYLE_DLL_VARIABLE const int _libtextstyle_version; /* Likewise */
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle/version.h:32:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
   32 | extern LIBTEXTSTYLE_DLL_VARIABLE const int _libtextstyle_version; /* Likewise */
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:621:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  621 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:621:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  621 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:625:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  625 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:625:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  625 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:628:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  628 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:628:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  628 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
make[2]: *** [Makefile:1832: hello.o] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/adhoc-tests' 나감
make[1]: *** [Makefile:2129: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:2003: all] 오류 2

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# rm -rf autom4te.cache
# autoreconf -ivf
# ./configure
# make
CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh '/c/libidn2/gettext-0.22.5/libtextstyle/build-aux/missing' aclocal-1.16 -I m4 -I gnulib-m4
configure.ac:22: error: AC_INIT should be called with package and version arguments
/usr/share/aclocal-1.16/init.m4:29: AM_INIT_AUTOMAKE is expanded from...
configure.ac:22: the top level
autom4te: error: /usr/bin/m4 failed with exit status: 1
aclocal-1.16: error: autom4te failed with exit status: 1
make: *** [Makefile:2039: aclocal.m4] 오류 1
configure.ac 수정
최상단(아래순서대로작성해야함)
AC_PREREQ([2.64])
AC_INIT([libtextstyle], [0.1], [bug-libtextstyle@example.com])
AM_INIT_AUTOMAKE([1.13 silent-rules]) #추가
AC_CONFIG_HEADERS([config.h])
#autoreconf -ivf
../lib/stddef.h:107:3: error: #error "Please include config.h first."
  107 |  #error "Please include config.h first."
      |   ^~~~~
../lib/stddef.h:133:6: error: operator '!' has no right operand
  133 | #if !
      |      ^
In file included from ../lib/textstyle.h:24:
../lib/stdio.h:71:3: error: #error "Please include config.h first."
   71 |  #error "Please include config.h first."
      |   ^~~~~
In file included from ../lib/stdio.h:82:
../lib/sys/types.h:28:3: error: #error "Please include config.h first."
   28 |  #error "Please include config.h first."
      |   ^~~~~
In file included from ../lib/textstyle.h:26:
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle/version.h:32:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
   32 | extern LIBTEXTSTYLE_DLL_VARIABLE const int _libtextstyle_version; /* Likewise */
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle/version.h:32:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
   32 | extern LIBTEXTSTYLE_DLL_VARIABLE const int _libtextstyle_version; /* Likewise */
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
In file included from ../lib/textstyle.h:29:
../lib/textstyle/version.h:32:34: error: expected ';' before 'const'
   32 | extern LIBTEXTSTYLE_DLL_VARIABLE const int _libtextstyle_version; /* Likewise */
      |                                  ^~~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:621:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  621 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:621:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  621 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
In file included from ../lib/textstyle/stdbool.h:4,
                 from ../lib/textstyle.h:25:
../lib/textstyle.h:621:34: error: expected ';' before '_Bool'
  621 | extern LIBTEXTSTYLE_DLL_VARIABLE bool color_test_mode;
      |                                  ^~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:625:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  625 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:625:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  625 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle.h:625:34: error: expected ';' before 'enum'
  625 | extern LIBTEXTSTYLE_DLL_VARIABLE enum color_option color_mode;
      |                                  ^~~~
../lib/textstyle/woe32dll.h:27:36: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                    ^
../lib/textstyle.h:628:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  628 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle/woe32dll.h:27:49: error: stray '@' in program
   27 | # define LIBTEXTSTYLE_DLL_VARIABLE @DLL_VARIABLE@
      |                                                 ^
../lib/textstyle.h:628:8: note: in expansion of macro 'LIBTEXTSTYLE_DLL_VARIABLE'
  628 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |        ^~~~~~~~~~~~~~~~~~~~~~~~~
../lib/textstyle.h:628:34: error: expected ';' before 'const'
  628 | extern LIBTEXTSTYLE_DLL_VARIABLE const char *style_file_name;
      |                                  ^~~~~
In file included from C:/msys64/mingw64/include/io.h:10,
                 from ../lib/textstyle.h:687:
../lib/string.h:52:3: error: #error "Please include config.h first."
   52 |  #error "Please include config.h first."
      |   ^~~~~
In file included from C:/msys64/mingw64/include/sec_api/stdlib_s.h:9,
                 from C:/msys64/mingw64/include/stdlib.h:658,
                 from ../lib/stdlib.h:36,
                 from hello.c:23:
../lib/stdlib.h:45:3: error: #error "Please include config.h first."
   45 |  #error "Please include config.h first."
      |   ^~~~~
In file included from C:/msys64/mingw64/include/process.h:13,
                 from C:/msys64/mingw64/include/unistd.h:11,
                 from ../lib/unistd.h:40,
                 from hello.c:25:
../lib/sys/types.h:28:3: error: #error "Please include config.h first."
   28 |  #error "Please include config.h first."
      |   ^~~~~
In file included from C:/msys64/mingw64/include/unistd.h:50:
../lib/sys/types.h:28:3: error: #error "Please include config.h first."
   28 |  #error "Please include config.h first."
      |   ^~~~~
../lib/unistd.h:76:3: error: #error "Please include config.h first."
   76 |  #error "Please include config.h first."
      |   ^~~~~
In file included from ../lib/unistd.h:165:
../lib/sys/types.h:28:3: error: #error "Please include config.h first."
   28 |  #error "Please include config.h first."
      |   ^~~~~
../lib/unistd.h:717:24: error: expected ';' before 'extern'
  717 | _GL_INLINE_HEADER_BEGIN
      |                        ^
      |                        ;
../lib/unistd.h:2953:22: error: expected ';' before 'int'
 2953 | _GL_INLINE_HEADER_END
      |                      ^
      |                      ;
make[2]: *** [Makefile:396: hello.o] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/adhoc-tests' 나감
make[1]: *** [Makefile:692: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:566: all] 오류 2

=> 모든 .c, .h, .in.h 파일에 최상단에 #include "config.h" 를 추가해줘야함 

auto_include_config_h.sh생성
#!/bin/bash

# 현재 디렉토리와 하위 디렉토리에서 .c 및 .h 파일 찾기
find . -name '*.c' -o -name '*.h' | while read -r file; do
  # 파일의 첫 번째 줄에 #include "config.h"가 포함되어 있는지 확인
  if grep -q '#include "config.h"' "$file"; then
    echo "$file에는 이미 #include \"config.h\"가 포함되어 있습니다."
  else
    echo "$file에 #include \"config.h\"를 추가합니다."
    # 임시 파일을 생성하여 #include "config.h"를 추가
    temp_file=$(mktemp)
    echo '#include "config.h"' > "$temp_file"
    cat "$file" >> "$temp_file"
    mv "$temp_file" "$file"
  fi
done

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# chmod +x auto_include_config_h.sh
# ./auto_include_config_h.sh
...
./lib/xvasprintf.h에 #include "config.h"를 추가합니다.
./lib/_Noreturn.h에 #include "config.h"를 추가합니다.
./tests/arg-nonnull.h에 #include "config.h"를 추가합니다.
./tests/c++defs.h에 #include "config.h"를 추가합니다.
./tests/dummy.c에 #include "config.h"를 추가합니다.
./tests/test-accessors.c에 #include "config.h"를 추가합니다.
./tests/test-instanceof.c에 #include "config.h"를 추가합니다.
./tests/test-memory-ostream.c에 #include "config.h"를 추가합니다.
./tests/test-term-ostream.c에 #include "config.h"를 추가합니다.
...

#make
./configure: line 6805: syntax error near unexpected token `('
./configure: line 6805: `    DLL_VARIABLE=__declspec(dllexport)'
make: *** [Makefile:596: config.status] 오류 2

configure.ac 수정
# Windows-specific settings for mingw and Cygwin
case "$host_os" in
  mingw* | cygwin*) 
    is_woe32=yes
    ;;
  *) 
    is_woe32=no
    ;;
esac

if test "$is_woe32" = "yes"; then
    AM_CONDITIONAL([WOE32DLL], true)
    AM_CONDITIONAL([WOE32], true)
    echo "WOE32DLL and WOE32 are enabled."
    LDFLAGS="-no-undefined -export-dynamic"
    AC_SUBST([DLL_VARIABLE], [__declspec(dllexport)])
else
    AM_CONDITIONAL([WOE32DLL], false)
    AM_CONDITIONAL([WOE32], false)
    echo "WOE32DLL and WOE32 are disabled."
    LDFLAGS="-no-undefined"
    AC_SUBST([DLL_VARIABLE], [])
fi

#make
checking for /mingw64/bin/gcc option to enable C23 features... (cached) unupported
checking for /mingw64/bin/gcc option to enable C11 features... (cached) noe needed
checking dependency style of /mingw64/bin/gcc... (cached) gcc3
checking how to run the C preprocessor... /mingw64/bin/cpp
checking build system type... x86_64-w64-mingw32
checking host system type... x86_64-w64-mingw32
configure.ac: Configured host OS: mingw32
./configure: line 6805: syntax error near unexpected token `('
./configure: line 6805: `    DLL_VARIABLE=__declspec(dllexport)'

#configure.ac 수정
# Read version number from version.sh
. $srcdir/version.sh
gl_INIT_PACKAGE([libtextstyle], [$VERSION_NUMBER])
# Initialize Automake (위치변경)
AM_INIT_AUTOMAKE([1.13 silent-rules])
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# autoconf
# autoreconf -ivf
# ./configure
# make
../lib/stddef.h:108:3: error: #error "Please include config.h first."
  108 |  #error "Please include config.h first."
      |   ^~~~~
../lib/stddef.h:134:6: error: operator '!' has no right operand
  134 | #if !
      |      ^
....
configure.ac 수정
AC_DEFINE([_GL_CONFIG_H_INCLUDED], [1], [Define to prevent multiple inclusion])

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep -r -l "Some platforms lack wchar_t" .                             
./lib/stddef.h
./lib/stddef.in.h

c:\libidn2\gettext-0.22.5\libtextstyle>findstr /s /m /c:"Some platforms lack wchar_t" *.*
lib\stddef.h
lib\stddef.in.h

/c/libidn2/gettext-0.22.5/libtextstyle/configure.ac
# Check for wchar_t type
AC_CHECK_TYPE([wchar_t],
  [AC_DEFINE([HAVE_WCHAR_T], [1], [Define to 1 if you have wchar_t])],
  [AC_DEFINE([HAVE_WCHAR_T], [0], [Define to 0 if you do not have wchar_t])]
)

/c/libidn2/gettext-0.22.5/libtextstyle/lib/stddef.h
/* Some platforms lack wchar_t.  */
#if !
# define wchar_t int
#endif

/c/libidn2/gettext-0.22.5/libtextstyle/lib/stddef.in.h
/* Some platforms lack wchar_t.  */
#if !@HAVE_WCHAR_T@
# define wchar_t int
#endif

결론)
stddef.h
/* Some platforms lack wchar_t.  */
/*#if !
# define wchar_t int
#endif*/

stddef.in.h
/* Some platforms lack wchar_t.  */
/*#if !@HAVE_WCHAR_T@
# define wchar_t int
#endif*/

/* Some platforms lack wchar_t.  */
/*#if !@HAVE_WCHAR_T@
  #define wchar_t int
#endif*/

# autoreconf -ivf && ./configure && make
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/doc' 들어감
make[2]: 'all'을(를) 위해 할 일이 없습니다.
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/doc' 나감
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 들어감
make[2]: *** 'color.lo'에서 필요한 'color.c' 타겟을 만들 규칙이 없습니다.  멈춤.
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make[1]: *** [Makefile:694: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:568: all] 오류 2

파일확인
"C:\libidn2\gettext-0.22.5\libtextstyle\lib\color.h"
"C:\libidn2\gettext-0.22.5\libtextstyle\lib\color.c"

Makefile.in
AUTOMAKE_OPTIONS = 1.13 gnu no-dependencies subdir-objects
libtextstyle_la_SOURCES = \
	color.c \
	gl_array_list.c
AUTOCONF = @AUTOCONF@
	$(am__cd) $(srcdir) && $(AUTOCONF)

Makefile.am
AUTOMAKE_OPTIONS = 1.13 gnu no-dependencies subdir-objects
libtextstyle_la_SOURCES = \
	color.c \
	gl_array_list.c 
AUTOCONF 없음

configure.ac
AC_CONFIG_SRCDIR([lib/color.c])

(수정)
Makefile.in
libtextstyle_la_SOURCES = \
	lib/color.c \
	lib/gl_array_list.c 

Makefile.am
libtextstyle_la_SOURCES = \
	lib/color.c \
	lib/gl_array_list.c

configure.ac
없음

# autoreconf -ivf && ./configure && make
(오류)
lib/color.h:49:6: error: redeclaration of 'enum color_option'
   49 | enum color_option { color_no, color_tty, color_yes, color_html };
      |      ^~~~~~~~~~~~
lib/color.h:36:6: note: originally defined here
   36 | enum color_option { color_no, color_tty, color_yes, color_html };
      |      ^~~~~~~~~~~~
lib/color.h:49:21: error: redeclaration of enumerator 'color_no'
   49 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                     ^~~~~~~~
lib/color.h:36:21: note: previous definition of 'color_no' with type 'enum color_option'
   36 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                     ^~~~~~~~
lib/color.h:49:31: error: redeclaration of enumerator 'color_tty'
   49 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                               ^~~~~~~~~
lib/color.h:36:31: note: previous definition of 'color_tty' with type 'enum color_option'
   36 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                               ^~~~~~~~~
lib/color.h:49:42: error: redeclaration of enumerator 'color_yes'
   49 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                                          ^~~~~~~~~
lib/color.h:36:42: note: previous definition of 'color_yes' with type 'enum color_option'
   36 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                                          ^~~~~~~~~
lib/color.h:49:53: error: redeclaration of enumerator 'color_html'
   49 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                                                     ^~~~~~~~~~
lib/color.h:36:53: note: previous definition of 'color_html' with type 'enum color_option'
   36 | enum color_option { color_no, color_tty, color_yes, color_html };
      |                                                     ^~~~~~~~~~
In file included from term-ostream.oo.h:65,
                 from lib/color.c:32:
lib/term-style-control.h:86:3: error: expected specifier-qualifier-list before '_GL_ASYNC_SAFE'
   86 |   _GL_ASYNC_SAFE void (*async_restore) (struct term_style_user_data *);
      |   ^~~~~~~~~~~~~~
In file included from lib/color.c:35:
lib/concat-filename.h: In function 'concatenated_filename':
lib/concat-filename.h:38:3: error: unknown type name '_GL_ATTRIBUTE_MALLOC'
   38 |   _GL_ATTRIBUTE_MALLOC _GL_ATTRIBUTE_DEALLOC_FREE;
      |   ^~~~~~~~~~~~~~~~~~~~
lib/concat-filename.h:44:3: error: expected '=', ',', ';', 'asm' or '__attribute__' before '_GL_ATTRIBUTE_MALLOC'
   44 |   _GL_ATTRIBUTE_MALLOC _GL_ATTRIBUTE_DEALLOC_FREE
      |   ^~~~~~~~~~~~~~~~~~~~
lib/color.c:42:6: error: parameter 'color_mode' is initialized
   42 | enum color_option color_mode = color_tty;
      |      ^~~~~~~~~~~~
lib/color.c:50:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   50 | {
      | ^
lib/color.c:78:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   78 | {
      | ^
lib/color.c:85:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   85 | {
      | ^
lib/color.c:391:1: error: expected '=', ',', ';', 'asm' or '__attribute_
' before '{' token
  391 | {
      | ^
lib/color.c:423:1: error: expected '=', ',', ';', 'asm' or '__attribute_
' before '{' token
  423 | {
      | ^
lib/concat-filename.h:36:14: error: old-style parameter declarations in prototyped function definition
   36 | extern char *concatenated_filename (const char *directory,
      |              ^~~~~~~~~~~~~~~~~~~~~
lib/color.c:451: error: expected '{' at end of input
make[2]: *** [Makefile:684: lib/color.lo] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make[1]: *** [Makefile:703: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:569: all] 오류 2

(수정)
lib/color.h
enum color_option { color_no, color_tty, color_yes, color_html };
중복정의되어있어 하나 삭제

lib/term_style_control.h
_GL_ASYNC_SAFE 선언이있는지 확인
선언이 없어서 검색
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep -r -n "define _GL_ASYNC_SAFE" .
./autom4te.cache/traces.0:24717:#define _GL_ASYNC_SAFE
./autom4te.cache/traces.3:4260:#define _GL_ASYNC_SAFE
./gnulib-m4/gnulib-common.m4:883:#define _GL_ASYNC_SAFE
./gnulib-m4/gnulib-common.m4~:616:#define _GL_ASYNC_SAFE
./m4/gnulib-common.m4:883:#define _GL_ASYNC_SAFE
config.h 수정
/* Define _GL_ASYNC_SAFE lib/term_style_control.h 필요 */
#ifndef _GL_ASYNC_SAFE
#define _GL_ASYNC_SAFE
#endif

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep -r -n -E "#define _GL_ATTRIBUTE_MALLOC|#define _GL_ATTRIBUTE_DEALLOC_FREE" .
찾을수없음
config.h 수정
#ifndef _GL_ATTRIBUTE_MALLOC
#define _GL_ATTRIBUTE_MALLOC /* 정의할 내용 */
#endif

#ifndef _GL_ATTRIBUTE_DEALLOC_FREE
#define _GL_ATTRIBUTE_DEALLOC_FREE /* 정의할 내용 */
#endif

# autoreconf -ivf && ./configure && make

config.h와 config.h.in에 추가해도 계속 초기화가 되서
configure.ac에 추가함
# Define _GL_ASYNC_SAFE if necessary
AC_DEFINE([_GL_ASYNC_SAFE], [], [Define to enable async safe functions])

# Define _GL_ATTRIBUTE_MALLOC if necessary
AC_DEFINE([_GL_ATTRIBUTE_MALLOC], [], [Define to enable malloc attributes])

# Define _GL_ATTRIBUTE_DEALLOC_FREE if necessary
AC_DEFINE([_GL_ATTRIBUTE_DEALLOC_FREE], [], [Define to enable dealloc free attributes])

# autoreconf -ivf && ./configure && make
(오류)
In file included from ../lib/stdio.h:1,
                 from hello.c:23:
../config.h:174:9: warning: "_GL_ATTRIBUTE_DEALLOC_FREE" redefined
  174 | #define _GL_ATTRIBUTE_DEALLOC_FREE /**/
      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
In file included from C:/msys64/mingw64/include/io.h:10,
                 from ../lib/textstyle.h:688,
                 from hello.c:21:
../lib/string.h:699:11: note: this is the location of the previous definition
  699 | #  define _GL_ATTRIBUTE_DEALLOC_FREE _GL_ATTRIBUTE_DEALLOC (rpl_free, 1)
      |           ^~~~~~~~~~~~~~~~~~~~~~~~~~
mv -f .deps/hello.Tpo .deps/hello.Po
/bin/sh ../libtool  --tag=CC   --mode=link /mingw64/bin/gcc  -I/mingw64/include  -no-undefined -export-dynamic -o hello.exe hello.o ../lib/libtextstyle.la
libtool: link: /mingw64/bin/gcc -I/mingw64/include -o .libs/hello.exe hello.o -Wl,--export-all-symbols  /mingw64/lib/libtextstyle.a -L/mingw64/lib -lws2_32 -liconv -lncurses
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/adhoc-tests' 나감
Making all in doc
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/doc' 들어감
make[2]: 'all'을(를) 위해 할 일이 없습니다.
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle/doc' 나감
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 들어감
/bin/sh ./libtool  --tag=CC   --mode=compile /mingw64/bin/gcc -DHAVE_CONFIG_H -I.   -I/mingw64/include  -I/mingw64/include -c -o lib/color.lo lib/color.c
libtool: compile:  /mingw64/bin/gcc -DHAVE_CONFIG_H -I. -I/mingw64/include -I/mingw64/include -c lib/color.c  -DDLL_EXPORT -DPIC -o lib/.libs/color.o
In file included from lib/color.c:35:
lib/concat-filename.h: In function 'xconcatenated_filename':
lib/concat-filename.h:45:3: error: expected declaration specifiers before '_GL_ATTRIBUTE_RETURNS_NONNULL'
   45 |   _GL_ATTRIBUTE_RETURNS_NONNULL;
      |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lib/color.c:42:6: error: parameter 'color_mode' is initialized
   42 | enum color_option color_mode = color_tty;
      |      ^~~~~~~~~~~~
lib/color.c:50:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   50 | {
      | ^
lib/color.c:78:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   78 | {
      | ^
lib/color.c:85:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
   85 | {
      | ^
lib/color.c:391:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
  391 | {
      | ^
lib/color.c:423:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before '{' token
  423 | {
      | ^
lib/concat-filename.h:42:14: error: old-style parameter declarations in prototyped function definition
   42 | extern char *xconcatenated_filename (const char *directory,
      |              ^~~~~~~~~~~~~~~~~~~~~~
lib/color.c:451: error: expected '{' at end of input
make[2]: *** [Makefile:684: lib/color.lo] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make[1]: *** [Makefile:703: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:569: all] 오류 2
(수정)
_GL_ATTRIBUTE_DEALLOC_FREE 매크로가 config.h와 lib/string.h에서 각각 정의
# Define _GL_ATTRIBUTE_DEALLOC_FREE if necessary
# 중복선언주석처리 lib/string.h
#AC_DEFINE([_GL_ATTRIBUTE_DEALLOC_FREE], [], [Define to enable dealloc free attributes])
# Define _GL_ATTRIBUTE_RETURNS_NONNULL if necessary
# 추가
AC_DEFINE([_GL_ATTRIBUTE_RETURNS_NONNULL], [], [Define to enable returns nonnull attributes])
concat-filename.h 수정
/* undefine error 추가 */
#ifndef _GL_ATTRIBUTE_DEALLOC_FREE
#define _GL_ATTRIBUTE_DEALLOC_FREE
#endif
color.c에서 선언되지않은 xstrdup함수사용
color.h 수정
#include "xstrdup.h" 
lib/xstrdup.h생성
#ifndef XSTRDUP_H
#define XSTRDUP_H

#include <stddef.h>  // for size_t

// Function declaration for xstrdup
char *xstrdup(const char *s);

#endif /* XSTRDUP_H */

lib/xstrdup.c 생성
#include "xstrdup.h"
#include <stdlib.h>  // for malloc, free
#include <string.h>  // for strlen, strcpy

// Function implementation for xstrdup
char *xstrdup(const char *s) {
    if (s == NULL) {
        return NULL;  // Handle NULL pointer input
    }

    // Allocate memory for the duplicated string
    char *dup = (char *)malloc(strlen(s) + 1);
    if (dup == NULL) {
        return NULL;  // Memory allocation failed
    }

    // Copy the string into the allocated memory
    strcpy(dup, s);
    return dup;
}

typedef bool (*gl_listelement_equals_fn) bool 타입이 정의되지 않았습니다
lib/gl_list.h 수정
#include <stdbool.h>/*추가*/

lib/gl_list.h:34:25: error: unknown type name '_GL_INLINE'
   34 | # define GL_LIST_INLINE _GL_INLINE
configure.ac 수정
AC_DEFINE([_GL_INLINE],[],[Define for inline]) /*추가*/

lib/gl_list.h:648:24: error: expected ';' before 'int'
  648 | _GL_ATTRIBUTE_NODISCARD GL_LIST_INLINE int
      |                        ^               ~~~
      |                        ;
configure.ac 수정
# Define macros for inline header
AC_DEFINE([_GL_INLINE],[inline],[Define for inline]) /*추가*/
AC_DEFINE([_GL_INLINE_HEADER_BEGIN], [], [Define for inline header start])
AC_DEFINE([_GL_INLINE_HEADER_END], [], [Define for inline header end])
AC_DEFINE([_GL_CONFIG_H_INCLUDED], [1], [Define to prevent multiple inclusion])
AC_DEFINE([_GL_ATTRIBUTE_NODISCARD], [], [Define for attribute nodiscard])
AC_DEFINE([_GL_LIST_INLINE], [], [Define for list inline])

lib/xsize.h:66:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'xsum'
   66 | xsum (size_t size1, size_t size2)
      | ^~~~
확인할사항
config.h
/* Define for inline */
#define _GL_INLINE /**/

lib/attribute.h
#define ATTRIBUTE_PURE _GL_ATTRIBUTE_PURE

lib/xsize.h
/* Get ATTRIBUTE_PURE.  */
#include "attribute.h"
#include <stdbool.h> /* 추가 bool타입 사용*/

lib/xsize.h:68:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'xsum'
   68 | xsum (size_t size1, size_t size2)
      | ^~~~
lib/xsize.h:76:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'xsum3'
   76 | xsum3 (size_t size1, size_t size2, size_t size3)
      | ^~~~~
lib/xsize.h:83:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'xsum4'
   83 | xsum4 (size_t size1, size_t size2, size_t size3, size_t size4)
      | ^~~~~
lib/xsize.h:90:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'xmax'
   90 | xmax (size_t size1, size_t size2)
      | ^~~~

configure.ac 수정
AC_DEFINE([_GL_ATTRIBUTE_PURE], [__attribute__((pure))], [Define to __attribute__((pure))])

(오류)
lib/gl_array_list.c:531:25: error: unknown type name '_GL_ATTRIBUTE_MAYBE_UNUSED'
  531 | gl_array_iterator_free (_GL_ATTRIBUTE_MAYBE_UNUSED gl_list_iterator_t *iterator)
      |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~
lib/gl_array_list.c:691:5: error: 'gl_array_iterator_free' undeclared here (not in a function); did you mean 'gl_array_iterator_next'?
  691 |     gl_array_iterator_free,
      |     ^~~~~~~~~~~~~~~~~~~~~~
      |     gl_array_iterator_next
make[2]: *** [Makefile:684: lib/gl_array_list.lo] 오류 1
make[2]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make[1]: *** [Makefile:703: all-recursive] 오류 1
make[1]: 디렉터리 '/c/libidn2/gettext-0.22.5/libtextstyle' 나감
make: *** [Makefile:569: all] 오류 2

(수정)
configure.ac 수정
AC_DEFINE([_GL_ATTRIBUTE_MAYBE_UNUSED], [__attribute__((unused))], [Define to __attribute__((unused))])

(오류)
lib/gl_array_list.c:692:9: error: initialization of 'void (*)(gl_list_iterator_t *)' 
from incompatible pointer type '_Bool (*)(gl_list_iterator_t *, const void **, struct gl_list_node_impl **)' [-Wincompatible-pointer-types]
  692 |         gl_array_iterator_next, /* ??         ^~~~~~~~~~~~~~~~~~~~~
lib/gl_array_list.c:692:9: note: (near initialization for 'gl_array_list_implementation.iterator_free')

(수정)
static bool gl_array_iterator_next (gl_list_iterator_t *iterator, const void **eltp, gl_list_node_t *nodep)
static void gl_array_iterator_free (_GL_ATTRIBUTE_MAYBE_UNUSED gl_list_iterator_t *iterator)
gl_array_iterator_next가 iterator_free 함수 포인터와 일치하지 않음

(오류)
C:/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: lib/.libs/color.o:color.c:(.text+0x1cb): undefined reference to `term_ostream_create'
(수정)
선언된파일찾아 포함하기
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# grep -rn 'term_ostream_create' .
Binary file ./adhoc-tests/.libs/hello.exe matches
Binary file ./doc/libtextstyle.info matches
./doc/libtextstyle.texi:1000:@deftypefn Function term_ostream_t term_ostream_create (int@tie{}@var{fd}, const@tie{}char@tie{}*@var{filename}, ttyctl_t@tie{}@var{tty_control})
./doc/libtextstyle_3.html:534:<dt><u>Function:</u> term_ostream_t <b>term_ostream_create</b><i> (int&nbsp;<var>fd</var>, const&nbsp;char&nbsp;*<var>filename</var>, ttyctl_t&nbsp;<var>tty_control</var>)</i>
./doc/libtextstyle_5.html:155:<tr><td></td><td valign="top"><a href="libtextstyle_3.html#IDX32"><code>term_ostream_create</code></a></td><td valign="top"><a href="libtextstyle_3.html#SEC27">3.5.3.3 The <code>term_ostream</code> class</a></td></tr>
./gnulib-local/lib/term-ostream.oo.c:2377:term_ostream_create (int fd, const char *filename, ttyctl_t tty_control)
./gnulib-local/lib/term-ostream.oo.h:132:       term_ostream_create (int fd, const char *filename, ttyctl_t tty_control);
./gnulib-local/lib/term-styled-ostream.oo.c:651:  stream->destination = term_ostream_create (fd, filename, tty_control);
./gnulib-local/tests/test-term-ostream.c:30:  stream = term_ostream_create (1, "stdout", TTYCTL_AUTO);
Binary file ./hello.exe matches
Binary file ./lib/.libs/color.o matches
Binary file ./lib/.libs/libtextstyle.a matches
Binary file ./lib/.libs/libtextstyle_la-color.o matches
Binary file ./lib/.libs/libtextstyle_la-term-ostream.o matches
Binary file ./lib/.libs/libtextstyle_la-term-styled-ostream.o matches
./lib/color.c:103:  stream = term_ostream_create (1, "stdout", TTYCTL_AUTO);
Binary file ./lib/color.o matches
./lib/libtextstyle.sym:96:term_ostream_create
./lib/libtextstyle.sym.in:96:term_ostream_create
Binary file ./lib/libtextstyle_la-color.o matches
Binary file ./lib/libtextstyle_la-term-ostream.o matches
Binary file ./lib/libtextstyle_la-term-styled-ostream.o matches
(찾음) ./lib/term-ostream.c:2317:term_ostream_create (int fd, const char *filename, ttyctl_t tty_control)
(찾음) ./lib/term-ostream.h:370:       term_ostream_create (int fd, const char *filename, ttyctl_t tty_control);
./lib/term-ostream.oo.c:2377:term_ostream_create (int fd, const char *filename, ttyctl_t tty_control)
./lib/term-ostream.oo.h:132:       term_ostream_create (int fd, const char *filename, ttyctl_t tty_control);
./lib/term-styled-ostream.c:646:  stream->destination = term_ostream_create (fd, filename, tty_control);
./lib/term-styled-ostream.oo.c:651:  stream->destination = term_ostream_create (fd, filename, tty_control);
./lib/textstyle.h:327:       term_ostream_create (int fd, const char *filename, ttyctl_t tty_control);
./tests/test-accessors.c:34:    ostream_t stream = term_ostream_create (1, "(stdout)", TTYCTL_AUTO);
./tests/test-instanceof.c:18:  ostream_t stream3 = term_ostream_create (1, "(stdout)", TTYCTL_AUTO);
./tests/test-term-ostream.c:30:  stream = term_ostream_create (1, "stdout", TTYCTL_AUTO);

링커오류가났으므로
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# gcc -I /c/libidn2/gettext-0.22.5/libtextstyle -std=gnu99 -D_GNU_SOURCE -c lib/term-ostream.c -o lib/term-ostream.o

(오류)
lib/error.h:477:19: error: unknown type name '_GL_ATTRIBUTE_COLD'
  477 |                   _GL_ATTRIBUTE_COLD
      |                   ^~~~~~~~~~~~~~~~~~
(수정)
configure.ac
AC_DEFINE([_GL_ATTRIBUTE_COLD], [__attribute__((cold))], [Define to __attribute__((cold))])
configure.ac 를 수정했기때문에 config.h파일을 재생성하려면
autoreconf -ivf -> ./configure -> make ->config.h 생성
gcc -I /c/libidn2/gettext-0.22.5/libtextstyle -std=gnu99 -D_GNU_SOURCE -c lib/term-ostream.c -o lib/term-ostream.o

(오류)
lib/error.h:478:41: error: expected declaration specifiers or '...' before
(' token
  478 |                   _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 3, 4)));

(수정)
configure.ac 수정
AC_DEFINE([_GL_ATTRIBUTE_FORMAT], [__attribute__((format))], [Define to __attribute__((format))])
AC_DEFINE([_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [__attribute__((format(printf, 1, 2)))], [Define to __attribute__((format(printf, 1, 2)))])

(오류)
lib/error.h:478:73: error: expected ')' before ',' token
  478 |                   _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 3, 4)));
      |
    ^
(수정)
__attribute__((format(printf, 1, 2)))를 사용하는 것이 좋음
lib/error.h 409 수정
# if ! 0
_GL_FUNCDECL_SYS (error, void,
                  (int __status, int __errnum, const char *__format, ...),
                  _GL_ATTRIBUTE_COLD
                  /*_GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 3, 4))*/
				  _GL_ATTRIBUTE_FORMAT
				);
# endif

#ifndef _GL_ATTRIBUTE_SPEC_PRINTF_ERROR /*추가*/
#if GNULIB_VFPRINTF_POSIX
# define _GL_ATTRIBUTE_SPEC_PRINTF_ERROR _GL_ATTRIBUTE_SPEC_PRINTF_STANDARD
#else
# define _GL_ATTRIBUTE_SPEC_PRINTF_ERROR _GL_ATTRIBUTE_SPEC_PRINTF_SYSTEM
#endif
#endif /*추가*/
configure.ac 수정
# Define macros for inline header
AC_DEFINE([_GL_INLINE],[inline],[Define for inline]) /*추가*/
AC_DEFINE([_GL_INLINE_HEADER_BEGIN], [], [Define for inline header start])
AC_DEFINE([_GL_INLINE_HEADER_END], [], [Define for inline header end])
AC_DEFINE([_GL_CONFIG_H_INCLUDED], [1], [Define to prevent multiple inclusion])
AC_DEFINE([_GL_ATTRIBUTE_NODISCARD], [__attribute__((nodiscard))], [Define for attribute nodiscard])
AC_DEFINE([_GL_LIST_INLINE], [inline], [Define for list inline])
AC_DEFINE([_GL_ATTRIBUTE_PURE], [__attribute__((pure))], [Define to __attribute__((pure))])
AC_DEFINE([_GL_ATTRIBUTE_MAYBE_UNUSED], [__attribute__((unused))], [Define to __attribute__((unused))])
AC_DEFINE([_GL_ATTRIBUTE_COLD], [__attribute__((cold))], [Define to __attribute__((cold))])
#AC_DEFINE([_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [__attribute__((format(printf, 3, 4)))], [Define to __attribute__((format(printf, 3, 4)))])
#AC_DEFINE([_GL_ATTRIBUTE_FORMAT], [_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [Define to __attribute__((format))])

# Define _GL_ATTRIBUTE_SPEC_PRINTF_ERROR based on the standard or system attributes
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [__attribute__((format(printf, 3, 4)))], [Define to __attribute__((format(printf, 3, 4)))])
AC_DEFINE([_GL_ATTRIBUTE_FORMAT], [_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [Define to _GL_ATTRIBUTE_SPEC_PRINTF_ERROR])

(오류)
lib/error.h:541:73: error: expected identifier or '(' before ',' token
  541 |                   _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 5, 6)));
      |
    ^
(수정)
lib/error.h 수정
# if ! 0
_GL_FUNCDECL_SYS (error_at_line, void,
                  (int __status, int __errnum, const char *__filename,
                   unsigned int __lineno, const char *__format, ...),
                  _GL_ATTRIBUTE_COLD
                  /*_GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 5, 6))*/
				  _GL_ATTRIBUTE_FORMAT_ERROR_AT_LINE
				  );
# endif

(오류)
lib/error.h:586:6: error: 'format' attribute argument 3 value '4' does not refer to a variable argument list
  586 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 3, 0));
      |      ^~~~~~~~~~~~~~~~~~~~
lib/error.h:586:27: error: expected ',' or ';' before '(' token
  586 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 3, 0));
      |                           ^
lib/error.h:606:6: error: 'format' attribute argument 3 value '4' does not refer to a variable argument list
  606 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 5, 0));
      |      ^~~~~~~~~~~~~~~~~~~~
lib/error.h:606:27: error: expected ',' or ';' before '(' token
  606 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 5, 0));
      |                           ^
(수정)
configure.ac 수정
# AC_DEFINE_UNQUOTED는 매크로를 정의할 때 큰따옴표를 자동으로 제거
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [__attribute__((format(printf, 3, 4)))], [Define to __attribute__((format(printf, 3, 4)))])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_FORMAT], [_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [Define to _GL_ATTRIBUTE_SPEC_PRINTF_ERROR])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_FORMAT_ERROR_AT_LINE], [__attribute__((format(printf, 5, 6)))], [Define for format attribute with index 5, 6])

(오류)
lib/error.h:541:73: error: expected identifier or '(' before ',' token
  541 |                   _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_ERROR, 5, 6)));
      |
    ^
lib/error.h:189:21: note: in definition of macro '_GL_FUNCDECL_SYS'
  189 |   _GL_EXTERN_C_FUNC __VA_ARGS__ rettype func parameters
      |                     ^~~~~~~~~~~
lib/error.h:584:6: error: 'format' attribute argument 3 value '4' does not refer to a variable argument list
  584 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 3, 0));
      |      ^~~~~~~~~~~~~~~~~~~~
lib/error.h:584:27: error: expected ',' or ';' before '(' token
  584 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 3, 0));
      |                           ^
lib/error.h:604:6: error: 'format' attribute argument 3 value '4' does not refer to a variable argument list
  604 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 5, 0));
      |      ^~~~~~~~~~~~~~~~~~~~
lib/error.h:604:27: error: expected ',' or ';' before '(' token
  604 |      _GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 5, 0));
      |                           ^
(수정)
lib/error.h 수정
_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR /*추가*/

configure.ac 수정
/*추가*/
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR], [__attribute__((format(printf, 3, 0)))], [Define for format attribute with index 3, 0])

lib/error.h 수정
extern void verror (int __status, int __errnum, const char *__format,
                    va_list __args)
     _GL_ATTRIBUTE_COLD
     /*_GL_ATTRIBUTE_FORMAT ((_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD, 3, 0));*/
	 _GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR /*추가*/

(오류)
lib/error.h:613:1: error: expected ',' or ';' before 'extern'
  613 | extern void verror_at_line (int __status, int __errnum, const char *__fname,
      | ^~~~~~
configure.ac 수정
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR], [__attribute__((format(printf, 3, 0)))], [Define for format attribute with index 3, 0])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR_AT_LINE], [__attribute__((format(printf, 5, 0)))], [Define for format attribute with index 5, 0])

lib/error.h 수정
extern void verror (int __status, int __errnum, const char *__format,
                    va_list __args)
     _GL_ATTRIBUTE_COLD
     _GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR; /*추가*/
extern void verror_at_line (int __status, int __errnum, const char *__fname,
                            unsigned int __lineno, const char *__format,
                            va_list __args)
     _GL_ATTRIBUTE_COLD
     _GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR_AT_LINE;

(오류)
lib/error.h:637:20: error: expected ';' before 'void'
  637 | extern DLL_VARIABLE void (*error_print_progname) (void);
      |                    ^~~~~
      |                    ;
lib/error.h:640:20: error: expected ';' before 'unsigned'
  640 | extern DLL_VARIABLE unsigned int error_message_count;
      |                    ^~~~~~~~~
      |                    ;
lib/error.h:644:20: error: expected ';' before 'int'
  644 | extern DLL_VARIABLE int error_one_per_line;
      |                    ^~~~
      |  
;
(수정)
Makefile.am 수정
AM_CPPFLAGS = -I${top_builddir} # 전처리기 플래그 설정 추가

configure.ac 수정
if test "$host_os" = "mingw32"; then # DLL_VARIABLE 정의
	AC_DEFINE([DLL_VARIABLE], [__declspec(dllexport)], [Define to __declspec(dllexport)])
else
	AC_DEFINE([DLL_VARIABLE], [], [Define to nothing for non-Windows platforms])
fi
AC_SUBST([DLL_VARIABLE]) # DLL_VARIABLE 매크로 설정 추가

(오류)
In file included from term-ostream.oo.c:42:
lib/get_progname_of.h: In function 'get_progname_of':
lib/get_progname_of.h:38:24: error: expected declaration specifiers before '_GL_ATTRIBUTE_DEALLOC_FREE'
   38 |   _GL_ATTRIBUTE_MALLOC _GL_ATTRIBUTE_DEALLOC_FRE
;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~~
(수정)
configure.ac 수정
AC_CHECK_HEADERS([attributes.h])
# 문자열 값 정의
AC_DEFINE([_GL_ASYNC_SAFE], [], [Define to enable async safe functions])
AC_DEFINE([_GL_ATTRIBUTE_MALLOC], [], [Define to enable malloc attributes])
AC_DEFINE([_GL_ATTRIBUTE_DEALLOC_FREE], [], [Define to enable dealloc free attributes])
AC_DEFINE([_GL_ATTRIBUTE_RETURNS_NONNULL], [], [Define to enable returns nonnull attributes])
AC_DEFINE([_GL_INLINE],[inline],[Define for inline])
AC_DEFINE([_GL_INLINE_HEADER_BEGIN], [], [Define for inline header start])
AC_DEFINE([_GL_INLINE_HEADER_END], [], [Define for inline header end])
AC_DEFINE([_GL_CONFIG_H_INCLUDED], [1], [Define to prevent multiple inclusion])
AC_DEFINE([_GL_LIST_INLINE], [inline], [Define for list inline])
# C 코드조각 직접 삽입 시
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_NODISCARD], [__attribute__((nodiscard))], [Define for attribute nodiscard])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_PURE], [__attribute__((pure))], [Define to __attribute__((pure))])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_MAYBE_UNUSED], [__attribute__((unused))], [Define to __attribute__((unused))])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_COLD], [__attribute__((cold))], [Define to __attribute__((cold))])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [__attribute__((format(printf, 3, 4)))], [Define to __attribute__((format(printf, 3, 4)))])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_FORMAT], [_GL_ATTRIBUTE_SPEC_PRINTF_ERROR], [Define to _GL_ATTRIBUTE_SPEC_PRINTF_ERROR])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_FORMAT_ERROR_AT_LINE], [__attribute__((format(printf, 5, 6)))], [Define for format attribute with index 5, 6])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR], [__attribute__((format(printf, 3, 0)))], [Define for format attribute with index 3, 0])
AC_DEFINE_UNQUOTED([_GL_ATTRIBUTE_SPEC_PRINTF_STANDARD_ERROR_AT_LINE], [__attribute__((format(printf, 5, 0)))], [Define for format attribute with index 5, 0])

(오류)
term-ostream.oo.c: In function 'generate_hyperlink_id':
term-ostream.oo.c:1158:23: error: implicit declaration of function 'xmalloc'; did you mean 'malloc'? [-Wimplicit-function-declaration]
(수정)
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# find /c/gnulib -name "*xmalloc*"
/c/gnulib/lib/xmalloc.c
/c/gnulib/lib/xmalloca.c
/c/gnulib/lib/xmalloca.h
/c/gnulib/modules/xmalloca

cp /c/gnulib/lib/xmalloca.h /c/libidn2/gettext-0.22.5/libtextstyle/lib
cp /c/gnulib/lib/xmalloca.c /c/libidn2/gettext-0.22.5/libtextstyle/lib
cp /c/gnulib/lib/xmalloc.c /c/libidn2/gettext-0.22.5/libtextstyle/lib

nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# ls /c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloc*
/c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloc.c
/c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloca.c
/c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloca.h

term-ostream.oo.c의 상단에 xmalloca.h를 포함
nayou@kimnayooung MINGW64 /c/libidn2/gettext-0.22.5/libtextstyle
# ls -l /c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloca.h
-rw-r--r-- 1 nayou nayou 2721  9월  3 09:17 /c/libidn2/gettext-0.22.5/libtextstyle/lib/xmalloca.h
#include "xmalloca.h" /*추가*/

configure.ac 수정
# Specify the Gnulib modules to use
gl_MODULES([xmalloca]) /*추가*/












